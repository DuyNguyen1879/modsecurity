# ---------------------------------------------------------------
# Sliqua WAF based on Comodo ModSecurity Rules
# Copyright (C) 2015 Sliqua Enterprise Hosting, Inc.
# Copyright (C) 2015 Comodo Security solutions All rights reserved.
# Please see the enclosed LICENCE file for full details.
# ---------------------------------------------------------------
# This is a FILE CONTAINING CHANGED or MODIFIED RULES FROM THE:
# OWASP ModSecurity Core Rule Set (CRS)
# Comodo Web Application Firewall
# ---------------------------------------------------------------

SecRule REQUEST_LINE "@contains /includes/header.php" \
	"id:220010,chain,msg:'SLIQUA WAF: found CVE-2008-2898 attack',phase:2,deny,status:403,t:'none',t:'lowercase',t:'urlDecodeUni',t:'htmlEntityDecode',t:'normalisePathWin'"
SecRule REQUEST_LINE "@contains GET " \
	"chain"
SecRule ARGS:c_temp_path "@contains ../"

SecRule REQUEST_FILENAME "admin/plugin-index\.php|admin/plugin-settings\.php|admin/plugin-preferences\.php" \
	"id:220060,chain,msg:'SLIQUA WAF: found CVE-2013-3515 attack',phase:2,deny,status:403,log,t:'lowercase'"
SecRule ARGS:action|ARGS:group|ARGS:package|ARGS:parent|ARGS:plugin "@rx [^a-zA-Z0-9\._-]"

SecRule REQUEST_FILENAME "@rx /data/form_[0-9]+/files/element_[0-9]+.*\.php" \
	"id:220070,msg:'SLIQUA WAF: found CVE-2013-4949 attack',phase:1,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule QUERY_STRING "@rx (login|signup)" \
	"id:220080,chain,msg:'SLIQUA WAF: found CVE-2013-4951 attack',phase:2,deny,status:403,t:'none'"
SecRule ARGS_POST:name|ARGS_POST:pass "@rx </?script" \
	"t:'none',t:'urlDecodeUni',t:'lowercase',t:'removeWhitespace'"

SecRule REQUEST_FILENAME "libraries/Error\.class\.php|libraries/Error_Handler\.class\.php|libraries/common\.inc\.php|libraries/pmd_common\.php|libraries/schema/Pdf_Relation_Schema\.class\.php|libraries/Config\.class\.php|libraries/List_Database\.class\.php|libraries/PDF\.class\.php|libraries/PMA\.php|libraries/RecentTable\.class\.php|libraries/bookmark\.lib\.php|libraries/auth/swekey/swekey\.auth\.lib\.php|libraries/config\.default\.php|libraries/data_drizzle\.inc\.php|libraries/data_mysql\.inc\.php|libraries/dbi/drizzle-wrappers\.lib\.php|libraries/display_tbl\.lib\.php|libraries/engines/bdb\.lib\.php|libraries/engines/berkeleydb\.lib\.php|libraries/engines/binlog\.lib\.php|libraries/engines/innobase\.lib\.php|libraries/engines/innodb\.lib\.php|libraries/engines/memory\.lib\.php|libraries/engines/merge\.lib\.php|libraries/engines/mrg_myisam\.lib\.php|libraries/engines/myisam\.lib\.php|libraries/engines/ndbcluster\.lib\.php|libraries/engines/pbms\.lib\.php|libraries/engines/pbxt\.lib\.php" \
	"id:220090,msg:'SLIQUA WAF: found CVE-2013-4998 / CVE-2013-4999 / CVE-2013-5000 attack',phase:1,severity:2,deny,status:403,log,t:'none',t:'lowercase'"

SecRule REQUEST_METHOD "@streq POST" \
	"id:220100,chain,msg:'SLIQUA WAF: found CVE-2013-5003 attack',phase:2,deny,status:403,log"
SecRule REQUEST_FILENAME "pmd_pdf\.php|schema_export\.php" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS:pdf_page_number|ARGS:scale "!@rx ^[0-9]+$"

SecRule REQUEST_URI "@rx .*/view\.php\?id=\d+" \
	"id:220110,chain,msg:'SLIQUA WAF: found CVE-2013-4948 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:form_id "@rx \D+"

SecRule REQUEST_URI "@rx .*/view\.php\?id=\d+" \
	"id:220111,chain,msg:'SLIQUA WAF: found CVE-2013-4948 attack',phase:4,deny,status:403,log"
SecRule RESPONSE_BODY "@rx ^INSERT INTO \`ap_form_\d+\` \(\`ip_address\`,\`date_created\`\) VALUES.*Query failed: Table \'\w+.ap_form_\d+\' doesn\'t exist$"

SecRule REQUEST_FILENAME "@rx .*/save\.php$" \
	"id:220120,chain,msg:'SLIQUA WAF: found CVE-2013-4950 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:form "@rx ^\{\"id\":.*</?script" \
	"t:'none',t:'removeWhitespace',t:'lowercase'"

SecRule REQUEST_FILENAME "@rx .*/save\.php$" \
	"id:220121,chain,msg:'SLIQUA WAF: found CVE-2013-4950 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:elements "@rx ^\{\"elements\":\[\{\"title\":\".*</?script" \
	"t:'none',t:'removeWhitespace',t:'lowercase'"

SecRule REQUEST_METHOD "@streq POST" \
	"id:220140,chain,msg:'SLIQUA WAF: found CVE-2013-2209 attack',phase:2,deny,status:403,log"
SecRule REQUEST_URI "@contains /account/register/" \
	"chain,t:'none',t:'urlDecodeUni',t:'lowercase',t:'removeWhitespace'"
SecRule ARGS:first_name|ARGS:last_name "@rx <script" \
	"t:'none',t:'urlDecodeUni',t:'lowercase',t:'removeWhitespace'"

SecRule ARGS|!ARGS:/FCKeditor/|!ARGS:/^jform/|!ARGS:/^para/|!ARGS:/appendTo/|!ARGS:/database/|!ARGS:/description/|!ARGS:/insertAfter/|!ARGS:/insertBefore/|!ARGS:/installcode/|!ARGS:/message/|!ARGS:/msg/|!ARGS:/narrative/|!ARGS:/php/|!ARGS:/prependTo/|!ARGS:/prevObject/|!ARGS:/replaceAll/|!ARGS:/report/|!ARGS:/sql/|!ARGS:/teaser/|!ARGS:/text/|!ARGS:/txt/|!ARGS:Db_submit|!ARGS:Post|!ARGS:TicketID|!ARGS:action|!ARGS:alternate1|!ARGS:article_content|!ARGS:body|!ARGS:code|!ARGS:comment|!ARGS:contenido|!ARGS:content|!ARGS:data|!ARGS:faqs_answer|!ARGS:fck_body|!ARGS:file_content|!ARGS:form[pagina_text]|!ARGS:fulldescr|!ARGS:json|!ARGS:keywords|!ARGS:newcontent|!ARGS:p_action|!ARGS:prefix|!ARGS:query|!ARGS:resolution|!ARGS:saved_data|!ARGS:steps|!ARGS:suffix|!ARGS:wpSummary "@rx (?:union(?:\/\*.*\*\/)?select(?:\/\*.*\*\/)?)" \
	"id:220150,msg:'SLIQUA WAF: found sql injection attack CVE-2013-5318 (Ginkgo CMS)',phase:2,capture,deny,status:403,log,logdata:'%{TX.0}',t:'none',t:'removeWhitespace',t:'lowercase'"

<LocationMatch /options-general\.php>
SecRuleRemoveById 220150
</LocationMatch>
<LocationMatch /sql\.php>
SecRuleRemoveById 220150
</LocationMatch>
<LocationMatch /lib/exe/ajax\.php>
SecRuleRemoveById 220150
</LocationMatch>
<LocationMatch /export\.php>
SecRuleRemoveById 220150
</LocationMatch>
SecRule REQUEST_FILENAME "@rx /user/browse/view_" \
	"id:220160,chain,msg:'SLIQUA WAF: found CVE-2013-5121 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:search[sort_by] "@rx ^(?!^(asc|desc)$).+$" \
	"t:'none',t:'removeWhitespace',t:'lowercase'"

SecRule REQUEST_METHOD "@streq GET" \
	"id:220170,chain,msg:'SLIQUA WAF: found CVE-2013-5317 attack',phase:2,deny,status:403,log"
SecRule REQUEST_FILENAME "cms/index\.php" \
	"chain,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS:mode "@rx <script" \
	"t:'none',t:'urlDecodeUni',t:'lowercase',t:'removeWhitespace'"

<LocationMatch "/cms/index\.php$">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220180,chain,phase:2,pass,nolog"
SecRule QUERY_STRING "@rx ^mode\=users\&edit\=\d+$" \
	"expirevar:'SESSION.ritecms=3600',setvar:'SESSION.TIMEOUT=3600',setvar:'SESSION.ritecms=1',t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule SESSION:ritecms "@eq 1" \
	"id:220181,phase:2,pass,nolog,skip:1"

SecRule REQUEST_METHOD "@streq POST" \
	"id:220182,chain,msg:'SLIQUA WAF: found CVE 2013-5316 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:mode "@streq users" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:type "@streq 1" \
	"chain"
SecRule ARGS_POST:edit_user_submitted "@rx ^.*$"

</LocationMatch>
<LocationMatch "/mod\.php$">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220190,phase:2,pass,expirevar:'SESSION.diy=3600',setvar:'SESSION.TIMEOUT=3600',setvar:'SESSION.diy=1',nolog"

SecRule SESSION:diy "@eq 1" \
	"id:220191,phase:2,pass,nolog,skip:1"

SecRule REQUEST_METHOD "@rx ^(?:POST)$" \
	"id:220192,chain,msg:'SLIQUA WAF: found CVE 2012-6518 attack',phase:2,deny,status:403,log"
SecRule QUERY_STRING "@rx mod=poll\&modfile=add" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule ARGS_POST:polltype "@streq 1" \
	"chain"
SecRule ARGS_POST:question "!@rx ^$"

</LocationMatch>
SecRule REQUEST_URI "@contains cacti" \
	"id:220220,chain,msg:'SLIQUA WAF: found CVE-2013-5589 attack',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_FILENAME "@rx host.php" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:id "!@rx ^[0-9]+$"

<LocationMatch "/index\.php$">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220230,chain,msg:'SLIQUA WAF: found CVE 2013-5091 attack',phase:2,deny,status:403,log"
SecRule ARGS_GET:action "@streq index" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:module "@streq calendar" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:day "@rx ^\d{1,2}$" \
	"chain"
SecRule ARGS_GET:hour "@rx ^\d{1,2}$" \
	"chain"
SecRule ARGS_GET:month "@rx ^\d{1,2}$" \
	"chain"
SecRule ARGS_GET:year "@rx ^\d{4}$" \
	"chain"
SecRule ARGS_GET:onlyforuser "!@rx ^\d+$"

</LocationMatch>
<LocationMatch "/awards\.php$">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220270,chain,msg:'SLIQUA WAF: found CVE 2013-3721 attack',phase:2,deny,status:403,log"
SecRule ARGS_GET:d "!@rx ^\d\d\d\d-\d\d?-\d\d?$"

</LocationMatch>
<LocationMatch "/index\.php/PopUpNews/popupnewsitem/">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220300,chain,msg:'SLIQUA WAF: found CVE 2013-3524 attack',phase:2,deny,status:403,log"
SecRule ARGS_GET:itemid "!@rx ^\d+$" \
	"t:'none',t:'urlDecodeUni'"

</LocationMatch>
<LocationMatch "/view/objectDetail\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220310,chain,msg:'SLIQUA WAF: found CVE 2013-6164 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:objectClass "@streq Affectation" \
	"chain"
SecRule ARGS_POST:objectId "!@rx ^\d+$"

</LocationMatch>
<LocationMatch "/radio/meneger\.php$">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220340,chain,msg:'SLIQUA WAF: found CVE 2013-3531 attack',phase:2,deny,status:403,log"
SecRule ARGS_GET:playlist_id "!@rx ^\d*$"

</LocationMatch>
SecRule ARGS_GET:test_id "!@rx ^\d+$" \
	"id:220350,msg:'SLIQUA WAF: found CVE-2013-6873 attack',phase:2,deny,status:403,t:'urlDecodeUni'"

<LocationMatch "/claroline/(admin(registeruser|_user_course_settings)|module|profile_list)\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220360,chain,msg:'SLIQUA WAF: found CVE-2013-6267 attack',phase:2,deny,status:403,log"
SecRule ARGS_GET:cidToEdit|ARGS_GET:module_id|ARGS_GET:offset "!@rx ^\d+$"

</LocationMatch>
SecRule REQUEST_FILENAME "/mobile/php/translation/index.php" \
	"id:220400,chain,msg:'SLIQUA WAF: found CVE-2013-7002 attack',phase:1,block,deny,status:403,t:'none',t:'lowercase',t:'urlDecodeUni'"
SecRule ARGS_GET:g_language "!@rx ^[a-z]{2}$"

<LocationMatch "/admin/settings\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220410,chain,msg:'SLIQUA WAF: found CVE 2012-6621 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:sitename "@rx .*" \
	"chain"
SecRule ARGS_POST:email|ARGS_POST:permalink "@rx \<" \
	"t:'none',t:'urlDecodeUni'"

</LocationMatch>
<LocationMatch "/index\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220420,chain,msg:'SLIQUA WAF: found CVE 2014-1206 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:owa_action "@streq base.passwordResetRequest" \
	"chain"
SecRule ARGS_POST:owa_email_address "@rx \s" \
	"t:'none',t:'urlDecodeUni'"

</LocationMatch>
<LocationMatch "/index\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220430,chain,msg:'SLIQUA WAF: found CVE 2014-1683 attack',phase:2,deny,status:403,log"
SecRule ARGS_GET:pid "@streq 4" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule ARGS_POST:email|ARGS_POST:message|ARGS_POST:name|ARGS_POST:subject "@rx \";" \
	"t:'none',t:'htmlEntityDecode'"

</LocationMatch>
<LocationMatch "thumb\.php">
SecRule REQUEST_METHOD "@rx GET$" \
	"id:220440,chain,msg:'SLIQUA WAF: found CVE 2014-1610 attack',phase:2,deny,status:403,log"
SecRule ARGS_GET:f "@rx .+" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule ARGS_GET:w "!@rx ^\d+$" \
	"t:'none',t:'urlDecodeUni'"

</LocationMatch>
<LocationMatch "/recursos/agent\.php">
SecRule REQUEST_METHOD "@rx GET$" \
	"id:220450,chain,msg:'SLIQUA WAF: found CVE 2014-1619 attack',phase:2,deny,status:403,log"
SecRule ARGS_GET:resource_id|ARGS_GET:version_id "!@rx ^-?\d+$" \
	"t:'none',t:'urlDecodeUni'"

</LocationMatch>
<LocationMatch "/user/profile/index\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220480,chain,phase:2,pass,nolog"
SecRule QUERY_STRING "@rx ^$" \
	"expirevar:'SESSION.Moodle=3600',setvar:'SESSION.TIMEOUT=3600',setvar:'SESSION.Moodle=1',t:'none',t:'urlDecodeUni'"

SecRule SESSION:Moodle "@eq 1" \
	"id:220481,phase:2,pass,nolog,skip:1"

SecRule REQUEST_METHOD "@streq GET" \
	"id:220482,chain,msg:'SLIQUA WAF: found CVE 2014-0010 attack',phase:2,deny,status:403,log"
SecRule ARGS_GET:action "@streq deletefield" \
	"t:'none',t:'urlDecodeUni'"

</LocationMatch>
<LocationMatch "/profiles\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220510,chain,msg:'SLIQUA WAF: found CVE 2013-1466 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:subject "@rx <"

</LocationMatch>
<LocationMatch "/calendar/index\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220511,chain,msg:'SLIQUA WAF: found CVE 2013-1466 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:address1|ARGS_POST:address2|ARGS_POST:calendar_type|ARGS_POST:city|ARGS_POST:state|ARGS_POST:title|ARGS_POST:url|ARGS_POST:zipcode "@rx <"

</LocationMatch>
<LocationMatch "/links/index\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220512,chain,msg:'SLIQUA WAF: found CVE 2013-1466 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:title|ARGS_POST:url "@rx <"

</LocationMatch>
<LocationMatch "/index\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220530,chain,msg:'SLIQUA WAF: found CVE 2013-3639 attack',phase:2,deny,status:403,log"
SecRule ARGS_GET:func "!@rx ^$" \
	"chain"
SecRule ARGS_GET:id|ARGS_GET:interface|ARGS_GET:name|ARGS_GET:tabmodule "@rx <"

</LocationMatch>
<LocationMatch "/sw/chat/message\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220540,chain,msg:'SLIQUA WAF: found CVE 2014-1914 attack',phase:2,deny,status:403,log"
SecRule ARGS_GET:nick "@rx <"

</LocationMatch>
<LocationMatch "/sw/add_topic\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220541,chain,msg:'SLIQUA WAF: found CVE 2014-1914 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:topic "@rx <"

</LocationMatch>
<LocationMatch "/index\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220560,chain,msg:'SLIQUA WAF: found CVE 2013-7326 attack',phase:2,deny,status:403,log"
SecRule ARGS_GET:return_url "@rx <|\""

</LocationMatch>
<LocationMatch "/agenda\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220570,chain,msg:'SLIQUA WAF: found CVE 2013-5983 attack',phase:2,deny,status:403,log"
SecRule ARGS_GET:an "@rx <|\""

</LocationMatch>
<LocationMatch "/mobile/thread\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220571,chain,msg:'SLIQUA WAF: found CVE 2013-5983 attack',phase:2,deny,status:403,log"
SecRule ARGS_GET:cat "@rx <|\""

</LocationMatch>
<LocationMatch "/name\.html">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220580,chain,msg:'SLIQUA WAF: found CVE 2014-1403 attack',phase:2,deny,status:403,log"
SecRule QUERY_STRING "@rx .*\#\_.*javascript" \
	"t:'none',t:'urlDecodeUni'"

</LocationMatch>
<LocationMatch "/index\.php">
SecRule REQUEST_HEADERS:CLIENT_IP|REQUEST_HEADERS:FORWARDED_FOR|REQUEST_HEADERS:X_FORWARDED|REQUEST_HEADERS:X_FORWARDED_FOR "@rx \'|\"" \
	"id:220590,msg:'SLIQUA WAF: found CVE 2014-1401 attack',phase:2,deny,status:403,log"

SecRule REQUEST_HEADERS:FORWARDED "@rx \'" \
	"id:220591,msg:'SLIQUA WAF: found CVE 2014-1401 attack',phase:2,deny,status:403,log"

</LocationMatch>
<LocationMatch "/dg-admin/">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220600,chain,msg:'SLIQUA WAF: found CVE 2014-1459 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:_position_down_id "@rx \D"

</LocationMatch>
<LocationMatch "/import\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220630,chain,msg:'SLIQUA WAF: found CVE 2014-1879 attack',phase:2,deny,status:403,log"
SecRule FILES:import_file "@rx <"

</LocationMatch>
<LocationMatch "sw/admin_change_password\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220640,phase:2,pass,expirevar:'SESSION.CSSMS=3600',setvar:'SESSION.TIMEOUT=3600',setvar:'SESSION.CSSMS=1',nolog"

SecRule SESSION:CSSMS "@eq 1" \
	"id:220641,phase:2,pass,nolog,skip:1"

SecRule REQUEST_METHOD "@streq POST" \
	"id:220642,chain,msg:'SLIQUA WAF: found CVE 2014-1915 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:action "@streq update"

</LocationMatch>
<LocationMatch "create_topic\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220643,phase:2,pass,expirevar:'SESSION.CSSMS2=3600',setvar:'SESSION.TIMEOUT=3600',setvar:'SESSION.CSSMS2=1',nolog"

</LocationMatch>
<LocationMatch "sw/add_topic\.php">
SecRule SESSION:CSSMS2 "@eq 1" \
	"id:220644,phase:2,pass,nolog,skip:1"

SecRule REQUEST_METHOD "@streq POST" \
	"id:220645,chain,msg:'SLIQUA WAF: found CVE 2014-1915 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:Submit "@streq Submit"

</LocationMatch>
<LocationMatch "admin_search">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220690,chain,msg:'SLIQUA WAF: found CVE 2013-7334 attack',phase:2,deny,status:403,log"
SecRule ARGS_GET:q "@rx \'|\"" \
	"t:'none',t:'urlDecodeUni'"

</LocationMatch>
SecRule REQUEST_FILENAME "@contains /ajax_udf.php" \
	"id:220700,chain,msg:'SLIQUA WAF: Found CVE-2014-1945',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni'"
SecRule ARGS_GET:add_value|ARGS_GET:table "!@rx ^[\w]*$"

<LocationMatch "ilias\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220710,chain,msg:'SLIQUA WAF: found CVE-2014-2089 / CVE-2014-2090 / CVE-2014-2088 attack',phase:2,deny,status:403,log"
SecRule ARGS_GET:baseClass "@streq ilPersonalDesktopGUI" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule ARGS_POST:tar|ARGS_POST:title "@rx \'|\"|\<"

SecRule REQUEST_METHOD "@streq POST" \
	"id:220711,chain,msg:'SLIQUA WAF: found CVE-2014-2089 / CVE-2014-2090 / CVE-2014-2088 attack',phase:2,deny,status:403,log"
SecRule ARGS_GET:baseClass "@streq ilRepositoryGUI" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule ARGS_POST:tar "@rx \'|\"|\<"

</LocationMatch>
SecRule REQUEST_FILENAME "/ilfile/.*\.php$" \
	"id:220712,msg:'SLIQUA WAF: found CVE-2014-2089 / CVE-2014-2090 / CVE-2014-2088 attack',phase:2,deny,status:403,log,t:'none',t:'lowercase'"

SecRule REQUEST_FILENAME "/whizzywig/wb\.php/" \
	"id:220740,chain,msg:'SLIQUA WAF: found CVE-2014-2219 attack',deny,status:403,t:'none',t:'htmlEntityDecode',t:'lowercase',multiMatch"
SecRule ARGS_GET:d "'"

SecRule REQUEST_FILENAME "mods/_standard/forums/admin/forum_add\.php" \
	"id:220750,chain,msg:'SLIQUA WAF: found CVE-2014-2091 Cross-site scripting (XSS) attack',deny,status:403,log,t:'none',t:'urlDecodeUni',multiMatch"
SecRule ARGS_POST:title "\""

SecRule REQUEST_FILENAME "mods/_standard/forums/admin/forum_add\.php" \
	"id:220751,chain,msg:'SLIQUA WAF: found CVE-2014-2091 Cross-site scripting (XSS) attack',deny,status:403,log,t:'none',t:'urlDecodeUni',multiMatch"
SecRule ARGS_POST:description "<"

SecRule ARGS_POST:text "<" \
	"id:220760,chain,msg:'SLIQUA WAF: Blocking XSS attack',deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_FILENAME "@contains /index.php/guestbook/index/newentry"

SecRule ARGS_GET:eventid "@rx \D" \
	"id:220770,chain,msg:'SLIQUA WAF: CVE-2013-3961 SQL injection protection',deny,status:403"
SecRule REQUEST_URI "edit_event\.php"

<LocationMatch "/admin/addgroup\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220780,chain,msg:'SLIQUA WAF: found CVE 2014-0334 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:group "@rx <"

</LocationMatch>
<LocationMatch "/admin/addhtmlblob\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220781,chain,msg:'SLIQUA WAF: found CVE 2014-0334 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:htmlblob "@rx <"

</LocationMatch>
<LocationMatch "/admin/addbookmark\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220782,chain,msg:'SLIQUA WAF: found CVE 2014-0334 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:title|ARGS_POST:url "@rx <"

</LocationMatch>
<LocationMatch "/admin/copystylesheet\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220783,chain,msg:'SLIQUA WAF: found CVE 2014-0334 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:stylesheet_name "@rx <"

</LocationMatch>
<LocationMatch "/admin/copytemplate\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220784,chain,msg:'SLIQUA WAF: found CVE 2014-0334 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:template_name "@rx <"

</LocationMatch>
<LocationMatch "/admin/editbookmark\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220785,chain,msg:'SLIQUA WAF: found CVE 2014-0334 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:title|ARGS_POST:url "@rx <"

</LocationMatch>
<LocationMatch "/admin/listtemplates\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220786,chain,msg:'SLIQUA WAF: found CVE 2014-0334 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:template "@rx <"

</LocationMatch>
<LocationMatch "/admin/listcss\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220787,chain,msg:'SLIQUA WAF: found CVE 2014-0334 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:css_name "@rx <"

</LocationMatch>
<LocationMatch "install">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220790,chain,msg:'SLIQUA WAF: found CVE 2014-2092 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:default_cms_lang|ARGS_POST:docroot "@rx <"

</LocationMatch>
<LocationMatch "lib/filemanager/ImageManager/editorFrame\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220791,chain,msg:'SLIQUA WAF: found CVE 2014-2092 attack',phase:2,deny,status:403,log"
SecRule ARGS_GET:action "@rx <"

</LocationMatch>
<LocationMatch "admin/addhtmlblob\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220792,chain,msg:'SLIQUA WAF: found CVE 2014-2092 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:htmlblob "@rx <"

</LocationMatch>
<LocationMatch "admin/addtemplate\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220793,chain,msg:'SLIQUA WAF: found CVE 2014-2092 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:template "@rx <"

</LocationMatch>
<LocationMatch "admin/addcss\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220794,chain,msg:'SLIQUA WAF: found CVE 2014-2092 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:css_name "@rx <"

</LocationMatch>
<LocationMatch "admin/siteprefs\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220795,chain,msg:'SLIQUA WAF: found CVE 2014-2092 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:metadata|ARGS_POST:sitedownmessage "@rx <"

</LocationMatch>
<LocationMatch "admin/pagedefaults\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220796,chain,msg:'SLIQUA WAF: found CVE 2014-2092 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:page_metadata "@rx <"

</LocationMatch>
<LocationMatch "admin/addbookmark\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220797,chain,msg:'SLIQUA WAF: found CVE 2014-2092 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:title "@rx <"

</LocationMatch>
<LocationMatch "admin/myaccount\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220798,chain,msg:'SLIQUA WAF: found CVE 2014-2092 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:date_format_string "@rx <"

</LocationMatch>
<LocationMatch "admin/adminlog\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220799,chain,msg:'SLIQUA WAF: found CVE 2014-2092 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:filteruser "@rx <"

</LocationMatch>
<LocationMatch "admin/editevent\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220800,chain,msg:'SLIQUA WAF: found CVE 2014-2092 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:handler "@rx <"

</LocationMatch>
<LocationMatch "manageajax\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220810,chain,msg:'SLIQUA WAF: found CVE: 2014-3246 attack',phase:2,deny,status:403,log"
SecRule ARGS_GET:action "@streq fileview_list" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule ARGS_GET:folder "!@rx ^\d+$" \
	"t:'none',t:'urlDecodeUni'"

</LocationMatch>
<LocationMatch "admin\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220820,chain,msg:'SLIQUA WAF: found CVE 2014-3247 attack',phase:2,deny,status:403,log"
SecRule ARGS_GET:action "@streq addpro" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule ARGS_POST:desc "@rx \'|\"|\<"

</LocationMatch>
SecRule REQUEST_FILENAME "@contains ajax_udf.php" \
	"id:220860,chain,msg:'SLIQUA WAF: Found CVE-2014-2317',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni'"
SecRule ARGS:table "!@rx ^[\w]*$"

<LocationMatch "/admin/users/add/user/">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220880,phase:2,pass,expirevar:'SESSION.UMICMS=3600',setvar:'SESSION.TIMEOUT=3600',setvar:'SESSION.UMICMS=1',nolog"

</LocationMatch>
<LocationMatch "/admin/users/add/user/do/">
SecRule SESSION:UMICMS "@eq 1" \
	"id:220881,phase:2,pass,nolog,skip:1"

SecRule REQUEST_METHOD "@streq POST" \
	"id:220882,chain,msg:'SLIQUA WAF: found CVE 2013-2754 attack',phase:2,deny,status:403,log"
SecRule ARGS_POST:data[new][login] "!@rx ^$" \
	"chain"
SecRule ARGS_POST:data[new][password][] "!@rx ^$"

</LocationMatch>
SecRule ARGS_GET:query "\"" \
	"id:220900,chain,msg:'SLIQUA WAF: found CVE-2014-2280 attack',deny,status:403,log,t:'none',t:'lowercase',t:'urlDecodeUni'"
SecRule REQUEST_FILENAME "/op\.search\.php" \
	"t:'none',t:'lowercase',t:'urlDecodeUni'"

SecRule ARGS_POST:keywords "\"" \
	"id:220910,chain,msg:'SLIQUA WAF: found CVE-2014-1840 attack',deny,status:403,log,t:'none',t:'lowercase',t:'urlDecodeUni'"
SecRule REQUEST_FILENAME "/upload/search\.php" \
	"chain,t:'none',t:'lowercase',t:'urlDecodeUni'"
SecRule ARGS:action "do_search"

SecRule REQUEST_FILENAME "/portal/addtoapplication\.php" \
	"id:220920,chain,msg:'SLIQUA WAF: Blocking Sql Injection (CVE-2014-2211)',phase:2,deny,status:403,log,t:'none',t:'htmlEntityDecode',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_GET:rssurl "!@rx ^(?:(?:http|ftp)[s]?:\/\/)?[a-zA-Z0-9\-\.]+\.([a-zA-Z]{2,3}|[0-9]{1,3})(:[0-9]+)?[a-zA-Z0-9\-\._\?\'/\\\+&%#\=~]*$" \
	"t:'none',t:'htmlEntityDecode',t:'urlDecodeUni',t:'lowercase'"

SecRule Request_URI "@rx \/shared-apartments-rooms\/.*<" \
	"id:220930,msg:'SLIQUA WAF: Blocking XSS attack (CVE-2014-2024)',phase:2,deny,status:403,log,t:'none',t:'htmlEntityDecode',t:'lowercase',t:'urlDecodeUni'"

SecRule ARGS_POST:/^extra_/ "\"" \
	"id:220940,chain,msg:'SLIQUA WAF: Blocking XSS attack (CVE-2014-1877)',phase:2,deny,status:403,log"
SecRule Request_FILENAME "(profile|user_edit|user_add)\.php"

SecRule ARGS_POST:title "\">" \
	"id:220941,chain,msg:'SLIQUA WAF: Blocking XSS attack (CVE-2014-1877)',phase:'2 deny',status:403,log"
SecRule Request_FILENAME "groups\.php"

SecRule Request_FILENAME "new_message\.php" \
	"id:220942,chain,msg:'SLIQUA WAF: Blocking XSS attack (CVE-2014-1877)',phase:2,deny,status:403,log,t:'none',t:'htmlEntityDecode',t:'lowercase',t:'urlDecodeUni'"
SecRule ARGS:content "\">"

SecRule ARGS:m1_sortby "!@rx ^\w+\W(ASC|DESC)$" \
	"id:220960,chain,msg:'SLIQUA WAF: Blocking SQL Injection attack (CVE-2014-2245)',phase:2,deny,status:403,log,t:'none',t:'htmlEntityDecode',t:'urlDecodeUni'"
SecRule Request_FILENAME "moduleinterface\.php"

SecRule REQUEST_URI "polls/vote\.php" \
	"id:220980,chain,msg:'SLIQUA WAF: found CVE-2013-5640 SQL injection protection',deny,status:403,log,t:'none',t:'urlDecodeUni',t:'htmlEntityDecode',multiMatch"
SecRule ARGS_POST:answer_id|ARGS_POST:question_id "@rx \D"

SecRule REQUEST_URI "comments/(add|edit)\.php|posts/add\.php" \
	"id:220981,chain,msg:'SLIQUA WAF: found CVE-2013-5640 SQL injection protection',deny,status:403,log,t:'none',t:'urlDecodeUni',t:'htmlEntityDecode',multiMatch"
SecRule ARGS_POST:story_id|ARGS_POST:thread_id "@rx \D"

SecRule REQUEST_URI "users/login\.php" \
	"id:220990,chain,msg:'SLIQUA WAF: found CVE-2013-5639 attack',deny,status:403,t:'none',t:'urlDecodeUni',t:'cmdline',multiMatch"
SecRule REQUEST_COOKIES:gnew_language "\.\./"

SecRule ARGS_GET:sort "!@rx \D" \
	"id:221020,chain,msg:'SLIQUA WAF: Blocking SQL INJECTION (CVE-2013-2559)',phase:2,deny,status:403,log,t:'none',t:'htmlEntityDecode',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_FILENAME "symphony/system/authors/"

<LocationMatch "/xmlrpc\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:221030,chain,msg:'SLIQUA WAF: found XML Quadratic Blowup Attack (CVE-2014-5266)',phase:2,deny,status:403,log"
SecRule REQUEST_BODY "@contains ENTITY" \
	"chain"
SecRule REQUEST_BODY "@rx (\;.*?\&.+?){100,}?"

SecRule HTTP_User-Agent "WinHttp\.WinHttpRequest\.5" \
	"id:221031,chain,msg:'SLIQUA WAF: found XML Quadratic Blowup Attack (CVE-2014-5266)',deny,status:403,t:'none',t:'removeWhitespace',t:'lowercase'"
SecRule &HTTP_REFERER "@eq 0" \
	"chain"
SecRule &HTTP_User-Agent "@eq 0"

</LocationMatch>
<LocationMatch "/symphony/system/authors">
SecRule REQUEST_METHOD "@streq GET" \
	"id:221040,chain,phase:2,pass,nolog"
SecRule QUERY_STRING "@rx ^$" \
	"expirevar:'SESSION.symphony=1200',setvar:'SESSION.TIMEOUT=1200',setvar:'SESSION.symphony=1',t:'none',t:'urlDecodeUni'"

SecRule SESSION:symphony "@eq 1" \
	"id:221041,phase:2,pass,nolog,skip:1"

SecRule REQUEST_METHOD "@streq GET" \
	"id:221042,chain,msg:'SLIQUA WAF: found CVE-2013-7346 CSRF attack',phase:2,deny,status:403,log"
SecRule ARGS_GET:order|ARGS_GET:sort "@rx ." \
	"t:'none',t:'urlDecodeUni'"

</LocationMatch>
SecRule ARGS_POST:title "\"" \
	"id:221050,chain,msg:'SLIQUA WAF: Blocking CVE-2013-4430',phase:2,deny,status:403,log,t:'none',t:'htmlEntityDecode',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_FILENAME "/artefact/internal/editnote\.php"

SecRule ARGS:categories_order "@rx \"(?:item_id|left|right)\"\s*:\s*(?!(?:null|\"\d+\"|\d+)\s*(?:,|}))" \
	"id:221070,chain,msg:'SLIQUA WAF: found CVE-2014-3783',phase:2,deny,status:403,log,t:'none',t:'htmlEntityDecode',t:'lowercase',t:'urlDecodeUni',multiMatch"
SecRule REQUEST_FILENAME "categories\.php"

SecRule REQUEST_URI "(?:channels|collections|groups|search_result|videos|view_collection|view_item)\.php" \
	"id:221080,chain,msg:'SLIQUA WAF: found CVE-2012-6644 Cross-site scripting (XSS) Attack',deny,status:403,log,t:'none',t:'urlDecodeUni',t:'htmlEntityDecode',t:'lowercase',multiMatch"
SecRule ARGS_GET:cat|ARGS_GET:query|ARGS_GET:type "\""

SecRule REQUEST_URI "view_channel\.php" \
	"id:221090,chain,msg:'SLIQUA WAF: Found CVE-2012-6642 Cross-site scripting (XSS) Attack',deny,status:403,log,t:'none',t:'urlDecodeUni',t:'htmlEntityDecode',multiMatch"
SecRule ARGS_GET:type "[^a-zA-Z]{1,}"

SecRule REQUEST_URI "channels\.php|videos\.php" \
	"id:221100,chain,msg:'SLIQUA WAF: Found CVE-2012-6643 SQL injection Attack',deny,status:403,log,t:'none',t:'urlDecodeUni',t:'htmlEntityDecode',multiMatch"
SecRule ARGS_GET:time "[^a-zA-Z_]{1,}"

SecRule ARGS_GET:graph_end|ARGS_GET:graph_height|ARGS_GET:graph_start|ARGS_GET:graph_width|ARGS_GET:local_graph_id|ARGS_GET:rra_id "[^0-9]" \
	"id:221110,chain,msg:'SLIQUA WAF: Protecting vulnerable application (CVE-2014-2708)',phase:1,deny,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_FILENAME "@streq graph_xport.php" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

<LocationMatch "index2\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:221120,phase:2,pass,expirevar:'SESSION.XCloner=3600',setvar:'SESSION.TIMEOUT=3600',setvar:'SESSION.XCloner=1',nolog"

SecRule SESSION:XCloner "@eq 1" \
	"id:221121,phase:2,pass,nolog,skip:1"

SecRule REQUEST_METHOD "@streq POST" \
	"id:221122,chain,msg:'SLIQUA WAF: found CVE 2014-2579 attack',phase:2,deny,status:403,log"
SecRule &ARGS_POST:jcuser "@eq 1" \
	"chain"
SecRule &ARGS_POST:jcpass "@eq 1" \
	"chain"
SecRule ARGS_POST:task "@streq config" \
	"chain"
SecRule ARGS_POST:action "@streq save"

</LocationMatch>
SecRule REQUEST_COOKIES:/fusion\w+user/ "@rx [^a-z0-9\.]" \
	"id:221190,msg:'SLIQUA WAF: SQL injection found CVE-2013-7375',phase:1,deny,log,t:'none',t:'htmlEntityDecode',t:'urlDecodeUni',t:'lowercase'"

SecRule REQUEST_COOKIES:dc_passwd "!@rx ^a:\d+:{(?:i:\d+;s:\d+:\".*?\";)*}$" \
	"id:221200,msg:'SLIQUA WAF: Code injection found CVE-2014-1613',phase:1,deny,log,t:'none',t:'htmlEntityDecode',t:'urlDecodeUni',t:'lowercase'"

SecRule ARGS_GET:orderby "!@rx ^download\_(?:id|user|title|count|datestamp)$" \
	"id:221290,chain,msg:'SLIQUA WAF: SQL INJECTION ATTACK FOUND - CVE 2013-1803',phase:1,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_FILENAME "@contains downloads.php" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'normalisePath',t:'lowercase'"

SecRule ARGS_NAMES "delete_attach_([^0-9]){1,}" \
	"id:221291,chain,msg:'SLIQUA WAF: SQL INJECTION ATTACK FOUND - CVE 2013-1803',phase:1,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_FILENAME "@contains postedit.php" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'normalisePath',t:'lowercase'"

SecRule ARGS_POST:pm_email_notify|ARGS_POST:pm_save_sent "!@rx ^(0|1)$" \
	"id:221292,chain,msg:'SLIQUA WAF: SQL Injection detected - CVE 2013-1803',phase:2,deny,status:403,log"
SecRule REQUEST_FILENAME "@contains administration/settings_messages.php" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'normalisePath',t:'lowercase'"

SecRule ARGS_POST:pm_inbox|ARGS_POST:pm_savebox|ARGS_POST:pm_sentbox "[^0-9]" \
	"id:221293,chain,msg:'SLIQUA WAF: SQL INJECTION ATTACK FOUND - CVE 2013-1803',phase:2,deny,status:403,log"
SecRule REQUEST_FILENAME "@contains administration/settings_messages.php" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'normalisePath',t:'lowercase'"

SecRule ARGS_POST:thumb_compression "!@rx ^gd\d$" \
	"id:221294,chain,msg:'SLIQUA WAF: SQL INJECTION ATTACK FOUND - CVE 2013-1803',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_FILENAME "@contains administration/settings_photo.php" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'normalisePath',t:'lowercase'"

SecRule ARGS_POST:/photo_watermark_text_color\d/ "!@rx ^(?:([0-9a-fA-F]){6})$" \
	"id:221295,chain,msg:'SLIQUA WAF: SQL INJECTION ATTACK FOUND - CVE 2013-1803',phase:2,deny,status:403,log"
SecRule REQUEST_FILENAME "@contains administration/settings_photo.php" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'normalisePath',t:'lowercase'"

SecRule ARGS_GET:enable "[^a-z!]" \
	"id:221296,chain,msg:'SLIQUA WAF: SQL INJECTION ATTACK FOUND - CVE 2013-1803',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_FILENAME "@contains administration/bbcodes.php" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'normalisePath',t:'lowercase'"

SecRule ARGS:news_image_1|ARGS:news_image_2|ARGS_POST:news_image "@rx \'" \
	"id:221297,chain,msg:'SLIQUA WAF: SQL INJECTION ATTACK FOUND - CVE 2013-1803',phase:2,deny,status:403,log"
SecRule REQUEST_FILENAME "@contains administration/news.php" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'normalisePath',t:'lowercase'"

SecRule ARGS_POST:article_id|ARGS_POST:news_id "[^0-9]" \
	"id:221298,chain,msg:'SLIQUA WAF: SQL INJECTION ATTACK FOUND - CVE 2013-1803',phase:2,deny,status:403,log"
SecRule REQUEST_FILENAME "administration/(articles|news)\.php" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'normalisePath',t:'lowercase'"

SecRule ARGS_POST:article_id "[^0-9]" \
	"id:221300,chain,msg:'SLIQUA WAF: WEB APPLICATION ATTACK FOUND (CVE-2014-4194)',phase:2,deny,status:403,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_FILENAME "@contains zero_transact_article.php" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule ARGS_GET:article_id "[^0-9]" \
	"id:221310,chain,msg:'SLIQUA WAF: WEB APPLICATION ATTACK FOUND (CVE-2014-4195)',phase:1,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_FILENAME "@contains zero_view_article.php" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule REQUEST_HEADERS:Referer "@contains >" \
	"id:221330,chain,msg:'SLIQUA WAF: Possible XSS Detected - CVE-2014-5108',phase:1,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'removeWhitespace'"
SecRule REQUEST_URI "@contains index.php/download_file" \
	"t:'none',t:'urlDecodeUni',t:'normalisePath',t:'removeWhitespace',t:'lowercase'"

SecRule REQUEST_FILENAME "@endsWith add.php" \
	"id:221340,chain,msg:'SLIQUA WAF: CVE-2014-4853 found',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'htmlEntityDecode',multiMatch"
SecRule FILES "@contains >"

SecRule REQUEST_FILENAME "@endsWith user/fiche.php" \
	"id:221350,chain,msg:'SLIQUA WAF: found CVE-2014-3992 (SQL injection)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'htmlEntityDecode',multiMatch"
SecRule ARGS_POST:entity "@rx \D"

SecRule REQUEST_FILENAME "@endsWith user/group/index.php" \
	"id:221351,chain,msg:'SLIQUA WAF: found CVE-2014-3992 (SQL injection)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'htmlEntityDecode',multiMatch"
SecRule ARGS_GET:sortorder "@rx !(asc|desc)" \
	"t:'lowercase'"

SecRule ARGS_GET:leftmenu|ARGS_GET:mainmenu|ARGS_POST:dol_hide_leftmenu|ARGS_POST:dol_hide_topmenu|ARGS_POST:dol_no_mouse_hover|ARGS_POST:dol_optimize_smallscreen|ARGS_POST:dol_use_jmobile "@contains >" \
	"id:221360,msg:'SLIQUA WAF: CVE-2014-3991 found (XSS protection)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'htmlEntityDecode',multiMatch"

SecRule REQUEST_FILENAME "@endsWith user/index.php" \
	"id:221361,chain,msg:'SLIQUA WAF: CVE-2014-3991 found (XSS protection)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'htmlEntityDecode',multiMatch"
SecRule ARGS_GET:dol_hide_leftmenu|ARGS_GET:dol_hide_topmenu|ARGS_GET:dol_no_mouse_hover|ARGS_GET:dol_optimize_smallscreen|ARGS_GET:dol_use_jmobile "@contains >"

SecRule REQUEST_FILENAME "@endsWith user/logout.php" \
	"id:221362,chain,msg:'SLIQUA WAF: CVE-2014-3991 found (XSS protection)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'htmlEntityDecode',multiMatch"
SecRule ARGS_GET:dol_hide_leftmenu|ARGS_GET:dol_hide_topmenu|ARGS_GET:dol_no_mouse_hover|ARGS_GET:dol_optimize_smallscreen|ARGS_GET:dol_use_jmobile "@contains >"

SecRule REQUEST_FILENAME "@endsWith user/fiche.php" \
	"id:221363,chain,msg:'SLIQUA WAF: CVE-2014-3991 found (XSS protection)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'htmlEntityDecode',multiMatch"
SecRule ARGS_POST:email|ARGS_POST:firstname|ARGS_POST:job|ARGS_POST:lastname|ARGS_POST:login "@contains >"

SecRule REQUEST_FILENAME "@endsWith viewimage.php" \
	"id:221364,chain,msg:'SLIQUA WAF: CVE-2014-3991 found (XSS protection)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'htmlEntityDecode',multiMatch"
SecRule ARGS_GET:file|ARGS_GET:modulepart "@contains >"

SecRule ARGS:xmlin "@contains .." \
	"id:221470,chain,msg:'SLIQUA WAF: blocking CVE-2014-3777',phase:2,deny,status:403,log,t:'none',t:'htmlEntityDecode',t:'urlDecodeUni',t:'normalisePath'"
SecRule REQUEST_FILENAME "@contains run.php" \
	"t:'none',t:'htmlEntityDecode',t:'urlDecodeUni',t:'lowercase'"

<LocationMatch "/kan">
SecRule REQUEST_METHOD "@streq GET" \
	"id:221480,chain,phase:2,pass,expirevar:'SESSION.kan=3600',setvar:'SESSION.TIMEOUT=3600',setvar:'SESSION.kan=1',nolog"
SecRule ARGS_GET:controller "@streq user" \
	"chain"
SecRule ARGS_GET:action "@streq create"

SecRule SESSION:kan "@eq 1" \
	"id:221481,phase:2,pass,nolog,skip:1"

SecRule REQUEST_METHOD "@streq POST" \
	"id:221482,chain,msg:'SLIQUA WAF: found CVE 2014-3920 attack',phase:2,deny,status:403,log"
SecRule ARGS_GET:controller "@streq user" \
	"chain"
SecRule ARGS_GET:action "@streq save" \
	"chain"
SecRule &ARGS_POST:username "@eq 1" \
	"chain"
SecRule &ARGS_POST:name "@eq 1" \
	"chain"
SecRule &ARGS_POST:password "@eq 1"

SecRule ARGS_GET:table "@rx '|<" \
	"id:221490,chain,msg:'SLIQUA WAF: found CVE-2014-4955 attack',deny,status:403,log,t:'none',t:'htmlEntityDecode',t:'urlDecodeUni'"
SecRule REQUEST_FILENAME "@contains db_triggers.php" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

</LocationMatch>
SecRule REQUEST_COOKIES_NAMES "@streq foecms_lang" \
	"id:221550,chain,msg:'SLIQUA WAF: Possible SQL Injection - CVE-2014-4850',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'removeWhitespace',skip:1"
SecRule ARGS_GET:i|REQUEST_COOKIES:foecms_lang "!@rx \d" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace'"

SecRule RESPONSE_HEADERS:Set-Cookie "@rx ^foecms_lang=(.*);\ expires.*$" \
	"id:221551,chain,msg:'SLIQUA WAF: Possible SQL Injection - CVE-2014-4850',phase:3,capture,deny,status:403,log,t:'none'"
SecRule TX:1 "!@rx ^\d$"

SecRule REQUEST_FILENAME "@endsWith user/edit.php" \
	"id:221560,chain,msg:'SLIQUA WAF: Possible XSS Attack - CVE-2014-3544',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule REQUEST_COOKIES_NAMES "@streq MoodleSession" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule ARGS_POST:skype "!@rx ^(?:live:|[a-z0-9,\._\-]){6,32}$" \
	"t:'none',t:'urlDecodeUni',t:'compressWhitespace',t:'lowercase',multiMatch"

SecRule REQUEST_FILENAME "@endsWith login/index.php" \
	"id:221570,chain,msg:'SLIQUA WAF: Possible XSS Attack - CVE-2014-3549',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'removeWhitespace',t:'lowercase'"
SecRule &SESSION:moodlesession "@gt 0" \
	"chain"
SecRule ARGS_POST:username "@rx [^\w\-\.\@]" \
	"t:'none',t:'urlDecodeUni',t:'compressWhitespace',t:'lowercase',multiMatch"

SecRule REQUEST_FILENAME "@contains firewall_schedule_edit.php" \
	"id:221610,chain,msg:'SLIQUA WAF: Found CVE-2014-4687 Cross-site scripting (XSS) Attack',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:starttime0|ARGS:stoptime0 "@contains \"" \
	"t:'none',t:'urlDecodeUni',multiMatch"

SecRule REQUEST_FILENAME "@contains widgets/widgets/rss.widget.php" \
	"id:221611,chain,msg:'SLIQUA WAF: Found CVE-2014-4687 Cross-site scripting (XSS) Attack',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:rssfeed|ARGS:rssmaxitems|ARGS:rsswidgetheight|ARGS:rsswidgettextlength "\"@contains <\" \"multiMatch,t:none," \
	"t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@contains widgets/widgets/services_status.widget.php" \
	"id:221612,chain,msg:'SLIQUA WAF: Found CVE-2014-4687 Cross-site scripting (XSS) Attack',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:servicestatusfilter "@contains \"" \
	"t:'none',t:'urlDecodeUni',multiMatch"

SecRule REQUEST_FILENAME "@contains widgets/widgets/log.widget.php" \
	"id:221613,chain,msg:'SLIQUA WAF: Found CVE-2014-4687 Cross-site scripting (XSS) Attack',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:actblock|ARGS:actpass|ARGS:actreject "!@rx ^(pass|block|reject)$" \
	"t:'none',t:'lowercase'"

SecRule REQUEST_FILENAME "@contains widgets/widgets/log.widget.php" \
	"id:221614,chain,msg:'SLIQUA WAF: Found CVE-2014-4687 Cross-site scripting (XSS) Attack',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:filterlogentries|ARGS:filterlogentriesinterfaces "@rx [\"|<|>|']" \
	"t:'none',t:'urlDecodeUni',multiMatch"

SecRule REQUEST_FILENAME "@endsWith status_rrd_graph_img.php" \
	"id:221620,chain,msg:'SLIQUA WAF: Found CVE-2014-4688 Cross-site scripting (XSS) Attack',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:database|ARGS:graph "@rx [\\\\|\||\"|\0|'|\/]" \
	"t:'none',t:'urlDecodeUni',multiMatch"

SecRule REQUEST_FILENAME "@endsWith pkg_mgr_install.php" \
	"id:221630,chain,msg:'SLIQUA WAF: Found CVE-2014-4689 Cross-site scripting (XSS) Attack',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:id|ARGS:mode|ARGS:pkg "@rx [\\\\|\||\.|\"|\0|'|\/]" \
	"t:'none',t:'urlDecodeUni',multiMatch"

SecRule REQUEST_FILENAME "@endsWith pkg_edit.php" \
	"id:221631,chain,msg:'SLIQUA WAF: Found CVE-2014-4689 Cross-site scripting (XSS) Attack',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:xml "@rx [\\\\|\//\.|\0]" \
	"t:'none',t:'urlDecodeUni',multiMatch"

SecRule REQUEST_FILENAME "@endsWith system_firmware_restorefullbackup.php" \
	"id:221632,chain,msg:'SLIQUA WAF: Found CVE-2014-4689 Cross-site scripting (XSS) Attack',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:downloadbackup "@rx [\\\\|\//\.|\0]" \
	"t:'none',t:'urlDecodeUni',multiMatch"

SecRule ARGS_GET:phpfile "@rx ^[\.\\\\\/]+" \
	"id:221640,msg:'SLIQUA WAF: found CVE-2014-5115 attack',phase:2,deny,status:403,log,t:'none',t:'normalisePath'"

SecRule REQUEST_FILENAME "@endsWith admin/uploads.php" \
	"id:221650,chain,msg:'SLIQUA WAF: Found CVE-2014-4852 SQLi Attack',phase:2,deny,status:403,log,t:'none',t:'lowercase',t:'normalisePath'"
SecRule ARGS_GET:id "@rx \D+" \
	"t:'none'"

SecRule REQUEST_URI "@contains admin/admin.php" \
	"id:221820,chain,msg:'SLIQUA WAF: Blocking CVE-2014-5194',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'htmlEntityDecode',t:'normalisePath',multiMatch"
SecRule ARGS_GET:_word_upper_bound "@rx \D" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_URI "@contains admin/admin.php" \
	"id:222000,chain,msg:'SLIQUA WAF: Blocking CVE-2014-5193',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'htmlEntityDecode',t:'lowercase',t:'normalisePath',t:'removeWhitespace',multiMatch"
SecRule ARGS_POST:f "@rx \d" \
	"chain,t:'none',t:'urlDecodeUni',t:'htmlEntityDecode',t:'removeWhitespace'"
SecRule ARGS_POST:category "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule &ARGS_GET:do "!eq 0" \
	"id:222060,chain,msg:'SLIQUA WAF: SQL injection in Kasseler CMS (CVE-2013-3727)',phase:2,deny,status:403,log"
SecRule ARGS:module "@pm sendmail news voting forum account categories" \
	"chain,t:'none',t:'lowercase',multiMatch"
SecRule ARGS:desc|ARGS:dok|ARGS:fid|ARGS:groups[]|ARGS:id|ARGS:module|ARGS:nid|ARGS:tid|ARGS:tid|ARGS:vid "@rx [\'\,]" \
	"chain,t:'none',t:'urlDecodeUni',multiMatch"
SecRule REQUEST_FILENAME "@pm admin.php index.php" \
	"t:'none',t:'urlDecodeUni',t:'lowercase',multiMatch"

SecRule &ARGS_GET:do "!eq 0" \
	"id:222070,chain,msg:'SLIQUA WAF: XSS in Kasseler CMS (CVE-2013-3728)',phase:2,deny,status:403,log"
SecRule ARGS_GET:module "@pm sendmail news voting forum account categories database" \
	"chain,t:'none',t:'lowercase',multiMatch"
SecRule ARGS:cat|ARGS:desc|ARGS:dok|ARGS:fid|ARGS:groups[]|ARGS:id|ARGS:module|ARGS:nid|ARGS:tid|ARGS:tid|ARGS:vid "@contains >" \
	"chain,t:'none',t:'urlDecodeUni',multiMatch"
SecRule REQUEST_FILENAME "@pm admin.php index.php" \
	"t:'none',t:'urlDecodeUni',t:'lowercase',multiMatch"

SecRule REQUEST_COOKIES:/^http(?:.*)token$/ "@rx ([\w]{40})" \
	"id:222120,chain,msg:'SLIQUA WAF: Possible XSS Attack in Feng Office (CVE-2014-5343)',phase:2,deny,status:403,log"
SecRule ARGS_GET:c "@streq customer" \
	"chain,t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'lowercase',multiMatch"
SecRule ARGS_GET:a "@streq add" \
	"chain,t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'lowercase',multiMatch"
SecRule ARGS_POST:customer[name] "@rx [\<\"]" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace',multiMatch"

SecRule REQUEST_FILENAME "@endsWith admin.php" \
	"id:222130,chain,msg:'SLIQUA WAF: Sphider Injectable form detected (CVE-2014-5192)',phase:2,pass,nolog,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'removeWhitespace',t:'lowercase',multiMatch"
SecRule &ARGS:site_id "@gt 0" \
	"chain"
SecRule &ARGS:f "@gt 0" \
	"chain"
SecRule &ARGS:filter "@gt 0" \
	"chain"
SecRule &REQUEST_COOKIES:PHPSESSID "@gt 0" \
	"setvar:'SESSION.sphider=1',setsid:'%{TIME_EPOCH}'"

SecRule SESSION:sphider "@eq 1" \
	"id:222131,chain,msg:'SLIQUA WAF: SQLi Detected in Sphider (CVE-2014-5192)',phase:2,deny,status:403,log,skip:1"
SecRule ARGS:filter "@detectSQLi" \
	"t:'none',t:'urlDecodeUni',t:'sqlHexDecode',t:'removeWhitespace',t:'lowercase',multiMatch"

SecRule SESSION:sphider "@eq 1" \
	"id:222132,chain,msg:'SLIQUA WAF: SQLi Detected in Sphider (CVE-2014-5192)',phase:2,deny,status:403,log"
SecRule ARGS:filter "@contains '" \
	"t:'none',t:'urlDecodeUni',t:'sqlHexDecode',t:'removeWhitespace',t:'lowercase',multiMatch"

SecRule REQUEST_FILENAME "@endsWith browse.php" \
	"id:222140,chain,msg:'SLIQUA WAF: Possible Directory Traversal in Vtiger CRM before 6.0.0 Security patch 1 (CVE-2014-1222)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'lowercase',multiMatch"
SecRule REQUEST_COOKIES_NAMES "@contains vtiger" \
	"chain,t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'lowercase',multiMatch"
SecRule ARGS_GET:act "@streq download" \
	"chain,t:'none',t:'urlDecodeUni',t:'lowercase',multiMatch"
SecRule &ARGS_POST:dir "@ge 1" \
	"chain,t:'none',t:'urlDecodeUni',t:'lowercase',multiMatch"
SecRule ARGS_POST:file "@contains .." \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode',t:'removeWhitespace',multiMatch"

SecRule ARGS_POST:drp_action "@rx \D" \
	"id:222330,chain,msg:'SLIQUA WAF: XSS vulnerabilities in Cacti 0.8.8b (CVE-2014-4002)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni'"
SecRule REQUEST_FILENAME "@pm cdef.php data_input.php data_queries.php data_sources.php data_templates.php graph_templates.php graphs.php host.php host_templates.php" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule ARGS_POST:graph_template_id|ARGS_POST:graph_template_input_id "@rx \D" \
	"id:222331,chain,msg:'SLIQUA WAF: XSS vulnerabilities in Cacti 0.8.8b (CVE-2014-4002)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni'"
SecRule REQUEST_FILENAME "@endsWith graph_templates_inputs.php" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule ARGS_GET:app "@pm blog html menus" \
	"id:240040,chain,msg:'SLIQUA WAF: XSS vulnerabilities in Baby Gekko before 1.2.2f (CVE-2012-5700)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',multiMatch"
SecRule ARGS_GET:action "@streq edititem" \
	"chain,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_FILENAME "@contains admin/index.php" \
	"chain,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_GET:id "@contains <" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_URI "@endsWith users/action/login" \
	"id:240041,chain,phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule REQUEST_COOKIES_NAMES "@contains gusr" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:username|ARGS_POST:password "@rx \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule ARGS_POST:title "@contains <" \
	"id:240050,chain,msg:'SLIQUA WAF: XSS vulnerability in the admin interface in Phorum before 5.2.19 (CVE-2012-6659)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni'"
SecRule REQUEST_COOKIES_NAMES "@contains phorum_session_v5" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:module "settings" \
	"chain,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_FILENAME "@contains admin.php" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule REQUEST_URI "@endsWith sa/getparticipants_json" \
	"id:240060,chain,msg:'SLIQUA WAF: SQL injection vulnerability in LimeSurvey 2.05+ Build 140618 (CVE-2014-5017)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase',multiMatch"
SecRule ARGS_POST:sidx "@contains '" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_URI "@contains participants/sa/getAttribute_json/pid/" \
	"id:240070,chain,msg:'SLIQUA WAF: Multiple XSS vulnerabilities in LimeSurvey 2.05+ Build 140618 (CVE-2014-5016)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_LINE "@contains <" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_URI "@contains admin/globalsettings" \
	"id:240071,chain,msg:'SLIQUA WAF: Multiple XSS vulnerabilities in LimeSurvey 2.05+ Build 140618 (CVE-2014-5016)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_GET:sa "@rx \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_URI "@contains survey/index" \
	"id:240080,chain,msg:'SLIQUA WAF: XSS vulnerability in LimeSurvey 2.05+ Build 140618 (CVE-2014-5018)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:loadname "@rx \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith timthumb.php" \
	"id:240090,chain,msg:'SLIQUA WAF: CVE-2010-5302 / CVE-2010-5303 / CVE-2009-5142 found',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_GET:src "@pm < >" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@contains register-exec.php" \
	"id:240100,chain,msg:'SLIQUA WAF: Multiple XSS vulnerabilities in Restaurant Script (PizzaInn_Project) 1.0.0 (CVE-2014-6619)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:fname|ARGS_POST:lname|ARGS_POST:login "@contains '" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith modules/lib_jquery/plugins/cattranslate/cattranslate.php" \
	"id:240110,chain,msg:'SLIQUA WAF: XSS vulnerability in the CatTranslate JQuery plugin in BlackCat CMS 1.0.3 (CVE-2014-5259)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &REQUEST_COOKIES:/cat[\d]{4}sessionid/ "@ge 1" \
	"chain"
SecRule ARGS:msg "@contains <" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@rx maint\/modules\/(home\/index|asterisk_info\/asterisk_info|repo\/repo|endpointcfg\/endpointcfg)\.php" \
	"id:240120,chain,msg:'SLIQUA WAF: Multiple directory traversal vulnerabilities in Fonality trixbox allow remote attackers to read arbitrary files (CVE-2014-5111)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:lang "@contains .." \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith endpoint_generic.php" \
	"id:240130,chain,msg:'SLIQUA WAF: SQL injection vulnerability in Fonality trixbox (CVE-2014-5109)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS:mac "!@rx ^[0-9a-f]{12}$" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@contains user/help/html/index.php" \
	"id:240131,chain,msg:'SLIQUA WAF: XSS vulnerability in Fonality trixbox (CVE-2014-5110)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:id_nodo "@rx \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@contains maint/modules/home/index.php" \
	"id:240140,chain,msg:'SLIQUA WAF: Fonality trixbox allows remote attackers to execute arbitrary commands (CVE-2014-5112)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:lang "@rx [^a-zA-Z0-9_]" \
	"t:'none',t:'urlDecodeUni',t:'cmdLine'"

SecRule REQUEST_COOKIES_NAMES "@pm data_layout main_layout" \
	"id:240150,chain,msg:'SLIQUA WAF: XSS vulnerability in MyWebSQL 3.4 and earlier (CVE-2014-4735)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS:table "@pm < >" \
	"t:'none',t:'urlDecodeUni'"

<LocationMatch ".*import\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:240160,chain,msg:'SLIQUA WAF: XSS vulnerability in phpMyAdmin before 4.1.7 (CVE-2014-1879)',phase:2,deny,status:403,log,t:'none'"
SecRule FILES:import_file "@contains <"

</LocationMatch>
SecRule REQUEST_FILENAME "@contains haltResumeHsp.php" \
	"id:240170,chain,msg:'SLIQUA WAF: SQL injection vulnerability in OrangeHRM before 2.7 (CVE-2012-1506)',phase:1,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_GET:hspSummaryId "\D" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@contains modules/pm/pmlite.php" \
	"id:240180,chain,msg:2,msg:'SLIQUA WAF: Multiple XSS vulnerabilities in XOOPS before 2.5.5 (CVE-2012-0984)',deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:to_userid "@rx \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@contains class/xoopseditor/tinymce/tinymce/jscripts/tiny_mce/plugins/xoopsimagemanager/xoopsimagebrowser.php" \
	"id:240181,chain,msg:'SLIQUA WAF: Multiple XSS vulnerabilities in XOOPS before 2.5.5 (CVE-2012-0984)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:current_file|ARGS_POST:imgcat_id|ARGS_POST:target "@rx \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@rx concrete\/single_pages\/dashboard\/(?:(?:system\/(basics|mail|environment|permissions|seo)?|users|scrapbook|pages|files)?\/?(?:editor|file_storage_locations|importers|method|file_types|files|tasks|users|attributes|search)?(view)?)\.php" \
	"id:240190,chain,msg:'SLIQUA WAF: Information leakage in the Concrete5 before 5.6.3 (CVE-2014-5107)',phase:4,deny,status:403,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule RESPONSE_BODY "@beginsWith Fatalerror:" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace'"

SecRule REQUEST_FILENAME "@endsWith admin/tool/task/scheduledtasks.php" \
	"id:240200,chain,msg:'SLIQUA WAF: Multiple XSS vulnerabilities in Moodle 2.7.x before 2.7.1 (CVE-2014-3550)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &SESSION:moodlesession "@gt 0" \
	"chain"
SecRule ARGS:success|ARGS:error "@pm < > /" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@rx (badges\/mybadges|user\/profile)\.php$" \
	"id:240210,chain,msg:'SLIQUA WAF: Multiple XSS vulnerabilities in Moodle 2.5.x before 2.5.7, 2.6.x before 2.6.4 (CVE-2014-3547)',phase:4,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &SESSION:moodlesession "@gt 0" \
	"chain"
SecRule RESPONSE_BODY "!@rx <spanclass=\"badge\-name\">[a-z0-9\.'\!\:\-]+<\/a><\/li>"

SecRule REQUEST_FILENAME "@contains templates/hrfunct/emppop.php" \
	"id:240220,chain,msg:'SLIQUA WAF: Multiple XSS vulnerabilities in OrangeHRM before 2.7 (CVE-2012-1507)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &ARGS_GET:reqcode "@ge 1" \
	"chain"
SecRule ARGS_GET:sortOrder1 "!@pm asc desc" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule REQUEST_FILENAME "@contains plugins/ajaxcalls/haltresumehsp.php" \
	"id:240221,chain,msg:'SLIQUA WAF: Multiple XSS vulnerabilities in OrangeHRM before 2.7 (CVE-2012-1507)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &ARGS_GET:hspSummaryId "@ge 1" \
	"chain"
SecRule ARGS_GET:newHspStatus "@rx \D" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule &ARGS_GET:empId "@ge 1"

SecRule ARGS_GET:page "@streq posts" \
	"id:240230,chain,msg:'SLIQUA WAF: XSS vulnerabilities in the MetalGenix GeniXCMS 0.0.3 (CVE-2015-5066)',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:act "add" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:title|ARGS_POST:content "@rx \"|'" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule REQUEST_FILENAME "index.php" \
	"t:'none',t:'lowercase'"

SecRule ARGS_GET:page "posts" \
	"id:240231,chain,msg:'SLIQUA WAF: XSS vulnerabilities in the MetalGenix GeniXCMS 0.0.3 (CVE-2015-5066)',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:q "@rx \'" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule REQUEST_FILENAME "index.php" \
	"t:'none',t:'lowercase'"

<LocationMatch ".*/dashboard/users/create/">
SecRule REQUEST_COOKIES:_ga "@rx ^ga(\d+\.*)+" \
	"id:240250,phase:2,capture,pass,setsid:'%{TX.1}',nolog,t:'none',t:'lowercase'"

SecRule REQUEST_COOKIES_NAMES "@contains _ga" \
	"id:240251,chain,phase:2,pass,nolog,t:'none',t:'lowercase'"
SecRule REQUEST_METHOD "@streq get" \
	"expirevar:'SESSION.articleFR=300',setvar:'SESSION.TIMEOUT=300',setvar:'SESSION.articleFR=1',t:'none',t:'lowercase'"

SecRule SESSION:articleFR "@eq 1" \
	"id:240252,phase:2,pass,nolog,skip:1"

SecRule REQUEST_METHOD "@streq post" \
	"id:240253,chain,msg:'COMODO: CSRF vulnerabilities in Free Reprintables ArticleFR 3.0.6 (CVE-2015-5530)',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_NAMES "@pm username name password email website blog membership isactive" \
	"chain,t:'none',t:'lowercase'"
SecRule &SESSION:articleFR "!@eq 1"

</LocationMatch>
SecRule REQUEST_URI "@contains /dashboard/settings/categories" \
	"id:240260,chain,msg:'COMODO: XSS vulnerabilities in Free Reprintables ArticleFR 3.0.6 (CVE-2015-5529)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:name "@rx <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_URI "@contains /dashboard/settings/links" \
	"id:240261,chain,msg:'COMODO: XSS vulnerabilities in Free Reprintables ArticleFR 3.0.6 (CVE-2015-5529)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:title|ARGS_POST:rel|ARGS_POST:url "@rx <" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule REQUEST_URI "@contains /dashboard/tools/pingservers" \
	"id:240262,chain,msg:'COMODO: XSS vulnerabilities in Free Reprintables ArticleFR 3.0.6 (CVE-2015-5529)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:url "@rx <" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule ARGS:action "@streq do_install" \
	"id:240270,chain,msg:'SLIQUA WAF: SQL injection vulnerability in Domain Technologie Control (DTC) before 0.32.11 (CVE-2011-5276)',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:database_name "@rx \W" \
	"t:'none'"

SecRule ARGS:action "@pm do_install prepareinstall" \
	"id:240271,chain,msg:'SLIQUA WAF: Directory traversal vulnerability in Domain Technologie Control (DTC) before 0.34.1 (CVE-2011-5273)',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:pkg "@contains .." \
	"t:'none'"

SecRule REQUEST_COOKIES_NAMES "@contains cacti" \
	"id:240280,chain,msg:'SLIQUA WAF: SQL injection vulnerability in Cacti before 0.8.8e (CVE-2015-4634)',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_FILENAME "@endsWith graphs.php" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:local_graph_id "@rx \D" \
	"t:'none'"

SecRule REQUEST_FILENAME "@contains rate.php" \
	"id:240300,chain,msg:'SLIQUA WAF: SQL injection vulnerabilities in Free Reprintables ArticleFR 3.0.4 (CVE-2014-5097)',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:act "@pm set get" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:id "@rx \D" \
	"t:'none'"

SecRule REQUEST_FILENAME "@rx \/(plupload\.flash|moxie)\.swf$" \
	"id:240320,chain,msg:'SLIQUA WAF: XSS vulnerability in in the Plupload plugin for WordPress and other web apps (CVE-2013-0237, CVE-2015-3439)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule &ARGS:id|&ARGS:target "@gt 0" \
	"t:'none',t:'lowercase'"

SecRule REQUEST_METHOD "!@streq post" \
	"id:240330,phase:2,pass,nolog,t:'none',t:'lowercase',skipAfter:'END_XMLRPC_PROTECTION'"

SecRule REQUEST_FILENAME "!@endsWith xmlrpc.php" \
	"id:240331,phase:2,pass,nolog,t:'none',t:'urlDecodeUni',t:'lowercase',skipAfter:'END_XMLRPC_PROTECTION'"

SecRule &IP:XMLRPC_COUNTER "@eq 0" \
	"id:240332,phase:2,pass,expirevar:'ip.xmlrpc_counter=%{tx.xmlrpc_watch_period}',setvar:'ip.xmlrpc_counter=1',nolog,t:'none',skip:1"

SecAction \
	"id:240333,phase:2,pass,setvar:'ip.xmlrpc_counter=+1',nolog"

SecRule IP:XMLRPC_COUNTER "@gt %{tx.xmlrpc_requests_limit}" \
	"id:240334,phase:2,pass,expirevar:'ip.xmlrpc_block=%{tx.xmlrpc_block_timeout}',setvar:'ip.xmlrpc_block=1',nolog,t:'none'"

SecRule IP:XMLRPC_BLOCK "@eq 1" \
	"id:240335,chain,msg:'SLIQUA WAF: XML-RPC Attack Identified from %{tx.real_ip} (%{tx.xmlrpc_block_counter} hits since last alert) (CVE-2013-0235)',phase:2,block,log,t:'none',skip:1"
SecRule &IP:XMLRPC_BLOCK_FLAG "@eq 0" \
	"expirevar:'ip.xmlrpc_block_flag=60',setvar:'ip.xmlrpc_block_flag=1',setvar:'tx.xmlrpc_block_counter=%{ip.xmlrpc_block_counter}+1',setvar:'ip.xmlrpc_block_counter=0'"

SecRule IP:XMLRPC_BLOCK "@eq 1" \
	"id:240336,phase:2,block,setvar:'ip.xmlrpc_block_counter=+1',nolog,t:'none'"

SecMarker END_XMLRPC_PROTECTION
SecRule REQUEST_FILENAME "@endsWith /site/tools/searchResults.php" \
	"id:240340,chain,msg:'SLIQUA WAF: XSS vulnerabilities in phpipam 1.1.010 (CVE-2015-6529)',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni'"
SecRule ARGS_POST:addresses "@streq on" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:ip "@rx \"" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith site/error.php" \
	"id:240341,chain,msg:'SLIQUA WAF: XSS vulnerabilities in phpipam 1.1.010 (CVE-2015-6529)',phase:1,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_GET:section "@rx \D" \
	"t:'none'"

