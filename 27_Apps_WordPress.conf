# ---------------------------------------------------------------
# Comodo ModSecurity Rules
# Copyright (C) 2015 Comodo Security solutions All rights reserved.
#
# The COMODO SECURITY SOLUTIONS Mod Security Rule Set is distributed under
# THE COMODO SECURITY SOLUTIONS END USER LICENSE AGREEMENT,
# Please see the enclosed LICENCE file for full details.
# ---------------------------------------------------------------
# This is a FILE CONTAINING CHANGED or MODIFIED RULES FROM THE:
# OWASP ModSecurity Core Rule Set (CRS)
# ---------------------------------------------------------------

<LocationMatch "/wp-admin/options-discussion\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220380,phase:2,pass,expirevar:'SESSION.wordpress_2011_csrf=3600',setvar:'SESSION.TIMEOUT=3600',setvar:'SESSION.wordpress_2011_csrf=1',nolog"

</LocationMatch>
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/sexy-contact-form/includes/fileupload/" \
	"id:240020,chain,msg:'COMODO WAF: Protecting WordPress Creative Contact Form Files folder',phase:2,deny,status:403,t:'none',t:'urlDecodeUni',t:'lowercase',t:'normalisePath'"
SecRule FILES "@rx \.(?:php|js|pl)(?:\.|$)" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule REQUEST_FILENAME "@contains /wp-content/plugins/sexy-contact-form/includes/fileupload/files/" \
	"id:240021,chain,msg:'COMODO WAF: Protecting WordPress Creative Contact Form Files folder',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'normalisePath'"
SecRule REQUEST_BASENAME "@rx \.(?:php|js|pl)(?:\.|$)" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

