# ---------------------------------------------------------------
# Sliqua WAF based on Comodo ModSecurity Rules
# Copyright (C) 2016 Sliqua Enterprise Hosting, Inc.
# Copyright (C) 2015 Comodo Security solutions All rights reserved.
# Please see the enclosed LICENCE file for full details.
# ---------------------------------------------------------------
# This is a FILE CONTAINING CHANGED or MODIFIED RULES FROM THE:
# OWASP ModSecurity Core Rule Set (CRS)
# Comodo Web Application Firewall
# ----------------------------------------------------------------

SecRule REQUEST_LINE "@contains /includes/header.php" \
	"id:220010,rev:1,chain,msg:'COMODO WAF: found CVE-2008-2898 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,t:'none',t:'lowercase',t:'urlDecodeUni',t:'htmlEntityDecode',t:'normalisePathWin'"
SecRule REQUEST_LINE "@contains GET " \
	"chain"
SecRule ARGS:c_temp_path "@contains ../"

SecRule REQUEST_FILENAME "admin/plugin-index\.php|admin/plugin-settings\.php|admin/plugin-preferences\.php" \
	"id:220060,rev:1,chain,msg:'COMODO WAF: found CVE-2013-3515 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'lowercase'"
SecRule ARGS:action|ARGS:group|ARGS:package|ARGS:parent|ARGS:plugin "@rx [^a-zA-Z0-9\._-]"

SecRule REQUEST_FILENAME "@rx /data/form_[0-9]+/files/element_[0-9]+.*\.php" \
	"id:220070,rev:1,msg:'COMODO WAF: found CVE-2013-4949 attack|%{tx.domain}|%{tx.mode}',phase:1,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule QUERY_STRING "@rx (login|signup)" \
	"id:220080,rev:1,chain,msg:'COMODO WAF: found CVE-2013-4951 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,t:'none'"
SecRule ARGS_POST:name|ARGS_POST:pass "@rx </?script" \
	"t:'none',t:'urlDecodeUni',t:'lowercase',t:'removeWhitespace'"

SecRule REQUEST_FILENAME "libraries\/(?:error(?:_handler)?\.class|auth\/swekey\/swekey\.auth\.lib|bookmark\.lib|common\.inc|config\.class|config\.default|data_drizzle\.inc|data_mysql\.inc|dbi\/drizzle-wrappers\.lib|display_tbl\.lib|engines\/(?:bdb|berkeleydb|binlog|innobase|innodb|memory|merge|mrg_myisam|myisam|ndbcluster|pbms|pbxt)\.lib|list_database\.class|pdf\.class|pma|pmd_common|recenttable\.class|schema\/pdf_relation_schema\.class)\.php" \
	"id:220090,rev:2,msg:'COMODO WAF: Multiple vulnerabilities in phpMyAdmin (CVE-2013-4998 / CVE-2013-4999 / CVE-2013-5000)|%{tx.domain}|%{tx.mode}',phase:1,severity:2,deny,status:403,log,t:'none',t:'lowercase'"

SecRule REQUEST_METHOD "@streq POST" \
	"id:220100,rev:1,chain,msg:'COMODO WAF: found CVE-2013-5003 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule REQUEST_FILENAME "pmd_pdf\.php|schema_export\.php" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS:pdf_page_number|ARGS:scale "!@rx ^[0-9]+$"

SecRule REQUEST_URI "@rx \/view\.php\?id=\d+" \
	"id:220110,rev:3,chain,msg:'COMODO WAF: SQL injection vulnerability in Machform 2 (CVE-2013-4948)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:form_id "@rx \D"

SecRule REQUEST_URI "@rx .*/view\.php\?id=\d+" \
	"id:220111,rev:3,chain,msg:'COMODO WAF: found CVE-2013-4948 attack|%{tx.domain}|%{tx.mode}',phase:4,deny,status:403,log"
SecRule RESPONSE_BODY "@rx ^INSERT INTO \`ap_form_\d+\` \(\`ip_address\`,\`date_created\`\) VALUES.*Query failed: Table \'\w+.ap_form_\d+\' doesn\'t exist$"

SecRule REQUEST_FILENAME "@rx .*/save\.php$" \
	"id:220120,rev:1,chain,msg:'COMODO WAF: found CVE-2013-4950 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:form "@rx ^\{\"id\":.*</?script" \
	"t:'none',t:'removeWhitespace',t:'lowercase'"

SecRule REQUEST_FILENAME "@rx .*/save\.php$" \
	"id:220121,rev:1,chain,msg:'COMODO WAF: found CVE-2013-4950 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:elements "@rx ^\{\"elements\":\[\{\"title\":\".*</?script" \
	"t:'none',t:'removeWhitespace',t:'lowercase'"

SecRule REQUEST_METHOD "@streq POST" \
	"id:220140,rev:1,chain,msg:'COMODO WAF: found CVE-2013-2209 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule REQUEST_URI "@contains /account/register/" \
	"chain,t:'none',t:'urlDecodeUni',t:'lowercase',t:'removeWhitespace'"
SecRule ARGS:first_name|ARGS:last_name "@rx <script" \
	"t:'none',t:'urlDecodeUni',t:'lowercase',t:'removeWhitespace'"

SecRule ARGS|!ARGS:/FCKeditor/|!ARGS:/^jform/|!ARGS:/^para/|!ARGS:/appendTo/|!ARGS:/database/|!ARGS:/description/|!ARGS:/insertAfter/|!ARGS:/insertBefore/|!ARGS:/installcode/|!ARGS:/message/|!ARGS:/msg/|!ARGS:/narrative/|!ARGS:/php/|!ARGS:/prependTo/|!ARGS:/prevObject/|!ARGS:/replaceAll/|!ARGS:/report/|!ARGS:/sql/|!ARGS:/teaser/|!ARGS:/text/|!ARGS:/txt/|!ARGS:Db_submit|!ARGS:Post|!ARGS:TicketID|!ARGS:action|!ARGS:alternate1|!ARGS:article_content|!ARGS:body|!ARGS:code|!ARGS:comment|!ARGS:contenido|!ARGS:content|!ARGS:data|!ARGS:faqs_answer|!ARGS:fck_body|!ARGS:file_content|!ARGS:form[pagina_text]|!ARGS:fulldescr|!ARGS:json|!ARGS:keywords|!ARGS:newcontent|!ARGS:p_action|!ARGS:prefix|!ARGS:query|!ARGS:resolution|!ARGS:saved_data|!ARGS:steps|!ARGS:suffix|!ARGS:wpSummary "@rx (?:union(?:\/\*.*\*\/)?select(?:\/\*.*\*\/)?)" \
	"id:220150,rev:1,msg:'COMODO WAF: found sql injection attack CVE-2013-5318 (Ginkgo CMS)|%{tx.domain}|%{tx.mode}',phase:2,capture,deny,status:403,log,logdata:'%{TX.0}',t:'none',t:'removeWhitespace',t:'lowercase'"

<LocationMatch /options-general\.php>
SecRuleRemoveById 220150
</LocationMatch>
<LocationMatch /sql\.php>
SecRuleRemoveById 220150
</LocationMatch>
<LocationMatch /lib/exe/ajax\.php>
SecRuleRemoveById 220150
</LocationMatch>
<LocationMatch /export\.php>
SecRuleRemoveById 220150
</LocationMatch>
SecRule REQUEST_FILENAME "@rx /user/browse/view_" \
	"id:220160,rev:1,chain,msg:'COMODO WAF: found CVE-2013-5121 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:search[sort_by] "@rx ^(?!^(asc|desc)$).+$" \
	"t:'none',t:'removeWhitespace',t:'lowercase'"

SecRule REQUEST_METHOD "@streq GET" \
	"id:220170,rev:1,chain,msg:'COMODO WAF: found CVE-2013-5317 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule REQUEST_FILENAME "cms/index\.php" \
	"chain,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS:mode "@rx <script" \
	"t:'none',t:'urlDecodeUni',t:'lowercase',t:'removeWhitespace'"

<LocationMatch "/cms/index\.php$">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220180,rev:1,chain,phase:2,pass,nolog"
SecRule QUERY_STRING "@rx ^mode\=users\&edit\=\d+$" \
	"expirevar:'SESSION.ritecms=3600',setvar:'SESSION.TIMEOUT=3600',setvar:'SESSION.ritecms=1',t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule SESSION:ritecms "@eq 1" \
	"id:220181,rev:1,phase:2,pass,nolog,skip:1"

SecRule REQUEST_METHOD "@streq POST" \
	"id:220182,rev:1,chain,msg:'COMODO WAF: found CVE 2013-5316 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:mode "@streq users" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:type "@streq 1" \
	"chain"
SecRule ARGS_POST:edit_user_submitted "@rx ^.*$"

</LocationMatch>
<LocationMatch "/mod\.php$">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220190,rev:1,phase:2,pass,expirevar:'SESSION.diy=3600',setvar:'SESSION.TIMEOUT=3600',setvar:'SESSION.diy=1',nolog"

SecRule SESSION:diy "@eq 1" \
	"id:220191,rev:1,phase:2,pass,nolog,skip:1"

SecRule REQUEST_METHOD "@rx ^(?:POST)$" \
	"id:220192,rev:1,chain,msg:'COMODO WAF: found CVE 2012-6518 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule QUERY_STRING "@rx mod=poll\&modfile=add" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule ARGS_POST:polltype "@streq 1" \
	"chain"
SecRule ARGS_POST:question "!@rx ^$"

</LocationMatch>
SecRule REQUEST_URI "@contains cacti" \
	"id:220220,rev:1,chain,msg:'COMODO WAF: found CVE-2013-5589 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_FILENAME "@rx host.php" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:id "!@rx ^[0-9]+$"

<LocationMatch "/index\.php$">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220230,rev:1,chain,msg:'COMODO WAF: found CVE 2013-5091 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:action "@streq index" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:module "@streq calendar" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:day "@rx ^\d{1,2}$" \
	"chain"
SecRule ARGS_GET:hour "@rx ^\d{1,2}$" \
	"chain"
SecRule ARGS_GET:month "@rx ^\d{1,2}$" \
	"chain"
SecRule ARGS_GET:year "@rx ^\d{4}$" \
	"chain"
SecRule ARGS_GET:onlyforuser "!@rx ^\d+$"

</LocationMatch>
<LocationMatch "/awards\.php$">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220270,rev:1,chain,msg:'COMODO WAF: found CVE 2013-3721 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:d "!@rx ^\d\d\d\d-\d\d?-\d\d?$"

</LocationMatch>
<LocationMatch "/index\.php/PopUpNews/popupnewsitem/">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220300,rev:1,chain,msg:'COMODO WAF: found CVE 2013-3524 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:itemid "!@rx ^\d+$" \
	"t:'none',t:'urlDecodeUni'"

</LocationMatch>
<LocationMatch "/view/objectDetail\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220310,rev:1,chain,msg:'COMODO WAF: found CVE 2013-6164 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:objectClass "@streq Affectation" \
	"chain"
SecRule ARGS_POST:objectId "!@rx ^\d+$"

</LocationMatch>
<LocationMatch "/radio/meneger\.php$">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220340,rev:1,chain,msg:'COMODO WAF: found CVE 2013-3531 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:playlist_id "!@rx ^\d*$"

</LocationMatch>
SecRule ARGS_GET:test_id "!@rx ^\d+$" \
	"id:220350,rev:1,msg:'COMODO WAF: found CVE-2013-6873 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,t:'urlDecodeUni'"

<LocationMatch "/claroline/(admin(registeruser|_user_course_settings)|module|profile_list)\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220360,rev:1,chain,msg:'COMODO WAF: found CVE-2013-6267 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:cidToEdit|ARGS_GET:module_id|ARGS_GET:offset "!@rx ^\d+$"

</LocationMatch>
SecRule REQUEST_FILENAME "/mobile/php/translation/index.php" \
	"id:220400,rev:1,chain,msg:'COMODO WAF: found CVE-2013-7002 attack|%{tx.domain}|%{tx.mode}',phase:1,block,deny,status:403,t:'none',t:'lowercase',t:'urlDecodeUni'"
SecRule ARGS_GET:g_language "!@rx ^[a-z]{2}$"

<LocationMatch "/admin/settings\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220410,rev:2,chain,msg:'COMODO WAF: Multiple XSS Vulnerabilities in GetSimple CMS 3.1, 3.1.2, 3.2.3, and earlier (CVE-2012-6621)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule &ARGS_POST:sitename "@gt 0" \
	"chain"
SecRule ARGS_POST:email|ARGS_POST:permalink "@rx \<" \
	"t:'none',t:'urlDecodeUni'"

</LocationMatch>
<LocationMatch "/index\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220420,rev:1,chain,msg:'COMODO WAF: found CVE 2014-1206 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:owa_action "@streq base.passwordResetRequest" \
	"chain"
SecRule ARGS_POST:owa_email_address "@rx \s" \
	"t:'none',t:'urlDecodeUni'"

</LocationMatch>
<LocationMatch "/index\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220430,rev:1,chain,msg:'COMODO WAF: found CVE 2014-1683 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:pid "@streq 4" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule ARGS_POST:email|ARGS_POST:message|ARGS_POST:name|ARGS_POST:subject "@rx \";" \
	"t:'none',t:'htmlEntityDecode'"

</LocationMatch>
<LocationMatch "thumb\.php">
SecRule REQUEST_METHOD "@rx GET$" \
	"id:220440,rev:1,chain,msg:'COMODO WAF: found CVE 2014-1610 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:f "@rx .+" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule ARGS_GET:w "!@rx ^\d+$" \
	"t:'none',t:'urlDecodeUni'"

</LocationMatch>
<LocationMatch "/recursos/agent\.php">
SecRule REQUEST_METHOD "@rx GET$" \
	"id:220450,rev:1,chain,msg:'COMODO WAF: found CVE 2014-1619 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:resource_id|ARGS_GET:version_id "!@rx ^-?\d+$" \
	"t:'none',t:'urlDecodeUni'"

</LocationMatch>
<LocationMatch "/user/profile/index\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220480,rev:1,chain,phase:2,pass,nolog"
SecRule QUERY_STRING "@rx ^$" \
	"expirevar:'SESSION.Moodle=3600',setvar:'SESSION.TIMEOUT=3600',setvar:'SESSION.Moodle=1',t:'none',t:'urlDecodeUni'"

SecRule SESSION:Moodle "@eq 1" \
	"id:220481,rev:1,phase:2,pass,nolog,skip:1"

SecRule REQUEST_METHOD "@streq GET" \
	"id:220482,rev:1,chain,msg:'COMODO WAF: found CVE 2014-0010 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:action "@streq deletefield" \
	"t:'none',t:'urlDecodeUni'"

</LocationMatch>
<LocationMatch "/profiles\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220510,rev:1,chain,msg:'COMODO WAF: found CVE 2013-1466 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:subject "@rx <"

</LocationMatch>
<LocationMatch "/calendar/index\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220511,rev:1,chain,msg:'COMODO WAF: found CVE 2013-1466 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:address1|ARGS_POST:address2|ARGS_POST:calendar_type|ARGS_POST:city|ARGS_POST:state|ARGS_POST:title|ARGS_POST:url|ARGS_POST:zipcode "@rx <"

</LocationMatch>
<LocationMatch "/links/index\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220512,rev:1,chain,msg:'COMODO WAF: found CVE 2013-1466 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:title|ARGS_POST:url "@rx <"

</LocationMatch>
<LocationMatch "/index\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220530,rev:1,chain,msg:'COMODO WAF: found CVE 2013-3639 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:func "!@rx ^$" \
	"chain"
SecRule ARGS_GET:id|ARGS_GET:interface|ARGS_GET:name|ARGS_GET:tabmodule "@rx <"

</LocationMatch>
<LocationMatch "/sw/chat/message\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220540,rev:1,chain,msg:'COMODO WAF: found CVE 2014-1914 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:nick "@rx <"

</LocationMatch>
<LocationMatch "/sw/add_topic\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220541,rev:1,chain,msg:'COMODO WAF: found CVE 2014-1914 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:topic "@rx <"

</LocationMatch>
<LocationMatch "/index\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220560,rev:1,chain,msg:'COMODO WAF: found CVE 2013-7326 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:return_url "@rx <|\""

</LocationMatch>
<LocationMatch "/agenda\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220570,rev:1,chain,msg:'COMODO WAF: found CVE 2013-5983 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:an "@rx <|\""

</LocationMatch>
<LocationMatch "/mobile/thread\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220571,rev:1,chain,msg:'COMODO WAF: found CVE 2013-5983 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:cat "@rx <|\""

</LocationMatch>
<LocationMatch "/name\.html">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220580,rev:1,chain,msg:'COMODO WAF: found CVE 2014-1403 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule QUERY_STRING "@rx .*\#\_.*javascript" \
	"t:'none',t:'urlDecodeUni'"

</LocationMatch>
<LocationMatch "/index\.php">
SecRule REQUEST_HEADERS:CLIENT_IP|REQUEST_HEADERS:FORWARDED_FOR|REQUEST_HEADERS:X_FORWARDED|REQUEST_HEADERS:X_FORWARDED_FOR "@rx \'|\"" \
	"id:220590,rev:1,msg:'COMODO WAF: found CVE 2014-1401 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"

SecRule REQUEST_HEADERS:FORWARDED "@rx \'" \
	"id:220591,rev:1,msg:'COMODO WAF: found CVE 2014-1401 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"

</LocationMatch>
<LocationMatch "/dg-admin/">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220600,rev:1,chain,msg:'COMODO WAF: found CVE 2014-1459 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:_position_down_id "@rx \D"

</LocationMatch>
<LocationMatch "/import\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220630,rev:1,chain,msg:'COMODO WAF: found CVE 2014-1879 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule FILES:import_file "@rx <"

</LocationMatch>
<LocationMatch "sw/admin_change_password\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220640,rev:1,phase:2,pass,expirevar:'SESSION.CSSMS=3600',setvar:'SESSION.TIMEOUT=3600',setvar:'SESSION.CSSMS=1',nolog"

SecRule SESSION:CSSMS "@eq 1" \
	"id:220641,rev:1,phase:2,pass,nolog,skip:1"

SecRule REQUEST_METHOD "@streq POST" \
	"id:220642,rev:1,chain,msg:'COMODO WAF: found CVE 2014-1915 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:action "@streq update"

</LocationMatch>
<LocationMatch "create_topic\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220643,rev:1,phase:2,pass,expirevar:'SESSION.CSSMS2=3600',setvar:'SESSION.TIMEOUT=3600',setvar:'SESSION.CSSMS2=1',nolog"

</LocationMatch>
<LocationMatch "sw/add_topic\.php">
SecRule SESSION:CSSMS2 "@eq 1" \
	"id:220644,rev:1,phase:2,pass,nolog,skip:1"

SecRule REQUEST_METHOD "@streq POST" \
	"id:220645,rev:1,chain,msg:'COMODO WAF: found CVE 2014-1915 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:Submit "@streq Submit"

</LocationMatch>
<LocationMatch "admin_search">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220690,rev:1,chain,msg:'COMODO WAF: found CVE 2013-7334 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:q "@rx \'|\"" \
	"t:'none',t:'urlDecodeUni'"

</LocationMatch>
SecRule REQUEST_FILENAME "@contains /ajax_udf.php" \
	"id:220700,rev:1,chain,msg:'COMODO WAF: Found CVE-2014-1945|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni'"
SecRule ARGS_GET:add_value|ARGS_GET:table "!@rx ^[\w]*$"

<LocationMatch "ilias\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220710,rev:3,chain,msg:'COMODO WAF: found CVE-2014-2089 / CVE-2014-2090 / CVE-2014-2088 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:baseClass "@streq ilPersonalDesktopGUI" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule ARGS_POST:tar|ARGS_POST:title "@rx \'|\"|\<"

SecRule REQUEST_METHOD "@streq POST" \
	"id:220711,rev:3,chain,msg:'COMODO WAF: found CVE-2014-2089 / CVE-2014-2090 / CVE-2014-2088 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:baseClass "@streq ilRepositoryGUI" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule ARGS_POST:tar "@rx \'|\"|\<"

</LocationMatch>
SecRule REQUEST_FILENAME "/ilfile/.*\.php$" \
	"id:220712,rev:3,msg:'COMODO WAF: found CVE-2014-2089 / CVE-2014-2090 / CVE-2014-2088 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"

SecRule REQUEST_FILENAME "/whizzywig/wb\.php/" \
	"id:220740,rev:1,chain,msg:'COMODO WAF: found CVE-2014-2219 attack|%{tx.domain}|%{tx.mode}',deny,status:403,t:'none',t:'htmlEntityDecode',t:'lowercase',multiMatch"
SecRule ARGS_GET:d "'"

SecRule REQUEST_FILENAME "mods/_standard/forums/admin/forum_add\.php" \
	"id:220750,rev:1,chain,msg:'COMODO WAF: found CVE-2014-2091 Cross-site scripting (XSS) attack|%{tx.domain}|%{tx.mode}',deny,status:403,log,t:'none',t:'urlDecodeUni',multiMatch"
SecRule ARGS_POST:title "\""

SecRule REQUEST_FILENAME "mods/_standard/forums/admin/forum_add\.php" \
	"id:220751,rev:1,chain,msg:'COMODO WAF: found CVE-2014-2091 Cross-site scripting (XSS) attack|%{tx.domain}|%{tx.mode}',deny,status:403,log,t:'none',t:'urlDecodeUni',multiMatch"
SecRule ARGS_POST:description "<"

SecRule ARGS_POST:text "<" \
	"id:220760,rev:1,chain,msg:'COMODO WAF: Blocking XSS attack|%{tx.domain}|%{tx.mode}',deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_FILENAME "@contains /index.php/guestbook/index/newentry"

SecRule ARGS_GET:eventid "@rx \D" \
	"id:220770,rev:1,chain,msg:'COMODO WAF: CVE-2013-3961 SQL injection protection|%{tx.domain}|%{tx.mode}',deny,status:403"
SecRule REQUEST_URI "edit_event\.php"

<LocationMatch "/admin/addgroup\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220780,rev:1,chain,msg:'COMODO WAF: found CVE 2014-0334 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:group "@rx <"

</LocationMatch>
<LocationMatch "/admin/addhtmlblob\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220781,rev:1,chain,msg:'COMODO WAF: found CVE 2014-0334 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:htmlblob "@rx <"

</LocationMatch>
<LocationMatch "/admin/addbookmark\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220782,rev:1,chain,msg:'COMODO WAF: found CVE 2014-0334 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:title|ARGS_POST:url "@rx <"

</LocationMatch>
<LocationMatch "/admin/copystylesheet\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220783,rev:1,chain,msg:'COMODO WAF: found CVE 2014-0334 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:stylesheet_name "@rx <"

</LocationMatch>
<LocationMatch "/admin/copytemplate\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220784,rev:1,chain,msg:'COMODO WAF: found CVE 2014-0334 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:template_name "@rx <"

</LocationMatch>
<LocationMatch "/admin/editbookmark\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220785,rev:1,chain,msg:'COMODO WAF: found CVE 2014-0334 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:title|ARGS_POST:url "@rx <"

</LocationMatch>
<LocationMatch "/admin/listtemplates\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220786,rev:1,chain,msg:'COMODO WAF: found CVE 2014-0334 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:template "@rx <"

</LocationMatch>
<LocationMatch "/admin/listcss\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220787,rev:1,chain,msg:'COMODO WAF: found CVE 2014-0334 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:css_name "@rx <"

</LocationMatch>
<LocationMatch "install">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220790,rev:1,chain,msg:'COMODO WAF: found CVE 2014-2092 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:default_cms_lang|ARGS_POST:docroot "@rx <"

</LocationMatch>
<LocationMatch "lib/filemanager/ImageManager/editorFrame\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220791,rev:1,chain,msg:'COMODO WAF: found CVE 2014-2092 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:action "@rx <"

</LocationMatch>
<LocationMatch "admin/addhtmlblob\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220792,rev:1,chain,msg:'COMODO WAF: found CVE 2014-2092 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:htmlblob "@rx <"

</LocationMatch>
<LocationMatch "admin/addtemplate\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220793,rev:1,chain,msg:'COMODO WAF: found CVE 2014-2092 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:template "@rx <"

</LocationMatch>
<LocationMatch "admin/addcss\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220794,rev:1,chain,msg:'COMODO WAF: found CVE 2014-2092 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:css_name "@rx <"

</LocationMatch>
<LocationMatch "admin/siteprefs\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220795,rev:1,chain,msg:'COMODO WAF: found CVE 2014-2092 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:metadata|ARGS_POST:sitedownmessage "@rx <"

</LocationMatch>
<LocationMatch "admin/pagedefaults\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220796,rev:1,chain,msg:'COMODO WAF: found CVE 2014-2092 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:page_metadata "@rx <"

</LocationMatch>
<LocationMatch "admin/addbookmark\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220797,rev:1,chain,msg:'COMODO WAF: found CVE 2014-2092 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:title "@rx <"

</LocationMatch>
<LocationMatch "admin/myaccount\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220798,rev:1,chain,msg:'COMODO WAF: found CVE 2014-2092 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:date_format_string "@rx <"

</LocationMatch>
<LocationMatch "admin/adminlog\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220799,rev:1,chain,msg:'COMODO WAF: found CVE 2014-2092 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:filteruser "@rx <"

</LocationMatch>
<LocationMatch "admin/editevent\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220800,rev:1,chain,msg:'COMODO WAF: found CVE 2014-2092 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:handler "@rx <"

</LocationMatch>
<LocationMatch "manageajax\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220810,rev:1,chain,msg:'COMODO WAF: found CVE: 2014-3246 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:action "@streq fileview_list" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule ARGS_GET:folder "!@rx ^\d+$" \
	"t:'none',t:'urlDecodeUni'"

</LocationMatch>
<LocationMatch "admin\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:220820,rev:1,chain,msg:'COMODO WAF: found CVE 2014-3247 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:action "@streq addpro" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule ARGS_POST:desc "@rx \'|\"|\<"

</LocationMatch>
SecRule REQUEST_FILENAME "@contains ajax_udf.php" \
	"id:220860,rev:1,chain,msg:'COMODO WAF: Found CVE-2014-2317|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni'"
SecRule ARGS:table "!@rx ^[\w]*$"

<LocationMatch "/admin/users/add/user/">
SecRule REQUEST_METHOD "@streq GET" \
	"id:220880,rev:1,phase:2,pass,expirevar:'SESSION.UMICMS=3600',setvar:'SESSION.TIMEOUT=3600',setvar:'SESSION.UMICMS=1',nolog"

</LocationMatch>
<LocationMatch "/admin/users/add/user/do/">
SecRule SESSION:UMICMS "@eq 1" \
	"id:220881,rev:1,phase:2,pass,nolog,skip:1"

SecRule REQUEST_METHOD "@streq POST" \
	"id:220882,rev:1,chain,msg:'COMODO WAF: found CVE 2013-2754 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_POST:data[new][login] "!@rx ^$" \
	"chain"
SecRule ARGS_POST:data[new][password][] "!@rx ^$"

</LocationMatch>
SecRule ARGS_GET:query "\"" \
	"id:220900,rev:1,chain,msg:'COMODO WAF: found CVE-2014-2280 attack|%{tx.domain}|%{tx.mode}',deny,status:403,log,t:'none',t:'lowercase',t:'urlDecodeUni'"
SecRule REQUEST_FILENAME "/op\.search\.php" \
	"t:'none',t:'lowercase',t:'urlDecodeUni'"

SecRule ARGS_POST:keywords "\"" \
	"id:220910,rev:1,chain,msg:'COMODO WAF: found CVE-2014-1840 attack|%{tx.domain}|%{tx.mode}',deny,status:403,log,t:'none',t:'lowercase',t:'urlDecodeUni'"
SecRule REQUEST_FILENAME "/upload/search\.php" \
	"chain,t:'none',t:'lowercase',t:'urlDecodeUni'"
SecRule ARGS:action "do_search"

SecRule REQUEST_FILENAME "/portal/addtoapplication\.php" \
	"id:220920,rev:1,chain,msg:'COMODO WAF: Blocking Sql Injection (CVE-2014-2211)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'htmlEntityDecode',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_GET:rssurl "!@rx ^(?:(?:http|ftp)[s]?:\/\/)?[a-zA-Z0-9\-\.]+\.([a-zA-Z]{2,3}|[0-9]{1,3})(:[0-9]+)?[a-zA-Z0-9\-\._\?\'/\\\+&%#\=~]*$" \
	"t:'none',t:'htmlEntityDecode',t:'urlDecodeUni',t:'lowercase'"

SecRule Request_URI "@rx \/shared-apartments-rooms\/.*<" \
	"id:220930,rev:1,msg:'COMODO WAF: Blocking XSS attack (CVE-2014-2024)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'htmlEntityDecode',t:'lowercase',t:'urlDecodeUni'"

SecRule ARGS_POST:/^extra_/ "\"" \
	"id:220940,rev:1,chain,msg:'COMODO WAF: Blocking XSS attack (CVE-2014-1877)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule Request_FILENAME "(profile|user_edit|user_add)\.php"

SecRule ARGS_POST:title "\">" \
	"id:220941,rev:1,chain,msg:'COMODO WAF: Blocking XSS attack (CVE-2014-1877)|%{tx.domain}|%{tx.mode}',phase:'2 deny',status:403,log"
SecRule Request_FILENAME "groups\.php"

SecRule Request_FILENAME "new_message\.php" \
	"id:220942,rev:1,chain,msg:'COMODO WAF: Blocking XSS attack (CVE-2014-1877)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'htmlEntityDecode',t:'lowercase',t:'urlDecodeUni'"
SecRule ARGS:content "\">"

SecRule ARGS:m1_sortby "!@rx ^\w+\W(ASC|DESC)$" \
	"id:220960,rev:1,chain,msg:'COMODO WAF: Blocking SQL Injection attack (CVE-2014-2245)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'htmlEntityDecode',t:'urlDecodeUni'"
SecRule Request_FILENAME "moduleinterface\.php"

SecRule REQUEST_URI "polls/vote\.php" \
	"id:220980,rev:1,chain,msg:'COMODO WAF: found CVE-2013-5640 SQL injection protection|%{tx.domain}|%{tx.mode}',deny,status:403,log,t:'none',t:'urlDecodeUni',t:'htmlEntityDecode',multiMatch"
SecRule ARGS_POST:answer_id|ARGS_POST:question_id "@rx \D"

SecRule REQUEST_URI "comments/(add|edit)\.php|posts/add\.php" \
	"id:220981,rev:1,chain,msg:'COMODO WAF: found CVE-2013-5640 SQL injection protection|%{tx.domain}|%{tx.mode}',deny,status:403,log,t:'none',t:'urlDecodeUni',t:'htmlEntityDecode',multiMatch"
SecRule ARGS_POST:story_id|ARGS_POST:thread_id "@rx \D"

SecRule REQUEST_URI "users/login\.php" \
	"id:220990,rev:1,chain,msg:'COMODO WAF: found CVE-2013-5639 attack|%{tx.domain}|%{tx.mode}',deny,status:403,t:'none',t:'urlDecodeUni',t:'cmdline',multiMatch"
SecRule REQUEST_COOKIES:gnew_language "\.\./"

SecRule REQUEST_FILENAME "@contains symphony/system/authors" \
	"id:221020,rev:2,chain,msg:'COMODO WAF: SQL injection vulnerability in Symphony CMS before 2.3.2 (CVE-2013-2559)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:sort "@rx \W" \
	"t:'none'"

<LocationMatch "/xmlrpc\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:221030,rev:2,chain,msg:'COMODO WAF: DoS attack vulnerability (XML Quadratic Blowup Attack) in WordPress before 3.9.2 and Drupal 6.x before 6.33 and 7.x before 7.31 (CVE-2014-5266)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule REQUEST_BODY "@contains ENTITY" \
	"chain"
SecRule REQUEST_BODY "@rx (\;.*?\&.+?){100,}?"

SecRule HTTP_User-Agent "WinHttp\.WinHttpRequest\.5" \
	"id:221031,rev:2,chain,msg:'COMODO WAF: DoS attack vulnerability (XML Quadratic Blowup Attack) in WordPress before 3.9.2 and Drupal 6.x before 6.33 and 7.x before 7.31 (CVE-2014-5266)|%{tx.domain}|%{tx.mode}',deny,status:403,t:'none',t:'removeWhitespace',t:'lowercase'"
SecRule &HTTP_REFERER "@eq 0" \
	"chain"
SecRule &HTTP_User-Agent "@eq 0"

</LocationMatch>
<LocationMatch "/symphony/system/authors">
SecRule REQUEST_METHOD "@streq GET" \
	"id:221040,rev:1,chain,phase:2,pass,nolog"
SecRule QUERY_STRING "@rx ^$" \
	"expirevar:'SESSION.symphony=1200',setvar:'SESSION.TIMEOUT=1200',setvar:'SESSION.symphony=1',t:'none',t:'urlDecodeUni'"

SecRule SESSION:symphony "@eq 1" \
	"id:221041,rev:1,phase:2,pass,nolog,skip:1"

SecRule REQUEST_METHOD "@streq GET" \
	"id:221042,rev:1,chain,msg:'COMODO WAF: found CVE-2013-7346 CSRF attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:order|ARGS_GET:sort "@rx ." \
	"t:'none',t:'urlDecodeUni'"

</LocationMatch>
SecRule ARGS_POST:title "\"" \
	"id:221050,rev:1,chain,msg:'COMODO WAF: Blocking CVE-2013-4430|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'htmlEntityDecode',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_FILENAME "/artefact/internal/editnote\.php"

SecRule ARGS:categories_order "@rx \"(?:item_id|left|right)\"\s*:\s*(?!(?:null|\"\d+\"|\d+)\s*(?:,|}))" \
	"id:221070,rev:1,chain,msg:'COMODO WAF: found CVE-2014-3783|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'htmlEntityDecode',t:'lowercase',t:'urlDecodeUni',multiMatch"
SecRule REQUEST_FILENAME "categories\.php"

SecRule REQUEST_URI "(?:channels|collections|groups|search_result|videos|view_collection|view_item)\.php" \
	"id:221080,rev:1,chain,msg:'COMODO WAF: found CVE-2012-6644 Cross-site scripting (XSS) Attack|%{tx.domain}|%{tx.mode}',deny,status:403,log,t:'none',t:'urlDecodeUni',t:'htmlEntityDecode',t:'lowercase',multiMatch"
SecRule ARGS_GET:cat|ARGS_GET:query|ARGS_GET:type "\""

SecRule REQUEST_URI "view_channel\.php" \
	"id:221090,rev:1,chain,msg:'COMODO WAF: Found CVE-2012-6642 Cross-site scripting (XSS) Attack|%{tx.domain}|%{tx.mode}',deny,status:403,log,t:'none',t:'urlDecodeUni',t:'htmlEntityDecode',multiMatch"
SecRule ARGS_GET:type "[^a-zA-Z]{1,}"

SecRule REQUEST_URI "channels\.php|videos\.php" \
	"id:221100,rev:1,chain,msg:'COMODO WAF: Found CVE-2012-6643 SQL injection Attack|%{tx.domain}|%{tx.mode}',deny,status:403,log,t:'none',t:'urlDecodeUni',t:'htmlEntityDecode',multiMatch"
SecRule ARGS_GET:time "[^a-zA-Z_]{1,}"

SecRule ARGS_GET:graph_end|ARGS_GET:graph_height|ARGS_GET:graph_start|ARGS_GET:graph_width|ARGS_GET:local_graph_id|ARGS_GET:rra_id "[^0-9]" \
	"id:221110,rev:1,chain,msg:'COMODO WAF: Protecting vulnerable application (CVE-2014-2708)|%{tx.domain}|%{tx.mode}',phase:1,deny,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_FILENAME "@streq graph_xport.php" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

<LocationMatch "index2\.php">
SecRule REQUEST_METHOD "@streq GET" \
	"id:221120,rev:1,phase:2,pass,expirevar:'SESSION.XCloner=3600',setvar:'SESSION.TIMEOUT=3600',setvar:'SESSION.XCloner=1',nolog"

SecRule SESSION:XCloner "@eq 1" \
	"id:221121,rev:1,phase:2,pass,nolog,skip:1"

SecRule REQUEST_METHOD "@streq POST" \
	"id:221122,rev:1,chain,msg:'COMODO WAF: found CVE 2014-2579 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule &ARGS_POST:jcuser "@eq 1" \
	"chain"
SecRule &ARGS_POST:jcpass "@eq 1" \
	"chain"
SecRule ARGS_POST:task "@streq config" \
	"chain"
SecRule ARGS_POST:action "@streq save"

</LocationMatch>
SecRule REQUEST_COOKIES:/fusion\w+user/ "@rx [^a-z0-9\.]" \
	"id:221190,rev:1,msg:'COMODO WAF: SQL injection found CVE-2013-7375|%{tx.domain}|%{tx.mode}',phase:1,deny,log,t:'none',t:'htmlEntityDecode',t:'urlDecodeUni',t:'lowercase'"

SecRule REQUEST_COOKIES:dc_passwd "!@rx ^a:\d+:{(?:i:\d+;s:\d+:\".*?\";)*}$" \
	"id:221200,rev:1,msg:'COMODO WAF: Code injection found CVE-2014-1613|%{tx.domain}|%{tx.mode}',phase:1,deny,log,t:'none',t:'htmlEntityDecode',t:'urlDecodeUni',t:'lowercase'"

SecRule ARGS_GET:orderby "!@rx ^download\_(?:id|user|title|count|datestamp)$" \
	"id:221290,rev:1,chain,msg:'COMODO WAF: SQL INJECTION ATTACK FOUND - CVE 2013-1803|%{tx.domain}|%{tx.mode}',phase:1,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_FILENAME "@contains downloads.php" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'normalisePath',t:'lowercase'"

SecRule ARGS_NAMES "delete_attach_([^0-9]){1,}" \
	"id:221291,rev:1,chain,msg:'COMODO WAF: SQL INJECTION ATTACK FOUND - CVE 2013-1803|%{tx.domain}|%{tx.mode}',phase:1,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_FILENAME "@contains postedit.php" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'normalisePath',t:'lowercase'"

SecRule ARGS_POST:pm_email_notify|ARGS_POST:pm_save_sent "!@rx ^(0|1)$" \
	"id:221292,rev:1,chain,msg:'COMODO WAF: SQL Injection detected - CVE 2013-1803|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule REQUEST_FILENAME "@contains administration/settings_messages.php" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'normalisePath',t:'lowercase'"

SecRule ARGS_POST:pm_inbox|ARGS_POST:pm_savebox|ARGS_POST:pm_sentbox "[^0-9]" \
	"id:221293,rev:1,chain,msg:'COMODO WAF: SQL INJECTION ATTACK FOUND - CVE 2013-1803|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule REQUEST_FILENAME "@contains administration/settings_messages.php" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'normalisePath',t:'lowercase'"

SecRule ARGS_POST:thumb_compression "!@rx ^gd\d$" \
	"id:221294,rev:1,chain,msg:'COMODO WAF: SQL INJECTION ATTACK FOUND - CVE 2013-1803|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_FILENAME "@contains administration/settings_photo.php" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'normalisePath',t:'lowercase'"

SecRule ARGS_POST:/photo_watermark_text_color\d/ "!@rx ^(?:([0-9a-fA-F]){6})$" \
	"id:221295,rev:1,chain,msg:'COMODO WAF: SQL INJECTION ATTACK FOUND - CVE 2013-1803|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule REQUEST_FILENAME "@contains administration/settings_photo.php" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'normalisePath',t:'lowercase'"

SecRule ARGS_GET:enable "[^a-z!]" \
	"id:221296,rev:1,chain,msg:'COMODO WAF: SQL INJECTION ATTACK FOUND - CVE 2013-1803|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_FILENAME "@contains administration/bbcodes.php" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'normalisePath',t:'lowercase'"

SecRule ARGS:news_image_1|ARGS:news_image_2|ARGS_POST:news_image "@rx \'" \
	"id:221297,rev:1,chain,msg:'COMODO WAF: SQL INJECTION ATTACK FOUND - CVE 2013-1803|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule REQUEST_FILENAME "@contains administration/news.php" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'normalisePath',t:'lowercase'"

SecRule ARGS_POST:article_id|ARGS_POST:news_id "[^0-9]" \
	"id:221298,rev:1,chain,msg:'COMODO WAF: SQL INJECTION ATTACK FOUND - CVE 2013-1803|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule REQUEST_FILENAME "administration/(articles|news)\.php" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'normalisePath',t:'lowercase'"

SecRule ARGS_POST:article_id "[^0-9]" \
	"id:221300,rev:1,chain,msg:'COMODO WAF: WEB APPLICATION ATTACK FOUND (CVE-2014-4194)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_FILENAME "@contains zero_transact_article.php" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule REQUEST_FILENAME "@endsWith views/zero_view_article.php" \
	"id:221310,rev:3,chain,msg:'COMODO WAF: XSS & SQL injection vulnerability in ZeroCMS 1.0 (CVE-2014-4195 / CVE-2014-4034)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_GET:article_id "@rx \D" \
	"t:'none'"

SecRule REQUEST_HEADERS:Referer "@contains >" \
	"id:221330,rev:1,chain,msg:'COMODO WAF: Possible XSS Detected - CVE-2014-5108|%{tx.domain}|%{tx.mode}',phase:1,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'removeWhitespace'"
SecRule REQUEST_URI "@contains index.php/download_file" \
	"t:'none',t:'urlDecodeUni',t:'normalisePath',t:'removeWhitespace',t:'lowercase'"

SecRule REQUEST_FILENAME "@endsWith add.php" \
	"id:221340,rev:1,chain,msg:'COMODO WAF: CVE-2014-4853 found|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'htmlEntityDecode',multiMatch"
SecRule FILES "@contains >"

SecRule REQUEST_FILENAME "@endsWith user/fiche.php" \
	"id:221350,rev:1,chain,msg:'COMODO WAF: found CVE-2014-3992 (SQL injection)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'htmlEntityDecode',multiMatch"
SecRule ARGS_POST:entity "@rx \D"

SecRule REQUEST_FILENAME "@endsWith user/group/index.php" \
	"id:221351,rev:1,chain,msg:'COMODO WAF: found CVE-2014-3992 (SQL injection)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'htmlEntityDecode',multiMatch"
SecRule ARGS_GET:sortorder "@rx !(asc|desc)" \
	"t:'lowercase'"

SecRule ARGS_GET:leftmenu|ARGS_GET:mainmenu|ARGS_POST:dol_hide_leftmenu|ARGS_POST:dol_hide_topmenu|ARGS_POST:dol_no_mouse_hover|ARGS_POST:dol_optimize_smallscreen|ARGS_POST:dol_use_jmobile "@contains >" \
	"id:221360,rev:1,msg:'COMODO WAF: CVE-2014-3991 found (XSS protection)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'htmlEntityDecode',multiMatch"

SecRule REQUEST_FILENAME "@endsWith user/index.php" \
	"id:221361,rev:1,chain,msg:'COMODO WAF: CVE-2014-3991 found (XSS protection)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'htmlEntityDecode',multiMatch"
SecRule ARGS_GET:dol_hide_leftmenu|ARGS_GET:dol_hide_topmenu|ARGS_GET:dol_no_mouse_hover|ARGS_GET:dol_optimize_smallscreen|ARGS_GET:dol_use_jmobile "@contains >"

SecRule REQUEST_FILENAME "@endsWith user/logout.php" \
	"id:221362,rev:1,chain,msg:'COMODO WAF: CVE-2014-3991 found (XSS protection)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'htmlEntityDecode',multiMatch"
SecRule ARGS_GET:dol_hide_leftmenu|ARGS_GET:dol_hide_topmenu|ARGS_GET:dol_no_mouse_hover|ARGS_GET:dol_optimize_smallscreen|ARGS_GET:dol_use_jmobile "@contains >"

SecRule REQUEST_FILENAME "@endsWith user/fiche.php" \
	"id:221363,rev:1,chain,msg:'COMODO WAF: CVE-2014-3991 found (XSS protection)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'htmlEntityDecode',multiMatch"
SecRule ARGS_POST:email|ARGS_POST:firstname|ARGS_POST:job|ARGS_POST:lastname|ARGS_POST:login "@contains >"

SecRule REQUEST_FILENAME "@endsWith viewimage.php" \
	"id:221364,rev:1,chain,msg:'COMODO WAF: CVE-2014-3991 found (XSS protection)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'htmlEntityDecode',multiMatch"
SecRule ARGS_GET:file|ARGS_GET:modulepart "@contains >"

SecRule ARGS:xmlin "@contains .." \
	"id:221470,rev:1,chain,msg:'COMODO WAF: blocking CVE-2014-3777|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'htmlEntityDecode',t:'urlDecodeUni',t:'normalisePath'"
SecRule REQUEST_FILENAME "@contains run.php" \
	"t:'none',t:'htmlEntityDecode',t:'urlDecodeUni',t:'lowercase'"

<LocationMatch "/kan">
SecRule REQUEST_METHOD "@streq GET" \
	"id:221480,rev:1,chain,phase:2,pass,expirevar:'SESSION.kan=3600',setvar:'SESSION.TIMEOUT=3600',setvar:'SESSION.kan=1',nolog"
SecRule ARGS_GET:controller "@streq user" \
	"chain"
SecRule ARGS_GET:action "@streq create"

SecRule SESSION:kan "@eq 1" \
	"id:221481,rev:1,phase:2,pass,nolog,skip:1"

SecRule REQUEST_METHOD "@streq POST" \
	"id:221482,rev:1,chain,msg:'COMODO WAF: found CVE 2014-3920 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:controller "@streq user" \
	"chain"
SecRule ARGS_GET:action "@streq save" \
	"chain"
SecRule &ARGS_POST:username "@eq 1" \
	"chain"
SecRule &ARGS_POST:name "@eq 1" \
	"chain"
SecRule &ARGS_POST:password "@eq 1"

SecRule ARGS_GET:table "@rx '|<" \
	"id:221490,rev:1,chain,msg:'COMODO WAF: found CVE-2014-4955 attack|%{tx.domain}|%{tx.mode}',deny,status:403,log,t:'none',t:'htmlEntityDecode',t:'urlDecodeUni'"
SecRule REQUEST_FILENAME "@contains db_triggers.php" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

</LocationMatch>
SecRule REQUEST_COOKIES_NAMES "@streq foecms_lang" \
	"id:221550,rev:1,chain,msg:'COMODO WAF: Possible SQL Injection - CVE-2014-4850|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'removeWhitespace',skip:1"
SecRule ARGS_GET:i|REQUEST_COOKIES:foecms_lang "!@rx \d" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace'"

SecRule RESPONSE_HEADERS:Set-Cookie "@rx ^foecms_lang=(.*);\ expires.*$" \
	"id:221551,rev:1,chain,msg:'COMODO WAF: Possible SQL Injection - CVE-2014-4850|%{tx.domain}|%{tx.mode}',phase:3,capture,deny,status:403,log,t:'none'"
SecRule TX:1 "!@rx ^\d$"

SecRule REQUEST_FILENAME "@endsWith user/edit.php" \
	"id:221560,rev:1,chain,msg:'COMODO WAF: Possible XSS Attack - CVE-2014-3544|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule REQUEST_COOKIES_NAMES "@streq MoodleSession" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule ARGS_POST:skype "!@rx ^(?:live:|[a-z0-9,\._\-]){6,32}$" \
	"t:'none',t:'urlDecodeUni',t:'compressWhitespace',t:'lowercase',multiMatch"

SecRule REQUEST_FILENAME "@endsWith login/index.php" \
	"id:221570,rev:1,chain,msg:'COMODO WAF: Possible XSS Attack - CVE-2014-3549|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'removeWhitespace',t:'lowercase'"
SecRule &SESSION:moodlesession "@gt 0" \
	"chain"
SecRule ARGS_POST:username "@rx [^\w\-\.\@]" \
	"t:'none',t:'urlDecodeUni',t:'compressWhitespace',t:'lowercase',multiMatch"

SecRule REQUEST_FILENAME "@contains firewall_schedule_edit.php" \
	"id:221610,rev:1,chain,msg:'COMODO WAF: Found CVE-2014-4687 Cross-site scripting (XSS) Attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:starttime0|ARGS:stoptime0 "@contains \"" \
	"t:'none',t:'urlDecodeUni',multiMatch"

SecRule REQUEST_FILENAME "@contains widgets/widgets/rss.widget.php" \
	"id:221611,rev:1,chain,msg:'COMODO WAF: Found CVE-2014-4687 Cross-site scripting (XSS) Attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:rssfeed|ARGS:rssmaxitems|ARGS:rsswidgetheight|ARGS:rsswidgettextlength "\"@contains <\" \"multiMatch,t:none," \
	"t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@contains widgets/widgets/services_status.widget.php" \
	"id:221612,rev:1,chain,msg:'COMODO WAF: Found CVE-2014-4687 Cross-site scripting (XSS) Attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:servicestatusfilter "@contains \"" \
	"t:'none',t:'urlDecodeUni',multiMatch"

SecRule REQUEST_FILENAME "@contains widgets/widgets/log.widget.php" \
	"id:221613,rev:1,chain,msg:'COMODO WAF: Found CVE-2014-4687 Cross-site scripting (XSS) Attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:actblock|ARGS:actpass|ARGS:actreject "!@rx ^(pass|block|reject)$" \
	"t:'none',t:'lowercase'"

SecRule REQUEST_FILENAME "@contains widgets/widgets/log.widget.php" \
	"id:221614,rev:1,chain,msg:'COMODO WAF: Found CVE-2014-4687 Cross-site scripting (XSS) Attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:filterlogentries|ARGS:filterlogentriesinterfaces "@rx [\"|<|>|']" \
	"t:'none',t:'urlDecodeUni',multiMatch"

SecRule REQUEST_FILENAME "@endsWith status_rrd_graph_img.php" \
	"id:221620,rev:1,chain,msg:'COMODO WAF: Found CVE-2014-4688 Cross-site scripting (XSS) Attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:database|ARGS:graph "@rx [\\\\|\||\"|\0|'|\/]" \
	"t:'none',t:'urlDecodeUni',multiMatch"

SecRule REQUEST_FILENAME "@endsWith pkg_mgr_install.php" \
	"id:221630,rev:1,chain,msg:'COMODO WAF: Found CVE-2014-4689 Cross-site scripting (XSS) Attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:id|ARGS:mode|ARGS:pkg "@rx [\\\\|\||\.|\"|\0|'|\/]" \
	"t:'none',t:'urlDecodeUni',multiMatch"

SecRule REQUEST_FILENAME "@endsWith pkg_edit.php" \
	"id:221631,rev:1,chain,msg:'COMODO WAF: Found CVE-2014-4689 Cross-site scripting (XSS) Attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:xml "@rx [\\\\|\//\.|\0]" \
	"t:'none',t:'urlDecodeUni',multiMatch"

SecRule REQUEST_FILENAME "@endsWith system_firmware_restorefullbackup.php" \
	"id:221632,rev:1,chain,msg:'COMODO WAF: Found CVE-2014-4689 Cross-site scripting (XSS) Attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:downloadbackup "@rx [\\\\|\//\.|\0]" \
	"t:'none',t:'urlDecodeUni',multiMatch"

SecRule ARGS_GET:phpfile "@rx ^[\.\\\\\/]+" \
	"id:221640,rev:1,msg:'COMODO WAF: found CVE-2014-5115 attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'normalisePath'"

SecRule REQUEST_FILENAME "@endsWith admin/uploads.php" \
	"id:221650,rev:1,chain,msg:'COMODO WAF: Found CVE-2014-4852 SQLi Attack|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase',t:'normalisePath'"
SecRule ARGS_GET:id "@rx \D+" \
	"t:'none'"

SecRule REQUEST_URI "@contains admin/admin.php" \
	"id:221820,rev:1,chain,msg:'COMODO WAF: Blocking CVE-2014-5194|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'htmlEntityDecode',t:'normalisePath',multiMatch"
SecRule ARGS_GET:_word_upper_bound "@rx \D" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_URI "@contains admin/admin.php" \
	"id:222000,rev:1,chain,msg:'COMODO WAF: Blocking CVE-2014-5193|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'htmlEntityDecode',t:'lowercase',t:'normalisePath',t:'removeWhitespace',multiMatch"
SecRule ARGS_POST:f "@rx \d" \
	"chain,t:'none',t:'urlDecodeUni',t:'htmlEntityDecode',t:'removeWhitespace'"
SecRule ARGS_POST:category "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule &ARGS_GET:do "!eq 0" \
	"id:222060,rev:1,chain,msg:'COMODO WAF: SQL injection in Kasseler CMS (CVE-2013-3727)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS:module "@pm sendmail news voting forum account categories" \
	"chain,t:'none',t:'lowercase',multiMatch"
SecRule ARGS:desc|ARGS:dok|ARGS:fid|ARGS:groups[]|ARGS:id|ARGS:module|ARGS:nid|ARGS:tid|ARGS:tid|ARGS:vid "@rx [\'\,]" \
	"chain,t:'none',t:'urlDecodeUni',multiMatch"
SecRule REQUEST_FILENAME "@pm admin.php index.php" \
	"t:'none',t:'urlDecodeUni',t:'lowercase',multiMatch"

SecRule &ARGS_GET:do "!eq 0" \
	"id:222070,rev:1,chain,msg:'COMODO WAF: XSS in Kasseler CMS (CVE-2013-3728)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:module "@pm sendmail news voting forum account categories database" \
	"chain,t:'none',t:'lowercase',multiMatch"
SecRule ARGS:cat|ARGS:desc|ARGS:dok|ARGS:fid|ARGS:groups[]|ARGS:id|ARGS:module|ARGS:nid|ARGS:tid|ARGS:tid|ARGS:vid "@contains >" \
	"chain,t:'none',t:'urlDecodeUni',multiMatch"
SecRule REQUEST_FILENAME "@pm admin.php index.php" \
	"t:'none',t:'urlDecodeUni',t:'lowercase',multiMatch"

SecRule REQUEST_COOKIES:/^http(?:.*)token$/ "@rx ([\w]{40})" \
	"id:222120,rev:1,chain,msg:'COMODO WAF: Possible XSS Attack in Feng Office (CVE-2014-5343)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS_GET:c "@streq customer" \
	"chain,t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'lowercase',multiMatch"
SecRule ARGS_GET:a "@streq add" \
	"chain,t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'lowercase',multiMatch"
SecRule ARGS_POST:customer[name] "@rx [\<\"]" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace',multiMatch"

SecRule REQUEST_FILENAME "@endsWith admin.php" \
	"id:222130,rev:1,chain,msg:'COMODO WAF: Sphider Injectable form detected (CVE-2014-5192)|%{tx.domain}|%{tx.mode}',phase:2,pass,nolog,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'removeWhitespace',t:'lowercase',multiMatch"
SecRule &ARGS:site_id "@gt 0" \
	"chain"
SecRule &ARGS:f "@gt 0" \
	"chain"
SecRule &ARGS:filter "@gt 0" \
	"chain"
SecRule &REQUEST_COOKIES:PHPSESSID "@gt 0" \
	"setvar:'SESSION.sphider=1',setsid:'%{TIME_EPOCH}'"

SecRule SESSION:sphider "@eq 1" \
	"id:222131,rev:1,chain,msg:'COMODO WAF: SQLi Detected in Sphider (CVE-2014-5192)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,skip:1"
SecRule ARGS:filter "@detectSQLi" \
	"t:'none',t:'urlDecodeUni',t:'sqlHexDecode',t:'removeWhitespace',t:'lowercase',multiMatch"

SecRule SESSION:sphider "@eq 1" \
	"id:222132,rev:1,chain,msg:'COMODO WAF: SQLi Detected in Sphider (CVE-2014-5192)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log"
SecRule ARGS:filter "@contains '" \
	"t:'none',t:'urlDecodeUni',t:'sqlHexDecode',t:'removeWhitespace',t:'lowercase',multiMatch"

SecRule REQUEST_FILENAME "@endsWith browse.php" \
	"id:222140,rev:1,chain,msg:'COMODO WAF: Possible Directory Traversal in Vtiger CRM before 6.0.0 Security patch 1 (CVE-2014-1222)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'lowercase',multiMatch"
SecRule REQUEST_COOKIES_NAMES "@contains vtiger" \
	"chain,t:'none',t:'urlDecodeUni',t:'removeWhitespace',t:'lowercase',multiMatch"
SecRule ARGS_GET:act "@streq download" \
	"chain,t:'none',t:'urlDecodeUni',t:'lowercase',multiMatch"
SecRule &ARGS_POST:dir "@ge 1" \
	"chain,t:'none',t:'urlDecodeUni',t:'lowercase',multiMatch"
SecRule ARGS_POST:file "@contains .." \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode',t:'removeWhitespace',multiMatch"

SecRule ARGS_POST:drp_action "@rx \D" \
	"id:222330,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in Cacti 0.8.8b (CVE-2014-4002)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni'"
SecRule REQUEST_FILENAME "@pm cdef.php data_input.php data_queries.php data_sources.php data_templates.php graph_templates.php graphs.php host.php host_templates.php" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule ARGS_POST:graph_template_id|ARGS_POST:graph_template_input_id "@rx \D" \
	"id:222331,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in Cacti 0.8.8b (CVE-2014-4002)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni'"
SecRule REQUEST_FILENAME "@endsWith graph_templates_inputs.php" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule ARGS_GET:app "@pm blog html menus" \
	"id:240040,rev:3,chain,msg:'COMODO WAF: XSS vulnerabilities in Baby Gekko before 1.2.2f (CVE-2012-5700)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',multiMatch"
SecRule ARGS_GET:action "@streq edititem" \
	"chain,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_FILENAME "@contains admin/index.php" \
	"chain,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_GET:id "@contains <" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_URI "@endsWith users/action/login" \
	"id:240041,rev:3,chain,phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule REQUEST_COOKIES_NAMES "@contains gusr" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:username|ARGS_POST:password "@rx \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule ARGS_POST:title "@contains <" \
	"id:240050,rev:2,chain,msg:'COMODO WAF: XSS vulnerability in the admin interface in Phorum before 5.2.19 (CVE-2012-6659)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni'"
SecRule REQUEST_COOKIES_NAMES "@contains phorum_session_v5" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:module "settings" \
	"chain,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_FILENAME "@contains admin.php" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule REQUEST_URI "@endsWith sa/getparticipants_json" \
	"id:240060,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in LimeSurvey 2.05+ Build 140618 (CVE-2014-5017)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase',multiMatch"
SecRule ARGS_POST:sidx "@contains '" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_URI "@contains participants/sa/getAttribute_json/pid/" \
	"id:240070,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in LimeSurvey 2.05+ Build 140618 (CVE-2014-5016)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_LINE "@contains <" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_URI "@contains admin/globalsettings" \
	"id:240071,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in LimeSurvey 2.05+ Build 140618 (CVE-2014-5016)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_GET:sa "@rx \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_URI "@contains survey/index" \
	"id:240080,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in LimeSurvey 2.05+ Build 140618 (CVE-2014-5018)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:loadname "@rx \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith timthumb.php" \
	"id:240090,rev:1,chain,msg:'COMODO WAF: CVE-2010-5302 / CVE-2010-5303 / CVE-2009-5142 found|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_GET:src "@pm < >" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@contains register-exec.php" \
	"id:240100,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in Restaurant Script (PizzaInn_Project) 1.0.0 (CVE-2014-6619)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:fname|ARGS_POST:lname|ARGS_POST:login "@contains '" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith modules/lib_jquery/plugins/cattranslate/cattranslate.php" \
	"id:240110,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the CatTranslate JQuery plugin in BlackCat CMS 1.0.3 (CVE-2014-5259)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &REQUEST_COOKIES:/cat[\d]{4}sessionid/ "@ge 1" \
	"chain"
SecRule ARGS:msg "@contains <" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@rx maint\/modules\/(home\/index|asterisk_info\/asterisk_info|repo\/repo|endpointcfg\/endpointcfg)\.php" \
	"id:240120,rev:1,chain,msg:'COMODO WAF: Multiple directory traversal vulnerabilities in Fonality trixbox allow remote attackers to read arbitrary files (CVE-2014-5111)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:lang "@contains .." \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith endpoint_generic.php" \
	"id:240130,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in Fonality trixbox (CVE-2014-5109)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS:mac "!@rx ^[0-9a-f]{12}$" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@contains user/help/html/index.php" \
	"id:240131,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in Fonality trixbox (CVE-2014-5110)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:id_nodo "@rx \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@contains maint/modules/home/index.php" \
	"id:240140,rev:1,chain,msg:'COMODO WAF: Fonality trixbox allows remote attackers to execute arbitrary commands (CVE-2014-5112)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:lang "@rx [^a-zA-Z0-9_]" \
	"t:'none',t:'urlDecodeUni',t:'cmdLine'"

SecRule REQUEST_COOKIES_NAMES "@pm data_layout main_layout" \
	"id:240150,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in MyWebSQL 3.4 and earlier (CVE-2014-4735)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS:table "@pm < >" \
	"t:'none',t:'urlDecodeUni'"

<LocationMatch ".*import\.php">
SecRule REQUEST_METHOD "@streq POST" \
	"id:240160,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in phpMyAdmin before 4.1.7 (CVE-2014-1879)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule FILES:import_file "@contains <"

</LocationMatch>
SecRule REQUEST_FILENAME "@contains haltResumeHsp.php" \
	"id:240170,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in OrangeHRM before 2.7 (CVE-2012-1506)|%{tx.domain}|%{tx.mode}',phase:1,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_GET:hspSummaryId "\D" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@contains modules/pm/pmlite.php" \
	"id:240180,rev:1,chain,msg:'2|%{tx.domain}|%{tx.mode}',msg:'COMODO WAF: Multiple XSS vulnerabilities in XOOPS before 2.5.5 (CVE-2012-0984)|%{tx.domain}|%{tx.mode}',deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:to_userid "@rx \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@contains class/xoopseditor/tinymce/tinymce/jscripts/tiny_mce/plugins/xoopsimagemanager/xoopsimagebrowser.php" \
	"id:240181,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in XOOPS before 2.5.5 (CVE-2012-0984)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:current_file|ARGS_POST:imgcat_id|ARGS_POST:target "@rx \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@rx concrete\/single_pages\/dashboard\/(?:(?:system\/(basics|mail|environment|permissions|seo)?|users|scrapbook|pages|files)?\/?(?:editor|file_storage_locations|importers|method|file_types|files|tasks|users|attributes|search)?(view)?)\.php" \
	"id:240190,rev:1,chain,msg:'COMODO WAF: Information leakage in the Concrete5 before 5.6.3 (CVE-2014-5107)|%{tx.domain}|%{tx.mode}',phase:4,deny,status:403,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule RESPONSE_BODY "@beginsWith Fatalerror:" \
	"t:'none',t:'urlDecodeUni',t:'removeWhitespace'"

SecRule REQUEST_FILENAME "@endsWith admin/tool/task/scheduledtasks.php" \
	"id:240200,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in Moodle 2.7.x before 2.7.1 (CVE-2014-3550)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &SESSION:moodlesession "@gt 0" \
	"chain"
SecRule ARGS:success|ARGS:error "@pm < > /" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@rx (badges\/mybadges|user\/profile)\.php$" \
	"id:240210,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in Moodle 2.5.x before 2.5.7, 2.6.x before 2.6.4 (CVE-2014-3547)|%{tx.domain}|%{tx.mode}',phase:4,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &SESSION:moodlesession "@gt 0" \
	"chain"
SecRule RESPONSE_BODY "!@rx <spanclass=\"badge\-name\">[a-z0-9\.'\!\:\-]+<\/a><\/li>"

SecRule REQUEST_FILENAME "@contains templates/hrfunct/emppop.php" \
	"id:240220,rev:4,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in OrangeHRM before 2.7 (CVE-2012-1507)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &ARGS_GET:reqcode "@ge 1" \
	"chain"
SecRule ARGS_GET:sortOrder1 "!@pm asc desc" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule REQUEST_FILENAME "@contains plugins/ajaxcalls/haltresumehsp.php" \
	"id:240221,rev:4,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in OrangeHRM before 2.7 (CVE-2012-1507)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &ARGS_GET:hspSummaryId "@ge 1" \
	"chain"
SecRule ARGS_GET:newHspStatus "@rx \D" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule &ARGS_GET:empId "@ge 1"

SecRule ARGS_GET:page "@streq posts" \
	"id:240230,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in the MetalGenix GeniXCMS 0.0.3 (CVE-2015-5066)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:act "add" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:title|ARGS_POST:content "@rx \"|'" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule REQUEST_FILENAME "index.php" \
	"t:'none',t:'lowercase'"

SecRule ARGS_GET:page "posts" \
	"id:240231,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in the MetalGenix GeniXCMS 0.0.3 (CVE-2015-5066)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:q "@rx \'" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule REQUEST_FILENAME "index.php" \
	"t:'none',t:'lowercase'"

<LocationMatch ".*/dashboard/users/create/">
SecRule REQUEST_COOKIES:_ga "@rx ^ga(\d+\.*)+" \
	"id:240250,rev:4,phase:2,capture,pass,setsid:'%{TX.1}',nolog,t:'none',t:'lowercase'"

SecRule REQUEST_COOKIES_NAMES "@contains _ga" \
	"id:240251,rev:4,chain,phase:2,pass,nolog,t:'none',t:'lowercase'"
SecRule REQUEST_METHOD "@streq get" \
	"expirevar:'SESSION.articleFR=300',setvar:'SESSION.TIMEOUT=300',setvar:'SESSION.articleFR=1',t:'none',t:'lowercase'"

SecRule SESSION:articleFR "@eq 1" \
	"id:240252,rev:4,phase:2,pass,nolog,skip:1"

SecRule REQUEST_METHOD "@streq post" \
	"id:240253,rev:4,chain,msg:'COMODO WAF: CSRF vulnerabilities in Free Reprintables ArticleFR 3.0.6 (CVE-2015-5530)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_NAMES "@pm username name password email website blog membership isactive" \
	"chain,t:'none',t:'lowercase'"
SecRule &SESSION:articleFR "!@eq 1"

</LocationMatch>
SecRule REQUEST_URI "@contains /dashboard/settings/categories" \
	"id:240260,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in Free Reprintables ArticleFR 3.0.6 (CVE-2015-5529)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:name "@rx <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_URI "@contains /dashboard/settings/links" \
	"id:240261,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in Free Reprintables ArticleFR 3.0.6 (CVE-2015-5529)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:title|ARGS_POST:rel|ARGS_POST:url "@rx <" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule REQUEST_URI "@contains /dashboard/tools/pingservers" \
	"id:240262,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in Free Reprintables ArticleFR 3.0.6 (CVE-2015-5529)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:url "@rx <" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule ARGS:action "@streq do_install" \
	"id:240270,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in Domain Technologie Control (DTC) before 0.32.11 (CVE-2011-5276)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:database_name "@rx \W" \
	"t:'none'"

SecRule ARGS:action "@pm do_install prepareinstall" \
	"id:240271,rev:1,chain,msg:'COMODO WAF: Directory traversal vulnerability in Domain Technologie Control (DTC) before 0.34.1 (CVE-2011-5273)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:pkg "@contains .." \
	"t:'none'"

SecRule REQUEST_COOKIES_NAMES "@contains cacti" \
	"id:240280,rev:2,chain,msg:'COMODO WAF: SQL injection vulnerability in Cacti before 0.8.8e (CVE-2015-4634)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_FILENAME "@endsWith graphs.php" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:local_graph_id "@rx \D" \
	"t:'none'"

SecRule REQUEST_FILENAME "@contains rate.php" \
	"id:240300,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerabilities in Free Reprintables ArticleFR 3.0.4 (CVE-2014-5097)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:act "@pm set get" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:id "@rx \D" \
	"t:'none'"

SecRule REQUEST_FILENAME "@rx \/(plupload\.flash|moxie)\.swf$" \
	"id:240320,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in in the Plupload plugin for WordPress and other web apps (CVE-2013-0237, CVE-2015-3439)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule &ARGS:id|&ARGS:target "@gt 0" \
	"t:'none',t:'lowercase'"

SecRule REQUEST_METHOD "!@streq post" \
	"id:240330,rev:3,phase:2,pass,nolog,t:'none',t:'lowercase',skipAfter:'END_XMLRPC_PROTECTION'"

SecRule REQUEST_FILENAME "!@endsWith xmlrpc.php" \
	"id:240331,rev:3,phase:2,pass,nolog,t:'none',t:'urlDecodeUni',t:'lowercase',skipAfter:'END_XMLRPC_PROTECTION'"

SecRule IP:XMLRPC_COUNTER "@eq 0" \
	"id:240332,rev:3,phase:2,pass,expirevar:'ip.xmlrpc_counter=%{tx.xmlrpc_watch_period}',setvar:'ip.xmlrpc_counter=+1',nolog,t:'none',skip:1"

SecAction \
	"id:240333,phase:2,pass,setvar:'ip.xmlrpc_counter=+1',nolog"

SecRule IP:XMLRPC_COUNTER "@gt %{tx.xmlrpc_requests_limit}" \
	"id:240334,rev:3,phase:2,pass,expirevar:'ip.xmlrpc_block=%{tx.xmlrpc_block_timeout}',setvar:'ip.xmlrpc_block=1',nolog,t:'none'"

SecRule IP:XMLRPC_BLOCK "@eq 1" \
	"id:240335,rev:3,chain,msg:'COMODO WAF: XML-RPC Attack Identified from %{tx.real_ip} (%{tx.xmlrpc_block_counter} hits since last alert) (CVE-2013-0235)|%{tx.domain}|%{tx.mode}',phase:2,block,log,t:'none',skip:1"
SecRule &IP:XMLRPC_BLOCK_FLAG "@eq 0" \
	"expirevar:'ip.xmlrpc_block_flag=60',setvar:'ip.xmlrpc_block_flag=1',setvar:'tx.xmlrpc_block_counter=%{ip.xmlrpc_block_counter}+1',setvar:'ip.xmlrpc_block_counter=0'"

SecRule IP:XMLRPC_BLOCK "@eq 1" \
	"id:240336,rev:3,phase:2,block,setvar:'ip.xmlrpc_block_counter=+1',nolog,t:'none'"

SecMarker END_XMLRPC_PROTECTION
SecRule REQUEST_FILENAME "@endsWith /site/tools/searchResults.php" \
	"id:240340,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in phpipam 1.1.010 (CVE-2015-6529)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni'"
SecRule ARGS_POST:addresses "@streq on" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:ip "@rx \"" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith site/error.php" \
	"id:240341,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in phpipam 1.1.010 (CVE-2015-6529)|%{tx.domain}|%{tx.mode}',phase:1,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_GET:section "@rx \D" \
	"t:'none'"

SecRule REQUEST_COOKIES_NAMES "@contains cacti" \
	"id:240350,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in Cacti before 0.8.8d (CVE-2015-4342)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_FILENAME "@endsWith /cdef.php" \
	"chain,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:cdef_id|ARGS_POST:id "@rx \D" \
	"t:'none'"

SecRule REQUEST_COOKIES_NAMES "@contains cacti" \
	"id:240360,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in Cacti before 0.8.8d (CVE-2015-4454)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_FILENAME "@endsWith /graph_templates.php" \
	"chain,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:graph_template_id "@rx \D" \
	"t:'none'"

SecRule REQUEST_FILENAME "@contains phpliteadmin.php" \
	"id:240370,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in phpLiteAdmin 1.1 (CVE-2015-6518)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_URI "@contains '" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith phpliteadmin.php" \
	"id:240371,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in phpLiteAdmin 1.1 (CVE-2015-6518)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:droptable|ARGS_GET:table "@contains <" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_COOKIES_NAMES "@contains cacti" \
	"id:240380,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in Cacti before 0.8.8d (CVE-2015-4454)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_FILENAME "@endsWith /settings.php" \
	"chain,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS:tab "@rx \W" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith /cpg15x/install_classic.php" \
	"id:240390,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Coppermine Photo Gallery (CPG) 1.5.36 (CVE-2015-6528)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:admin_username|ARGS_POST:admin_password|ARGS_POST:admin_email|ARGS_POST:dbserver|ARGS_POST:dbname|ARGS_POST:dbuser|ARGS_POST:dbpass|ARGS_POST:table_prefix|ARGS_POST:impath "@rx <|\'|\"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntitydecode'"

SecRule REQUEST_COOKIES_NAMES "@contains cacti" \
	"id:240400,rev:1,chain,msg:'COMODO WAF: XSS injection vulnerability in Cacti before 0.8.8d (CVE-2015-2665)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_FILENAME "@endsWith /graphs.php" \
	"chain,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:title "@rx \'" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_COOKIES_NAMES "@contains pimcore_admin_sid" \
	"id:240410,rev:1,chain,msg:'COMODO WAF: Directory traversal vulnerability in pimcore before build 3473 (CVE-2015-4425)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_FILENAME "@endsWith /admin/asset/add-asset-compatibility/" \
	"chain,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &ARGS:parentId "@ge 1" \
	"chain,t:'none'"
SecRule ARGS:dir "@contains .." \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith /www/make_subset.php" \
	"id:240420,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in PHP Font Lib before 0.3.1 (CVE-2015-2570)|%{tx.domain}|%{tx.mode}',phase:1,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &ARGS_GET:fontfile "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_GET:name "@contains <" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith adm_config_report.php" \
	"id:240430,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in MantisBT 1.2.13 through 1.2.17 (CVE-2014-8987)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_COOKIES:MANTIS_STRING_COOKIE "@rx ^[a-f0-9]{64}$" \
	"chain,t:'none'"
SecRule ARGS:config_option "@rx \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule ARGS_GET:demo "@streq applyconvolution" \
	"id:240440,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in WideImage 11.02.19 (CVE-2015-5519)|%{tx.domain}|%{tx.mode}',phase:1,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_FILENAME "@rx \/demo\/(?:index\.php)?$" \
	"chain,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:matrix "@rx \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith backend/groups/ajax_save_group.php" \
	"id:240450,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in BlackCat CMS 1.1.2 (CVE-2015-5521)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule REQUEST_COOKIES:/^cat[\d]+sessionid$/ "@rx [0-9a-z]{26}" \
	"chain,t:'none'"
SecRule ARGS_POST:name "@rx \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_COOKIES_NAMES|RESPONSE_HEADERS "@contains PHPSESSID" \
	"id:240460,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in OpenDocMan before 1.3.4 (CVE-2015-5625)|%{tx.domain}|%{tx.mode}',phase:3,deny,status:403,log,t:'none'"
SecRule REQUEST_FILENAME "@rx \/(?:index\.php)?$" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS:redirection "@rx data\:[\w\/]+\;base64" \
	"t:'none',t:'lowercase',t:'removeWhitespace'"

SecRule &REQUEST_COOKIES:PHPSESSID "@gt 0" \
	"id:240470,rev:1,chain,msg:'COMODO WAF: Unrestricted file upload vulnerability in the My Image plugin in Nibbleblog before 4.0.5 (CVE-2015-6967)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule REQUEST_FILENAME "@endsWith admin.php" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS:plugin "@streq my_image" \
	"chain,t:'none',t:'lowercase'"
SecRule FILES "!@rx \.(?:jpe?g|png|gif)$" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule REQUEST_FILENAME "@contains /content/private/plugins/my_image/" \
	"id:240471,rev:1,chain,msg:'COMODO WAF: Unrestricted file upload vulnerability in the My Image plugin in Nibbleblog before 4.0.5 (CVE-2015-6967)|%{tx.domain}|%{tx.mode}',phase:1,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule REQUEST_BASENAME "!@rx image\.(?:jpe?g|png|gif)$" \
	"t:'none',t:'lowercase'"

SecRule REQUEST_FILENAME "@endsWith feedback/pages/feedback.php" \
	"id:240480,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in Montala Limited ResourceSpace 7.3.7009 and earlier (CVE-2015-6915)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_COOKIES:user "@rx \'" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_COOKIES:dcxd "@rx ^[0-9a-f]{40}$" \
	"id:240490,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in Dotclear before 2.8.1 (CVE-2015-5651)|%{tx.domain}|%{tx.mode}',phase:1,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_FILENAME "@endsWith posts.php" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:/entries\[\d+\]/ "@rx \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith serendipity_admin.php" \
	"id:240500,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in the Serendipity before 2.0.2 (CVE-2015-6943)|%{tx.domain}|%{tx.mode}',phase:1,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:serendipity[id] "@rx \D" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith admin/categories.php" \
	"id:227600,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in 4images 1.7.11 and earlier (CVE-2015-7708)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:action "@pm updatecat savecat" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:cat_description "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith front/ticket.form.php" \
	"id:240510,rev:1,chain,msg:'COMODO WAF: Unrestricted file upload vulnerability in the GLPI before 0.85.3 (CVE-2015-7684)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:/_filename\[\d+]/ "@rx \.(?:php[\d]?|js|pl|rb|sh|p?html|asp|exe|com|htaccess)$" \
	"t:'none',t:'lowercase'"

SecRule ARGS_POST:serendipity[submit] "@streq submit comment" \
	"id:240520,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the 2k11 theme in Serendipity before 2.0.2 (CVE-2015-6969)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:serendipity[name] "@rx \W" \
	"chain,t:'none'"
SecRule REQUEST_FILENAME "@endsWith index.php" \
	"t:'none',t:'lowercase'"

SecRule &ARGS_POST:token "@eq 0" \
	"id:240530,rev:1,chain,msg:'COMODO WAF: CSRF in Revive Adserver before 3.2.2 (CVE-2015-7364)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule REQUEST_METHOD "@streq post" \
	"chain,t:'none',t:'lowercase'"
SecRule REQUEST_COOKIES:sessionID "@rx ^[a-z0-9]{32}$" \
	"chain,t:'none'"
SecRule REQUEST_FILENAME "@rx (?:(?:advertiser|campaign|affiliate|zone|channel)\-edit|account\-user\-(?:name\-language|email|password))\.php$" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule ARGS_POST:token "@eq 0" \
	"id:240531,rev:1,chain,msg:'COMODO WAF: CSRF in Revive Adserver before 3.2.2 (CVE-2015-7364)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'length'"
SecRule REQUEST_COOKIES:sessionID "@rx ^[a-z0-9]{32}$" \
	"chain,t:'none'"
SecRule REQUEST_FILENAME "@rx (?:(?:advertiser|campaign|affiliate|zone|channel)\-edit|account\-user\-(?:name\-language|email|password))\.php$" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule REQUEST_FILENAME "@endsWith serendipity_admin.php" \
	"id:240540,rev:1,chain,msg:'COMODO WAF: Multiple incomplete blacklist vulnerabilities in Serendipity before 2.0.2 (CVE-2015-6968)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:/serendipity\[target_filename]\[\d+]/ "@rx \.pht(?:ml)?$" \
	"t:'none',t:'lowercase'"

SecRule REQUEST_FILENAME "@endsWith serendipity_admin.php" \
	"id:240550,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in Serendipity before 2.0.1 (CVE-2015-2289)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:serendipity[cat][name] "@rx \W" \
	"t:'none'"

SecRule ARGS_GET:controller "@streq post" \
	"id:240561,rev:1,chain,phase:2,pass,nolog,t:'none',t:'lowercase'"
SecRule ARGS_GET:action "@streq new_simple" \
	"chain,t:'none',t:'lowercase'"
SecRule REQUEST_METHOD "@streq post" \
	"expirevar:'SESSION.nbblog=300',setvar:'SESSION.TIMEOUT=300',setvar:'SESSION.nbblog=1',t:'none',t:'lowercase'"

SecRule SESSION:nbblog "@eq 1" \
	"id:240562,rev:1,phase:2,pass,nolog,skip:1"

SecRule ARGS_GET:controller "@streq post" \
	"id:240563,rev:1,chain,msg:'COMODO WAF: CSRF vulnerability in Nibbleblog before 4.0.5 (CVE-2015-6966)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:action "@streq new_simple" \
	"chain,t:'none',t:'lowercase'"
SecRule REQUEST_METHOD "@streq post" \
	"chain,t:'none',t:'lowercase'"
SecRule &SESSION:nbblog "!@eq 1" \
	"t:'none'"

SecRule ARGS_GET:controller "@streq post" \
	"id:240570,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Nibbleblog before 4.0.2 (CVE-2014-8996)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:action "@streq view" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:hash "@rx ^[0-9a-f]+$" \
	"chain,t:'none'"
SecRule ARGS_POST:author_name|ARGS_POST:content "@rx <|\"" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith index.php/admin/questiongroups/sa/import" \
	"id:240580,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in LimeSurvey before 2.06+ Build 150618 (CVE-2015-4628)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:action "@streq importgroup" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:sid "@rx \D" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith index.php/admin/dataentry/sa/insert" \
	"id:240590,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in LimeSurvey 2.06+ (CVE-2015-5078)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'normalisePath'"
SecRule ARGS_POST:subaction "@streq insert" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:closedate "!@rx ^[\d-:]+$" \
	"t:'none',t:'removeWhitespace'"

SecRule ARGS_GET:time "!@rx ^[\d\.]+$" \
	"id:240600,rev:2,chain,msg:'COMODO WAF: SQL Injection in FreiChat 9.6 (CVE-2015-6512)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule REQUEST_FILENAME "@endsWith server/freichat.php" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule REQUEST_BASENAME "@rx ^(?:stats_(?:products_purchased|monthly_sales|customers)|information_manager|geo_zones|new_attributes_include)\.php$" \
	"id:240610,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in the admin panel in osCMax before 2.5.1 (CVE-2012-1664)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_GET:gross|ARGS_GET:max|ARGS_GET:status|ARGS_GET:sorted|ARGS_GET:information_id|ARGS_GET:zID|ARGS_GET:current_product_id|ARGS_GET:cPath|ARGS_GET:pageTitle "@rx ['\"<]" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_BASENAME "@streq htaccess.php" \
	"id:240611,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in the admin panel in osCMax before 2.5.1 (CVE-2012-1664)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:sb_id|ARGS_POST:sb_key|ARGS_POST:gc_id|ARGS_POST:gc_key|ARGS_POST:path "@rx \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_BASENAME "@streq information_form.php" \
	"id:240612,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in the admin panel in osCMax before 2.5.1 (CVE-2012-1664)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_GET:title "@rx ['\"<]" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_BASENAME "@streq xsell.php" \
	"id:240613,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in the admin panel in osCMax before 2.5.1 (CVE-2012-1664)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_GET:search "@rx ['\"<]" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_BASENAME "@streq stats_monthly_sales.php" \
	"id:240614,rev:1,chain,msg:'COMODO WAF: Multiple SQL injection vulnerabilities in the admin panel in osCMax before 2.5.1 (CVE-2012-1665)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_GET:status "@rx \D" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_BASENAME "@streq create_account_process.php" \
	"id:240615,rev:1,chain,msg:'COMODO WAF: Multiple SQL injection vulnerabilities in the admin panel in osCMax before 2.5.1 (CVE-2012-1665)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:country "@rx \D" \
	"t:'none',t:'urlDecodeUni'"

SecRule FILES "@contains <" \
	"id:240620,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in Revive Adserver before 3.2.2 (CVE-2015-7365)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"
SecRule REQUEST_COOKIES:sessionID "@rx ^[a-z0-9]{32}$" \
	"chain,t:'none'"
SecRule REQUEST_FILENAME "@endsWith plugin-index.php" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule REQUEST_URI "@contains syspass" \
	"id:240630,rev:1,chain,msg:'COMODO WAF: SQL Injection vulnerability in cygnux.org sysPass 1.0.9 and earlier (CVE-2015-6516)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_FILENAME "@endswith ajax/ajax_search.php" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS:search "@rx [')]" \
	"t:'none'"

SecRule &REQUEST_COOKIES_NAMES:pwg_id "@eq 1" \
	"id:240640,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in Piwigo before 2.7.4 (CVE-2015-2035)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:page "@contains <" \
	"t:'none',t:'urlDecodeUni'"

SecRule &REQUEST_COOKIES_NAMES:pwg_id "@eq 1" \
	"id:240641,rev:1,chain,msg:'COMODO WAF: SQL Injection vulnerability in Piwigo before 2.7.4 (CVE-2015-2035)|%{tx.domain}|%{tx.mode}',phase:2,deny,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:page "@streq history" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:user "@rx \D" \
	"t:'none'"

SecRule REQUEST_URI "@endswith opensis/index.php" \
	"id:240650,rev:1,chain,msg:'COMODO WAF: SQL Injection vulnerability in openSIS 4.5 through 5.3 (CVE-2014-8366)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:username|ARGS_POST:password "@contains '" \
	"t:'none',t:'urlDecodeUni'"

SecRule ARGS:id "@rx <" \
	"id:240660,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in zTree 3.5.19.1 and possibly earlier (CVE-2015-7348)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni'"
SecRule REQUEST_FILENAME "@rx (?:getnodes|getnodesforbigdata).php$" \
	"t:'none',t:'lowercase'"

SecRule ARGS_GET:rra_id "@rx \D" \
	"id:240670,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in Cacti 0.8.8f and earlier (CVE-2015-8369)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_GET:action "@streq properties" \
	"chain,t:'none'"
SecRule &REQUEST_COOKIES:Cacti "@ge 1" \
	"chain,t:'none'"
SecRule REQUEST_FILENAME "@endsWith graph.php" \
	"t:'none',t:'lowercase'"

SecRule ARGS:name "@endsWith .php" \
	"id:240680,rev:1,chain,msg:'COMODO WAF: Unrestricted file upload vulnerability in the Panel component in Bastian Allgeier Kirby before 2.1.2 (CVE-2015-7773)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule &REQUEST_COOKIES:key "@ge 1" \
	"chain,t:'none'"
SecRule REQUEST_FILENAME "@contains /panel/api/files/rename/" \
	"t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"

SecRule ARGS_POST:formType "@pm install update" \
	"id:240690,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Web Reference Database (aka refbase) through 0.9.6 (CVE-2015-7383)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_COOKIES:PHPSESSID "@rx ^\w+$" \
	"chain,t:'none'"
SecRule ARGS_POST:submit "@pm install update" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:adminUserName|ARGS_POST:pathToMYSQL|ARGS_POST:databaseStructureFile|ARGS_POST:pathToBibutils "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@contains www/admin/banner-edit" \
	"id:240700,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in the Revive Adserver before 3.2.2 (CVE-2015-7373)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalizePath',t:'lowercase'"
SecRule ARGS_POST:submit "@streq savechanges" \
	"chain,t:'none',t:'removeWhitespace',t:'lowercase'"
SecRule ARGS_POST:url|ARGS_POST:height|ARGS_POST:width|ARGS_POST:weight "@rx <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endswith changedata.php" \
	"id:240710,rev:1,chain,msg:'COMODO WAF: Multiple cross-site scripting (XSS) vulnerabilities in GetSimple CMS before 3.3.6 (CVE-2015-5355)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:post-title|ARGS_POST:post-content "@contains \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endswith filebrowser.php" \
	"id:240720,rev:1,chain,msg:'COMODO WAF: Multiple cross-site scripting (XSS) vulnerabilities in GetSimple CMS before 3.3.6 (CVE-2015-5356)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:func "@rx \W" \
	"t:'none'"

SecRule &REQUEST_COOKIES:october_session "@eq 1" \
	"id:240730,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in October CMS build 271 and earlier (CVE-2015-5612)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:title "@contains <" \
	"t:'none'"

SecRule &REQUEST_COOKIES:pwg_id "@gt 0" \
	"id:240740,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in the Piwigo before 2.7.4 (CVE-2015-1517)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_GET:page "@streq batch_manager" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:filter_level "@rx \D" \
	"t:'none'"

SecRule &REQUEST_COOKIES:pwg_id "@gt 0" \
	"id:240750,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Piwigo before 2.7.4 (CVE-2015-2034)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_GET:page "@rx <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith symphony/blueprints/sections/edit/1/saved/" \
	"id:240760,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Symphony CMS 2.6.3 (CVE-2015-8376)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:meta[name]|ARGS_POST:meta[navigation_group] "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith serendipity_admin.php" \
	"id:240770,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Serendipity before 2.0.3 (CVE-2015-8603)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:serendipity[adminAction] "@streq edit" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:serendipity[entry_id] "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_GET:route "@streq account/address/add" \
	"id:240780,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in OpenCart before 2.1.0.2 (CVE-2015-4671)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:zone_id "@rx \D" \
	"t:'none'"

SecRule REQUEST_URI "@endswith nucleus/index.php" \
	"id:240790,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in Nucleus CMS 3.65 (CVE-2015-5454)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:title "@contains <" \
	"t:'none'"

SecRule REQUEST_FILENAME "@contains card.php" \
	"id:240800,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in Dolibarr ERP/CRM 3.8.3 (CVE-2016-1912)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:action "@streq update" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:lastname|ARGS_POST:firstname|ARGS_POST:job|ARGS_POST:email|ARGS_POST:signature "@contains <" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith agenda_extsites.php" \
	"id:240810,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in Dolibarr ERP/CRM 3.8.3 and earlier (CVE-2015-8685)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_COOKIES_NAMES "@beginsWith DOLSESSID_" \
	"chain,t:'none'"
SecRule ARGS "@rx \"" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule MATCHED_VARS_NAMES "@rx ^ARGS:AGENDA_EXT_(?:NAME|SRC|COLOR)__[\d]{1}$" \
	"t:'none'"

SecRule REQUEST_FILENAME "@contains onepage/savebilling" \
	"id:240820,rev:1,chain,msg:'COMODO WAF: Stored XSS in Magento before Magento CE: 1.9,2.3, Magento EE: 1.14.2.3|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:billing[email] "@rx \"" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule &REQUEST_COOKIES:frontend "@ge 1" \
	"t:'none'"

SecRule ARGS_GET:mimetype "!@within application/octet-stream text/plain" \
	"id:240830,rev:1,chain,msg:'COMODO WAF: CRLF injection vulnerability in CGit before 0.12 (CVE-2016-1899)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule REQUEST_FILENAME "@contains /blob/" \
	"t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"

SecRule &REQUEST_COOKIES:sess_hash "@gt 0" \
	"id:240840,rev:1,chain,msg:'COMODO WAF: XSS injection vulnerability in the Beehive Forum 1.4.4 (CVE-2015-2198)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_POST:homepage_url|ARGS_POST:pic_url|ARGS_POST:avatar_url "@rx \"|<" \
	"chain,t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"
SecRule REQUEST_FILENAME "@endsWith edit_prefs.php" \
	"t:'none',t:'lowercase'"

SecRule REQUEST_FILENAME "@pm cms/index.php forum/index.php" \
	"id:240850,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the ocPortal before 9.0.17 (CVE-2015-2677)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:page "@pm cms_calendar cms_polls topics" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:title|ARGS_POST:question|ARGS_POST:reason|ARGS_POST:description "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@contains symphony/system/preferences" \
	"id:240860,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Symphony CMS before 2.6.4 (CVE-2015-8766)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:settings[email_sendmail][from_name]|ARGS_POST:settings[email_sendmail][from_address]|ARGS_POST:settings[email_smtp][from_name]|ARGS_POST:settings[email_smtp][from_address]|ARGS_POST:settings[email_smtp][host]|ARGS_POST:settings[email_smtp][port]|ARGS_POST:it_image_manipulation[trusted_external_sites]|ARGS_POST:maintenance_mode[ip_whitelist]|ARGS_POST:settings[email_smtp][username]|ARGS_POST:settings[email_smtp][password] "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@contains symphony/system/authors" \
	"id:240870,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Symphony CMS 2.6.2 (CVE-2015-4661)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:sort "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@pm create_course.php edit_course.php" \
	"id:240880,rev:2,chain,msg:'COMODO WAF: Unrestricted file upload vulnerability in ATutor before 2.2 (CVE-2014-9752)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule FILES_NAMES "@streq customicon" \
	"chain,t:'none',t:'lowercase'"
SecRule FILES "!@rx \w+.(png|jpg|gif)" \
	"t:'none',t:'lowercase'"

SecRule ARGS_POST:__vtrftk "@beginsWith sid:" \
	"id:240890,rev:2,chain,msg:'COMODO WAF: Shell Upload Vulnerability in VtigerCRM 6.4.0 and earlier (CVE-2016-1713 & CVE-2015-6000)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_COOKIES:PHPSESSID "@eq 26" \
	"chain,t:'none',t:'length'"
SecRule FILES "!@rx \.(?:gif|p?jpe?g|(?:x-)?png)$" \
	"t:'none',t:'lowercase'"

SecRule ARGS_GET:mode "@streq admin" \
	"id:240900,rev:1,chain,msg:'COMODO WAF: XSS & SQL injection vulnerability in my little forum before 2.3.4 (CVE-2015-1434)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule &REQUEST_COOKIES:/^mlf\w+$/ "@gt 0" \
	"chain,t:'none'"
SecRule ARGS_GET:edit_category|ARGS_GET:letter "@rx \'" \
	"t:'none',t:'urlDecodeUni'"

SecRule ARGS_GET:mode "@streq posting" \
	"id:240910,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in my little forum before 2.3.4 (CVE-2015-1435)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule &REQUEST_COOKIES:/^mlf\w+$/ "@gt 0" \
	"chain,t:'none'"
SecRule ARGS_GET:back "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule &REQUEST_COOKIES:/^mlf\w+$/ "@gt 0" \
	"id:240920,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in my little forum 2.3.3, 2.2, and 1.7 (CVE-2015-1475)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_GET:page|ARGS_GET:category|ARGS_GET:order|ARGS_POST:title|ARGS_POST:menu_linkname "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_POST:formType "@pm install update" \
	"id:240930,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in the Web Reference Database (aka refbase) through 0.9.6 (CVE-2015-7382)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_FILENAME "@pm install.php update.php" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:submit "@pm install update" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:defaultCharacterSet "@rx \W" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith error.php" \
	"id:240940,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Web Reference Database (aka refbase) through 0.9.6 (CVE-2015-6010)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:errorNo|ARGS_GET:errorMsg "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith import_modify.php" \
	"id:240941,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Web Reference Database (aka refbase) through 0.9.6 (CVE-2015-6010)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:sourceText "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@pm import_modify.php" \
	"id:240942,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Web Reference Database (aka refbase) through 0.9.6 (CVE-2015-6010)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:sourceIDs|ARGS_POST:importRecords "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith duplicate_manager.php" \
	"id:240980,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Web Reference Database (aka refbase) through 0.9.6 (CVE-2015-6010)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:viewType "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith query_manager.php" \
	"id:240981,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Web Reference Database (aka refbase) through 0.9.6 (CVE-2015-6010)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:queryAction|ARGS_GET:displayType|ARGS_GET:citeOrder|ARGS_GET:sqlQuery|ARGS_GET:showQuery|ARGS_GET:showLinks|ARGS_GET:showRows|ARGS_GET:queryID "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith query_modify.php" \
	"id:240982,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Web Reference Database (aka refbase) through 0.9.6 (CVE-2015-6010)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:queryAction|ARGS_POST:displayType|ARGS_POST:showLinks|ARGS_POST:showRows|ARGS_POST:citeOrder|ARGS_POST:queryID "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith modify.php" \
	"id:240983,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Web Reference Database (aka refbase) through 0.9.6 (CVE-2015-6010)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:typeName|ARGS_POST:fileName "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith query_modify.php" \
	"id:240984,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Web Reference Database (aka refbase) through 0.9.6 (CVE-2015-6010)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:sqlQuery "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_URI "@rx user:(.*)$" \
	"id:240950,rev:1,chain,msg:'COMODO WAF: XSS & SQL injection vulnerability in Pragyan CMS 3.0 (CVE-2015-1471)|%{tx.domain}|%{tx.mode}',phase:1,capture,deny,status:403,log,t:'none',t:'lowercase'"
SecRule TX:1 "@rx \D" \
	"t:'none'"

SecRule REQUEST_FILENAME "@contains alt_doc.php" \
	"id:240960,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in TYPO3 6.2.x before 6.2.16 and 7.x before 7.6.1 (CVE-2015-8759)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase',t:'urlDecodeUni'"
SecRule ARGS_POST:/data\[tt_content\]\[\d+]\[header_link\](_hr)?/ "@pm javascript:" \
	"t:'none',t:'lowercase',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith views/zero_transact_user.php" \
	"id:240970,rev:1,chain,msg:'COMODO WAF: XSS & SQL injection vulnerability in ZeroCMS 1.3.3, 1.3.2, and earlier (CVE-2015-1442)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:user_id "@rx \D" \
	"t:'none'"

SecRule REQUEST_URI "@pm /typo3/index.php" \
	"id:240990,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in TYPO3 6.x before 6.2.15, 7.x before 7.4.0, 4.5.40, and earlier (CVE-2015-5956)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase',t:'urlDecodeUni'"
SecRule ARGS_POST:redirect_url "@rx data\:[\w\/]+\;base64" \
	"t:'none',t:'lowercase',t:'removeWhitespace'"

SecRule REQUEST_FILENAME "@pm show_rechis.php" \
	"id:240991,rev:1,chain,msg:'COMODO WAF: Cross site scripting vulnerability in TYPO3 6.x before 6.2.15, 7.x before 7.4.0, 4.5.40, and earlier (CVE-2015-5956)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase',t:'urlDecodeUni'"
SecRule ARGS_GET:returnUrl "@rx data\:[\w\/]+\;base64" \
	"t:'none',t:'lowercase',t:'removeWhitespace'"

SecRule ARGS_POST:subcats-included "@ge 1" \
	"id:241000,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in the Piwigo before 2.5.6, 2.6.x before 2.6.5, and 2.7.x before 2.7.3 (CVE-2015-1441)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule REQUEST_FILENAME "@endsWith search.php" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:mode|ARGS_POST:date_type|ARGS_POST:search_author|ARGS_POST:fields[] "@rx \W" \
	"t:'none'"

SecRule ARGS_POST:subcats-included "@ge 1" \
	"id:241001,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in the Piwigo before 2.5.6, 2.6.x before 2.6.5, and 2.7.x before 2.7.3 (CVE-2015-1441)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule REQUEST_FILENAME "@endsWith search.php" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:start_day|ARGS_POST:start_month|ARGS_POST:start_year|ARGS_POST:end_day|ARGS_POST:end_month|ARGS_POST:end_year|ARGS_POST:subcats-included "@rx \D" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith backend/main.php" \
	"id:241010,rev:1,chain,msg:'COMODO WAF: XSS & SQL injection vulnerabilities in Sefrengo before 1.6.1 (CVE-2015-0919)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'normalisePath'"
SecRule ARGS_GET:area "@streq con_configcat" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:idcat "@rx \"|\'" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith backend/main.php" \
	"id:241011,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerabilities in Sefrengo before 1.6.1 (CVE-2015-0919)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'normalisePath'"
SecRule ARGS_GET:area "@streq con_configcat" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:idcat "@rx \'" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith backend/main.php" \
	"id:241012,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerabilities in Sefrengo before 1.6.1 (CVE-2015-0919)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'normalisePath'"
SecRule ARGS_GET:area "@streq plug" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:idclient "@rx \'" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith backend/main.php" \
	"id:241013,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerabilities in Sefrengo before 1.6.1 (CVE-2015-0919)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'normalisePath'"
SecRule ARGS_POST:idclient "@rx \'" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule ARGS_GET:area "@streq plug" \
	"t:'none',t:'lowercase'"

SecRule REQUEST_FILENAME "@endsWith backend/main.php" \
	"id:241020,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in Sefrengo before 1.6.1 (CVE-2015-0918)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'normalisePath'"
SecRule ARGS_GET:area "@streq user" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:searchterm "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith backend/main.php" \
	"id:241030,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in Sefrengo before 1.6.2 (CVE-2015-1428)|%{tx.domain}|%{tx.mode}',phase:1,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'normalisePath'"
SecRule REQUEST_COOKIES:sefrengo "@rx \'" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith backend/main.php" \
	"id:241031,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in Sefrengo before 1.6.2 (CVE-2015-1428)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'normalisePath'"
SecRule ARGS_POST:area "@streq settings" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:value_id "@rx \'" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@pm user_management.php" \
	"id:241040,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in Saurus CMS 4.7.0 (CVE-2015-1562)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase',t:'urlDecodeUni'"
SecRule ARGS_GET:search "@rx <" \
	"t:'none',t:'lowercase',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@pm profile_data.php" \
	"id:241041,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in Saurus CMS 4.7.0 (CVE-2015-1562)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase',t:'urlDecodeUni'"
SecRule ARGS_GET:data_search "@rx <" \
	"t:'none',t:'lowercase',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@pm error_log.php" \
	"id:241042,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in Saurus CMS 4.7.0 (CVE-2015-1562)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase',t:'urlDecodeUni'"
SecRule ARGS_GET:filter "@rx <" \
	"t:'none',t:'lowercase',t:'urlDecodeUni'"

SecRule &ARGS_GET:p "@gt 0" \
	"id:241050,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Gecko CMS 2.2 and 2.3 (CVE-2015-1422)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_POST:jak_extfile|ARGS_POST:jak_file|ARGS_POST:jak_tags "@rx \"|<" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule &ARGS_GET:p "@gt 0" \
	"id:241051,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Gecko CMS 2.2 and 2.3 (CVE-2015-1422)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_GET:sp|ARGS_GET:ssp|ARGS_GET:sssp|ARGS_GET:ssssp "@rx \"|<" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith js/editor/plugins/filemanager/dialog.php" \
	"id:241052,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Gecko CMS 2.2 and 2.3 (CVE-2015-1422)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'normalisePath'"
SecRule ARGS_GET:type|ARGS_GET:editor|ARGS_GET:lang|ARGS_GET:fldr|ARGS_GET:field_id "@rx \"|<" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_GET:p "@streq categories" \
	"id:241053,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Gecko CMS 2.2 and 2.3 (CVE-2015-1422)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:jak_name|ARGS_POST:jak_varname|ARGS_POST:jak_url|ARGS_POST:jak_img "@rx \"|<" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_GET:p "@streq site" \
	"id:241054,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Gecko CMS 2.2 and 2.3 (CVE-2015-1422)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:jak_title|ARGS_POST:jak_description|ARGS_POST:jak_keywords|ARGS_POST:jak_author|ARGS_POST:jak_copy "@rx \"|<" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_GET:p "@streq plugins" \
	"id:241055,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Gecko CMS 2.2 and 2.3 (CVE-2015-1422)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:jak_generala|ARGS_POST:jak_managea|ARGS_POST:jak_name|ARGS_POST:jak_phpcode "@rx \"|<" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_GET:p "@streq user" \
	"id:241056,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Gecko CMS 2.2 and 2.3 (CVE-2015-1422)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:jak_name|ARGS_POST:jak_email|ARGS_POST:jak_username|ARGS_POST:jak_password "@rx \"|<" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_GET:p "@streq usergroup" \
	"id:241057,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Gecko CMS 2.2 and 2.3 (CVE-2015-1422)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:jak_name "@rx \"|<" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_GET:p "@streq page" \
	"id:241058,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Gecko CMS 2.2 and 2.3 (CVE-2015-1422)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:jak_catid|ARGS_POST:jak_title|ARGS_POST:jak_password|ARGS_POST:jak_css|ARGS_POST:jak_javascript|ARGS_POST:jak_showcontact|ARGS_POST:horder_new[]|ARGS_POST:real_hook_id_new[]|ARGS_POST:sreal_plugin_id_new[]|ARGS_POST:horder[]|ARGS_POST:real_hook_id[]|ARGS_POST:sreal_plugin_id[] "@rx \"|<" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_GET:p "@streq contactform" \
	"id:241059,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Gecko CMS 2.2 and 2.3 (CVE-2015-1422)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:jak_email|ARGS_POST:jak_title|ARGS_POST:jak_option[]|ARGS_POST:jak_options[] "@rx \"|<" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_GET:p "@streq sitemap" \
	"id:241060,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in Gecko CMS 2.2 and 2.3 (CVE-2015-1422)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:jak_title|ARGS_POST:jak_hookshow[]|ARGS_POST:horder_new[]|ARGS_POST:real_hook_id_new[]|ARGS_POST:sreal_plugin_id_new[]|ARGS_POST:horder[]|ARGS_POST:real_hook_id[]|ARGS_POST:sreal_plugin_id[] "@rx \"|<" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_GET:p "@streq logs" \
	"id:241061,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in Gecko CMS 2.2 and 2.3 (CVE-2015-1422)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:jak_delete_log[] "@rx \"|<" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_GET:p "@streq logs" \
	"id:241070,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerabilities in Gecko CMS 2.2 and 2.3 (CVE-2015-1423)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:ssp "@rx \D" \
	"t:'none'"

SecRule ARGS_GET:p "@streq logs" \
	"id:241071,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerabilities in Gecko CMS 2.2 and 2.3 (CVE-2015-1423)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:jak_delete_log[] "@rx \D" \
	"t:'none'"

SecRule ARGS_POST:_skin "@contains .." \
	"id:241080,rev:1,chain,msg:'COMODO WAF: Directory traversal vulnerability in Roundcube before 1.0.8 and 1.1.x before 1.1.4 (CVE-2015-8770)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_POST:_action "@streq save-prefs" \
	"chain,t:'none'"
SecRule &ARGS_POST:_token "@ge 1" \
	"chain,t:'none'"
SecRule REQUEST_COOKIES_NAMES "@contains roundcube" \
	"t:'none',t:'lowercase'"

SecRule ARGS_POST:submit "@contains send!" \
	"id:241090,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in the CatBot 0.4.2 (CVE-2015-1367)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:lastcatbot "@rx \'" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule REQUEST_FILENAME "@endsWith index.php" \
	"t:'none',t:'lowercase'"

SecRule REQUEST_FILENAME "@endsWith __admin/index.php" \
	"id:241100,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in xlinkerz ecommerceMajor (CVE-2015-1476)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'normalisePath'"
SecRule ARGS_POST:username|ARGS_POST:password "@rx \'" \
	"t:'none',t:'urlDecodeUni'"

SecRule &ARGS_GET:productbycat "@ge 1" \
	"id:241101,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in xlinkerz ecommerceMajor (CVE-2015-1476)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule REQUEST_FILENAME "@endsWith product.php" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:productbycat "@rx \D" \
	"t:'none'"

SecRule REQUEST_URI "@pm locale/index" \
	"id:241110,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerabilities in Fork CMS before 3.8.6 (CVE-2015-1467)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_GET:type[] "@rx \'" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule REQUEST_URI "@pm locale/index" \
	"id:241111,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerabilities in Fork CMS before 3.8.6 (CVE-2015-1467)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_GET:language[] "@rx \'" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule REQUEST_FILENAME "@pm mod/lesson/view.php mod/lesson/mediafile.php" \
	"id:241121,rev:2,chain,phase:2,pass,nolog,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule REQUEST_METHOD "@streq get" \
	"expirevar:'SESSION.moodle_ls=300',setvar:'SESSION.moodle_ls=1',setvar:'SESSION.TIMEOUT=300',t:'none',t:'lowercase'"

SecRule SESSION:moodle_ls "@eq 1" \
	"id:241122,rev:2,phase:2,pass,nolog,skip:1"

SecRule REQUEST_FILENAME "@pm mod/lesson/view.php mod/lesson/mediafile.php" \
	"id:241123,rev:2,chain,msg:'COMODO WAF: CSRF vulnerability in Moodle through 2.6.11, 2.7.x before 2.7.11, 2.8.x before 2.8.9, and 2.9.x before 2.9.3 (CVE-2015-5338)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &ARGS_GET:id "@ge 1" \
	"chain,t:'none'"
SecRule REQUEST_METHOD "@streq post" \
	"chain,t:'none',t:'lowercase'"
SecRule &SESSION:moodle_ls "!@eq 1" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith course/management.php" \
	"id:241130,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in Moodle 2.8.x before 2.8.10, 2.9.x before 2.9.4, and 3.0.x before 3.0.2 (CVE-2016-0725)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:search "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule IP:magento_rss_order_counter "@ge 5" \
	"id:241140,rev:2,msg:'COMODO WAF: IP Blocked for 300 secs. Information Disclosure vulnerability in Magento before 1.9.2.3 (CVE-2016-2212)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"

SecRule REQUEST_FILENAME "@contains /rss/order/status/" \
	"id:241141,rev:2,chain,msg:'COMODO WAF: Tracking possible Information Disclosure vulnerability in Magento before 1.9.2.3 (CVE-2016-2212)|%{tx.domain}|%{tx.mode}',phase:2,pass,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS:data "@rx (?:increment|customer)_id:(\D+)" \
	"expirevar:'TX.magento_rss_order=300',setvar:'TX.magento_rss_order=1',t:'none',t:'urlDecodeUni',t:'base64DecodeExt',t:'cmdLine',t:'removeWhitespace'"

SecRule &TX:magento_rss_order "@ge 1" \
	"id:241142,rev:2,chain,msg:'COMODO WAF: Information Disclosure vulnerability in Magento before 1.9.2.3 (CVE-2016-2212)|%{tx.domain}|%{tx.mode}',phase:3,deny,status:403,log,t:'none'"
SecRule RESPONSE_HEADERS:Set-Cookie "@contains frontend" \
	"t:'none'"

SecRule &TX:magento_rss_order "@ge 1" \
	"id:241143,rev:2,chain,msg:'COMODO WAF: Blocking IP. Information Disclosure vulnerability in Magento before 1.9.2.3 (CVE-2016-2212)|%{tx.domain}|%{tx.mode}',phase:5,pass,log,t:'none'"
SecRule RESPONSE_HEADERS:Set-Cookie "@contains frontend" \
	"expirevar:'ip.magento_rss_order_counter=300',initcol:'ip=%{REMOTE_ADDR}',setvar:'ip.magento_rss_order_counter=+5',t:'none'"

SecRule REQUEST_FILENAME "@endsWith mod/survey/save.php" \
	"id:241150,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in Moodle through 2.6.11, 2.7.x before 2.7.11, 2.8.x before 2.8.9, and 2.9.x before 2.9.3 (CVE-2015-5336)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:/q\d+/ "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_GET:p "@streq user" \
	"id:241170,rev:3,chain,phase:2,pass,nolog,t:'none',t:'lowercase',skip:1"
SecRule REQUEST_METHOD "@streq get" \
	"chain,expirevar:'SESSION.gecko_cms=300',setvar:'SESSION.gecko_cms=1',t:'none',t:'lowercase'"
SecRule SESSION:gecko_cms "@eq 1" \
	"t:'none'"

SecRule ARGS_GET:p "@streq user" \
	"id:241171,rev:3,chain,msg:'COMODO WAF: CSRF vulnerability in Gecko CMS 2.2 and 2.3 (CVE-2015-1424)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_METHOD "@streq post" \
	"chain,t:'none',t:'lowercase'"
SecRule &SESSION:gecko_cms "!@eq 1" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith admin/registration/register.php" \
	"id:241180,rev:2,chain,phase:2,pass,nolog,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule REQUEST_METHOD "@streq get" \
	"expirevar:'SESSION.moodle_rg=300',setvar:'SESSION.moodle_rg=1',setvar:'SESSION.TIMEOUT=300',t:'none',t:'lowercase'"

SecRule SESSION:moodle_rg "@eq 1" \
	"id:241181,rev:2,phase:2,pass,nolog,skip:1"

SecRule REQUEST_FILENAME "@endsWith admin/registration/register.php" \
	"id:241182,rev:2,chain,msg:'COMODO WAF: CSRF vulnerability in Moodle through 2.6.11, 2.7.x before 2.7.11, 2.8.x before 2.8.9, and 2.9.x before 2.9.3 (CVE-2015-5335)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule REQUEST_METHOD "@streq post" \
	"chain,t:'none',t:'lowercase'"
SecRule &SESSION:moodle_rg "!@eq 1" \
	"t:'none'"

SecRule &REQUEST_COOKIES:GeniXCMS "@ge 1" \
	"id:241190,rev:1,chain,msg:'COMODO WAF: Multiple SQL injection vulnerabilities in MetalGenix GeniXCMS before 0.0.2 (CVE-2015-2679)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_GET:page "@rx \'" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule REQUEST_FILENAME "@contains /gxadmin/login.php" \
	"id:241191,rev:1,chain,msg:'COMODO WAF: Multiple SQL injection vulnerabilities in MetalGenix GeniXCMS before 0.0.2 (CVE-2015-2679)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase',t:'urlDecodeUni'"
SecRule ARGS_POST:username "@rx \'" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule &REQUEST_COOKIES:dcxd "@ge 1" \
	"id:241200,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in Dotclear before version 2.8.2 (CVE-2015-8831)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule REQUEST_BASENAME "@streq comments.php" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:author "@rx \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule ARGS_GET:_mbox "@contains <" \
	"id:241210,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in Roundcube before 1.0.6 and 1.1.x before 1.1.2 (CVE-2015-8793)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni'"
SecRule &ARGS_GET:_action "@ge 1" \
	"chain,t:'none'"
SecRule &ARGS_GET:_remote "@ge 1" \
	"chain,t:'none'"
SecRule REQUEST_COOKIES_NAMES "@contains roundcube" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith mod/lesson/essay.php" \
	"id:241220,rev:1,chain,msg:'COMODO WAF: XSS injection vulnerability in  Moodle 2.8.x before 2.8.2 (CVE-2015-0216)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:response "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith mod/glossary/editcategories.php" \
	"id:241230,rev:1,chain,phase:2,pass,nolog,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule REQUEST_METHOD "@streq get" \
	"expirevar:'SESSION.moodle_gl=300',setvar:'SESSION.moodle_gl=1',setvar:'SESSION.TIMEOUT=300',t:'none',t:'lowercase'"

SecRule SESSION:moodle_gl "@eq 1" \
	"id:241231,rev:1,phase:2,pass,nolog,skip:1"

SecRule REQUEST_FILENAME "@endsWith mod/glossary/editcategories.php" \
	"id:241232,rev:1,chain,msg:'COMODO WAF: CSRF vulnerability in Moodle through 2.5.9, 2.6.x before 2.6.7, 2.7.x before 2.7.4, and 2.8.x before 2.8.2 (CVE-2015-0213)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule REQUEST_METHOD "@streq post" \
	"chain,t:'none',t:'lowercase'"
SecRule &SESSION:moodle_gl "!@eq 1" \
	"t:'none'"

SecRule REQUEST_FILENAME "@contains bedita-app/admin/saveconfig" \
	"id:241240,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in BEdita before 3.6.0 (CVE-2015-6809)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase',t:'normalisePath'"
SecRule ARGS_POST:cfg[projectName] "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith bedita-app/areas/savearea" \
	"id:241241,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in BEdita before 3.6.0 (CVE-2015-6809)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:data[stats_provider_url] "@rx \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith bedita-app/home/editprofile" \
	"id:241250,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in BEdita 3.4.0 (CVE-2015-1040)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:data[User][realname] "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith bedita-app/pages/savequickitem" \
	"id:241251,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in BEdita 3.4.0 (CVE-2015-1040)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'lowercase'"
SecRule ARGS_POST:data[title]|ARGS_POST:data[description] "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith bedita-app/pages/savenote" \
	"id:241252,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in BEdita 3.4.0 (CVE-2015-1040)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath'"
SecRule ARGS_POST:data[description] "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith bedita-app/documents/save" \
	"id:241253,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in BEdita 3.4.0 (CVE-2015-1040)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:data[title] "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule &REQUEST_COOKIES:dcxd "@ge 1" \
	"id:241260,rev:2,chain,msg:'COMODO WAF: Unrestricted File Upload vulnerability in Dotclear before version 2.8.2 (CVE-2015-8832)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule REQUEST_BASENAME "@streq media.php" \
	"chain,t:'none',t:'lowercase'"
SecRule FILES "@rx \.(?:(?:p|s)?h(?:p[2-7s]?|(?:tm)?l?)|dll|exe|js|pl|rb|sh)$" \
	"t:'none',t:'lowercase'"

SecRule REQUEST_FILENAME "@contains index.php/dashboard/reports/logs/view" \
	"id:241270,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in concrete5 before 5.7.4 (CVE-2015-2250)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:channel "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@contains index.php/tools/required/permissions/access_entity" \
	"id:241271,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in concrete5 before 5.7.4 (CVE-2015-2250)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:accessType "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@contains index.php/ccm/system/dialogs/area/design" \
	"id:241272,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in concrete5 before 5.7.4 (CVE-2015-2250)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:arHandle "@rx  \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@contains index.php/dashboard/extend/connect" \
	"id:241273,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in concrete5 before 5.7.4 (CVE-2015-2250)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule REQUEST_URI "@rx  \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@contains index.php/dashboard/system/conversations/bannedwords" \
	"id:241274,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in concrete5 before 5.7.4 (CVE-2015-2250)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:banned_word[] "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@contains index.php/dashboard/system/multilingual/setup/load_icon" \
	"id:241275,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in concrete5 before 5.7.4 (CVE-2015-2250)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:msCountry "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@contains index.php/dashboard/pages/single" \
	"id:241276,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in concrete5 before 5.7.4 (CVE-2015-2250)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:pageURL "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@contains index.php/dashboard/system/seo/searchindex" \
	"id:241279,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in concrete5 before 5.7.4 (CVE-2015-2250)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:SEARCH_INDEX_AREA_METHOD "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@contains index.php/dashboard/system/optimization/jobs" \
	"id:241280,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in concrete5 before 5.7.4 (CVE-2015-2250)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:unit "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@contains index.php/dashboard/system/registration/open" \
	"id:241290,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in concrete5 before 5.7.4 (CVE-2015-2250)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:register_notification_email "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@pm htdocs/product/liste.php htdocs/adherents/liste.php" \
	"id:241300,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Dolibarr ERP/CRM 3.5 and 3.6 (CVE-2015-3935)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:sall "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith htdocs/contact/list.php" \
	"id:241301,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Dolibarr ERP/CRM 3.5 and 3.6 (CVE-2015-3935)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:contactname "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith htdocs/societe/societe.php" \
	"id:241302,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Dolibarr ERP/CRM 3.5 and 3.6 (CVE-2015-3935)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:search_nom|ARGS_POST:search_town|ARGS_POST:/search_idprof\d+/|ARGS_POST:socname "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@contains index.php/dashboard/system/mail/importers" \
	"id:241310,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in concrete5 before 5.7.4 (CVE-2015-3989)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:miEmail|ARGS_POST:miServer|ARGS_POST:miUsername|ARGS_POST:miPassword|ARGS_POST:miPort "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule &REQUEST_COOKIES:pivotxsession "@ge 1" \
	"id:241320,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in PivotX before 2.3.11 (CVE-2015-5456)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule REQUEST_URI "@rx index\.php\/\"|index\.php\/\'" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode',t:'lowercase'"

SecRule ARGS_GET:page "@streq logout" \
	"id:241321,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in PivotX before 2.3.11 (CVE-2015-5456)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_URI "@rx index\.php\/\"|index\.php\/\'" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode',t:'lowercase'"

SecRule &REQUEST_COOKIES:user_env "@ge 1" \
	"id:241330,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Ultimate PHP Board (aka myUPB) 2.2.7 (CVE-2015-2217)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule REQUEST_FILENAME "@endsWith search.php" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:q "@rx \'" \
	"t:'none',t:'urlDecodeUni'"

SecRule &REQUEST_COOKIES:user_env "@ge 1" \
	"id:241331,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Ultimate PHP Board (aka myUPB) 2.2.7 (CVE-2015-2217)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule REQUEST_FILENAME "@endsWith profile.php" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:avatar "@rx \'" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@contains index.php/ajaxproxy/" \
	"id:241340,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in WoltLab Community Gallery 2.0 before 2014-12-26 (CVE-2015-2275)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:/parameters\[data]\[\d+]\[title]/ "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_GET:do "@pm subadminmgt editcurrency disporders" \
	"id:241350,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in ZeusCart 4 (CVE-2015-2183)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:id|ARGS_GET:cid "@rx \D" \
	"t:'none'"

SecRule ARGS_GET:do "@streq search" \
	"id:241360,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in ZeusCart 4 (CVE-2015-2182) & (CVE-2010-5322)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:search "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_GET:do "@streq viewbrands" \
	"id:241361,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in ZeusCart 4 (CVE-2015-2182)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:brand "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_GET:do "@streq brands" \
	"id:241362,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in ZeusCart 4 (CVE-2015-2182)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:schltr "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith asys/site/system.php" \
	"id:241370,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Adminsystems CMS before 4.0.2 (CVE-2015-1603)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:id "@rx \D" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith asys/site/files/upload.php" \
	"id:241380,rev:1,chain,msg:'COMODO WAF: Unrestricted file upload vulnerability in Adminsystems CMS before 4.0.2 (CVE-2015-1604)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:name "@rx \.(?:php[\d]?|js|pl|rb|sh|p?html|asp|exe|com|htaccess)$" \
	"t:'none',t:'lowercase'"

SecRule &ARGS:_alt "@ge 1" \
	"id:241390,rev:1,chain,msg:'COMODO WAF: Absolute path traversal vulnerability in Roundcube before 1.0.6 and 1.1.x before 1.1.2 (CVE-2015-8794)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS:_task "@streq addressbook" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS:_action "@streq import" \
	"chain,t:'none',t:'lowercase'"
SecRule REQUEST_COOKIES_NAMES "@contains roundcube" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith scp/tickets.php" \
	"id:241400,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in osTicket before 1.9.5 (CVE-2015-1176)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:a "@streq search" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:status "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_GET:action "@streq item_edit" \
	"id:241410,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in Cacti 0.8.8g and earlier (CVE-2016-3172)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_GET:parent_id "@rx \D" \
	"chain,t:'none'"
SecRule &REQUEST_COOKIES:Cacti "@ge 1" \
	"chain,t:'none'"
SecRule REQUEST_FILENAME "@endsWith tree.php" \
	"t:'none',t:'lowercase'"

SecRule &REQUEST_COOKIES:e107_tzOffset "@ge 1" \
	"id:241420,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in e107 Bootstrap CMS 2.0.0 (CVE-2015-1057)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule REQUEST_FILENAME "@endsWith usersettings.php" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:realname "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule &ARGS_POST:yii_csrf_token "@ge 1" \
	"id:241430,rev:2,chain,msg:'COMODO WAF: Arbitrary File Upload in X2Engine X2CRM before 5.0.9 (CVE-2015-5074)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule &REQUEST_COOKIES:phpsessid "@ge 1" \
	"chain,t:'none'"
SecRule &REQUEST_COOKIES:yii_csrf_token "@ge 1" \
	"chain,t:'none'"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key)$" \
	"t:'none',t:'lowercase'"

SecRule REQUEST_FILENAME "@contains admin/file_manager/file_manager/editfile" \
	"id:241440,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Croogo before 2.2.1 (CVE-2015-1053)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase',t:'urlDecodeUni',t:'normalisePath'"
SecRule ARGS_GET:path "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@pm admin/contacts/contacts/add admin/contacts/contacts/edit" \
	"id:241450,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Croogo before 2.1.0 (CVE-2014-8577)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:data[Contact][title] "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@pm admin/blocks/blocks/add admin/blocks/blocks/edit" \
	"id:241451,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Croogo before 2.1.0 (CVE-2014-8577)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath'"
SecRule ARGS_POST:data[Block][title]|ARGS_POST:data[Block][alias] "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@pm admin/blocks/regions/add admin/blocks/regions/edit" \
	"id:241452,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Croogo before 2.1.0 (CVE-2014-8577)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:data[Region][title] "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@pm admin/menus/menus/add admin/menus/menus/edit" \
	"id:241453,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Croogo before 2.1.0 (CVE-2014-8577)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:data[Menu][title]|ARGS_POST:data[Menu][alias] "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@pm admin/menus/links/add admin/menus/links/edit" \
	"id:241454,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in Croogo before 2.1.0 (CVE-2014-8577)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:data[Link][title] "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@contains e107_admin/filemanager.php" \
	"id:241460,rev:1,chain,msg:'COMODO WAF: XSS vulnerabilities in e107 1.0.4 (CVE-2015-1041)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule REQUEST_URI "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith db_search.php" \
	"id:241470,rev:2,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in phpMyAdmin 4.0.x before 4.0.10.13, 4.4.x before 4.4.15.3, and 4.5.x before 4.5.4 (CVE-2016-2040)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:criteriaTables[] "@rx \"" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule &REQUEST_COOKIES:phpmyadmin "@ge 1" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith tbl_zoom_select.php" \
	"id:241471,rev:2,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in phpMyAdmin 4.0.x before 4.0.10.13, 4.4.x before 4.4.15.3, and 4.5.x before 4.5.4 (CVE-2016-2040)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:/criteriaValues\[\d+\]/|ARGS:/criteriaColumnTypes\[\d+\]/ "@rx \"" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule &REQUEST_COOKIES:phpmyadmin "@ge 1" \
	"t:'none'"

SecRule REQUEST_URI "@ge 600" \
	"id:241472,rev:2,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in phpMyAdmin 4.0.x before 4.0.10.13, 4.4.x before 4.4.15.3, and 4.5.x before 4.5.4 (CVE-2016-2040)|%{tx.domain}|%{tx.mode}',phase:3,deny,status:403,log,t:'none',t:'length'"
SecRule REQUEST_HEADERS:Host "@contains '" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule RESPONSE_HEADERS:Set-Cookie "@contains pmaPass" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith admin/pages/modify.php" \
	"id:241480,rev:1,chain,msg:'COMODO WAF: XSS & SQL injection vulnerabilities in in WebsiteBaker 2.8.3 & 2.8.3 SP3 (CVE-2015-0553) & (CVE-2014-9242)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:page_id "@rx \D" \
	"t:'none'"

SecRule REQUEST_FILENAME "@pm modules/news/modify_group.php modules/edit_module_files.php modules/news/modify_post.php modules/news/modify_settings.php" \
	"id:241490,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in WebsiteBaker 2.8.3 (CVE-2014-9243)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:section_id "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith modules/news/add_post.php" \
	"id:241491,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in WebsiteBaker 2.8.3 (CVE-2014-9243)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:section_id "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@contains admin/admintools/tool.php" \
	"id:241492,rev:2,chain,msg:'COMODO WAF: XSS vulnerabilities in WebsiteBaker 2.8.3 (CVE-2014-9243)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase',t:'urlDecodeUni',t:'normalisePath'"
SecRule REQUEST_URI "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'urlDecodeUni'"

SecRule REQUEST_COOKIES_NAMES "@contains pmapass" \
	"id:241500,rev:2,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in phpMyAdmin 4.0.x before 4.0.10.15, 4.4.x before 4.4.15.5, and 4.5.x before 4.5.5.1 (CVE-2016-2560)|%{tx.domain}|%{tx.mode}',phase:3,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_HEADERS:Host "@rx \"" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule RESPONSE_HEADERS:Set-Cookie "@contains pmaPass" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith server_privileges.php" \
	"id:241501,rev:2,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in phpMyAdmin 4.0.x before 4.0.10.15, 4.4.x before 4.4.15.5, and 4.5.x before 4.5.5.1 (CVE-2016-2560)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:initial "@rx \"" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule REQUEST_COOKIES_NAMES "@contains pmapass" \
	"t:'none',t:'lowercase'"

SecRule REQUEST_FILENAME "@endsWith tbl_zoom_select.php" \
	"id:241502,rev:2,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in phpMyAdmin 4.0.x before 4.0.10.15, 4.4.x before 4.4.15.5, and 4.5.x before 4.5.5.1 (CVE-2016-2560)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS:it "@rx \D" \
	"chain,t:'none',t:'lowercase'"
SecRule REQUEST_COOKIES_NAMES "@contains pmapass" \
	"t:'none',t:'lowercase'"

SecRule REQUEST_FILENAME "@pm upload-process-form.php edit-file.php" \
	"id:241510,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in ProjectSend (formerly cFTP) r561 (CVE-2014-9580)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:/file\[\d+]\[name]/|ARGS_POST:/file/[/d+]/[description]/ "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith view_item.php" \
	"id:241520,rev:2,chain,msg:'COMODO WAF: SQL injection vulnerability in ClipBucket 2.7 RC3 (2.7.0.4.v2929-rc3) (CVE-2015-2102)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule &ARGS_GET:type "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_GET:item "@rx \'" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith upload/index.php" \
	"id:241550,rev:1,chain,msg:'COMODO WAF: XSS & SQL injection vulnerability in Persian Car CMS 1.0 (CVE-2015-4678)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:cat_id "@rx \'" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith admin/asset/grid-proxy" \
	"id:241560,rev:2,chain,msg:'COMODO WAF: SQL injection vulnerability in the pimcore before build 3473 (CVE-2015-4426)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:filter "@rx \'" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith /libraries/sql-parser/autoload.php" \
	"id:241570,rev:1,msg:'COMODO WAF: Information Disclosure in phpMyAdmin 4.5.x before 4.5.4 (CVE-2016-2044)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath'"

SecRule REQUEST_FILENAME "@endsWith graph_view.php" \
	"id:241580,rev:1,chain,msg:'COMODO WAF: SQL Injection Vulnerability in Cacti 0.8.8g and earlier (CVE-2016-3659)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule &REQUEST_COOKIES:Cacti "@ge 1" \
	"chain,setvar:'TX.cacti=1',t:'none'"
SecRule ARGS:host_group_data "!@rx ^(?:graph_template|data_query)\:\d+$" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule ARGS:host_group_data "!@contains data_query_index" \
	"t:'none'"

SecRule TX:cacti "@eq 1" \
	"id:241581,rev:1,chain,msg:'COMODO WAF: SQL Injection Vulnerability in Cacti 0.8.8g and earlier (CVE-2016-3659)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS:host_group_data "@rx ^(?:data_query_index\:\d+\:(.+))$" \
	"chain,capture,t:'none',t:'urlDecodeUni'"
SecRule TX:1 "@pm ( )" \
	"t:'none'"

SecRule REQUEST_URI "@rx shop-\d+\/category:" \
	"id:241590,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in the Microweber CMS 0.95 before 20141209 (CVE-2014-9464)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase',t:'urlDecodeUni',t:'normalisePath'"
SecRule REQUEST_URI "!@rx category:\d+$" \
	"t:'none',t:'lowercase'"

SecRule REQUEST_HEADERS:X-HTTP-Method-Override "!@streq %{REQUEST_METHOD}" \
	"id:241600,rev:2,chain,msg:'COMODO WAF: CSRF protection bypass vulnerability in CakePHP 2.x and 3.x before 3.1.5 (CVE-2015-8739)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule REQUEST_HEADERS:X-HTTP-Method-Override "@ge 1" \
	"chain,t:'none',t:'length'"
SecRule REQUEST_COOKIES_NAMES "@contains cakephp" \
	"t:'none',t:'lowercase'"

SecRule ARGS:_method "!@streq %{REQUEST_METHOD}" \
	"id:241601,rev:2,chain,msg:'COMODO WAF: CSRF protection bypass vulnerability in CakePHP 2.x and 3.x before 3.1.5 (CVE-2015-8739)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS:_method "@ge 1" \
	"chain,t:'none',t:'length'"
SecRule REQUEST_COOKIES_NAMES "@contains cakephp" \
	"t:'none',t:'lowercase'"

SecRule REQUEST_FILENAME "@endsWith db_structure.php" \
	"id:241610,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in phpMyAdmin 4.4.x before 4.4.15.5 and 4.5.x before 4.5.5.1 (CVE-2016-2561)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_COOKIES_NAMES "@contains pmapass" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS:tbl_type|ARGS:tbl_group "@rx \"" \
	"t:'none',t:'lowercase'"

SecRule ARGS:normalizeTo "!@within 1nf 2nf 3nf" \
	"id:241611,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in phpMyAdmin 4.4.x before 4.4.15.5 and 4.5.x before 4.5.5.1 (CVE-2016-2561)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_COOKIES_NAMES "@contains pmapass" \
	"chain,t:'none',t:'lowercase'"
SecRule REQUEST_FILENAME "@endsWith normalization.php" \
	"t:'none',t:'lowercase'"

SecRule REQUEST_FILENAME "@endsWith db_central_columns.php" \
	"id:241612,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in phpMyAdmin 4.4.x before 4.4.15.5 and 4.5.x before 4.5.5.1 (CVE-2016-2561)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_COOKIES_NAMES "@contains pmapass" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS:pos "@rx \D" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith libraries/phpseclib/crypt/rijndael.php" \
	"id:241620,rev:2,msg:'COMODO WAF: Information Disclosure in phpMyAdmin 4.4.x before 4.4.15.3 and 4.5.x before 4.5.4 (CVE-2016-2042)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"

SecRule REQUEST_FILENAME "@endsWith libraries/phpseclib/crypt/aes.php" \
	"id:241621,rev:2,msg:'COMODO WAF: Information Disclosure in phpMyAdmin 4.4.x before 4.4.15.3 and 4.5.x before 4.5.4 (CVE-2016-2042)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"

SecRule REQUEST_FILENAME "@endsWith dapur/index.php" \
	"id:241630,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in the Fiyo CMS 2.0.1.8 (CVE-2014-9145)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:app "@streq user" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:id "@rx \D" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith dapur/apps/app_user/controller/check_user.php" \
	"id:241631,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in the Fiyo CMS 2.0.1.8 (CVE-2014-9145)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:username|ARGS_POST:email "@rx \'" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith dapur/apps/app_article/controller/article_list.php" \
	"id:241632,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in the Fiyo CMS 2.0.1.8 (CVE-2014-9145)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:cat|ARGS_GET:level|ARGS_GET:user "@rx \'" \
	"t:'none',t:'urlDecodeUni'"

SecRule ARGS_GET:categ "@streq isbd" \
	"id:241640,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in the PMB 4.1.3 and earlier (CVE-2014-9457)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_FILENAME "@endsWith catalog.php" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:id "!@rx ^\d+#?$" \
	"t:'none'"

SecRule ARGS_GET:r "@contains notification/list/index" \
	"id:241650,rev:1,chain,msg:'COMODO WAF: XSS & SQL injection vulnerability in the HumHub 0.10.0-rc.1 and earlier (CVE-2014-9528)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:from "@rx \D" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith dapur/index.php" \
	"id:241660,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Fiyo CMS 2.0.1.8 (CVE-2014-9146)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:app "@streq module" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:act "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_GET:app "@contains article" \
	"id:241661,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Fiyo CMS 2.0.1.8 (CVE-2014-9146)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:view "@contains item" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:id|ARGS_GET:view|ARGS_GET:app "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith dapur/index.php" \
	"id:241670,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Fiyo CMS 1.5.7 (CVE-2014-4032)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:app "@streq comment" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:name|ARGS_POST:comment "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_POST:send-comment "@streq send" \
	"id:241671,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Fiyo CMS 1.5.7 (CVE-2014-4032)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule &ARGS_POST:secure "@eq 1" \
	"chain,t:'none'"
SecRule ARGS_POST:name|ARGS_POST:com "@rx <|\"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule &REQUEST_COOKIES:fuelfid "@ge 1" \
	"id:241680,rev:1,chain,msg:'COMODO WAF: Directory traversal vulnerability in Novius OS 5.0.1 (Elche) (CVE-2015-5353)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_GET:tab "@contains .." \
	"t:'none'"

SecRule REQUEST_FILENAME "@contains admin/noviusos_media/media/insert_update" \
	"id:241681,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Novius OS 5.0.1 (Elche) (CVE-2015-5353)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:media_title "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@contains admin/noviusos_menu/menu/crud/insert_update" \
	"id:241682,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Novius OS 5.0.1 (Elche) (CVE-2015-5353)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:menu_title "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith admin/nos/login" \
	"id:241690,rev:1,chain,msg:'COMODO WAF: Open redirect vulnerability in Novius OS 5.0.1 (Elche) (CVE-2015-5354)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &REQUEST_COOKIES:fuelfid "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_GET:redirect "@beginsWith http" \
	"t:'none',t:'lowercase'"

SecRule REQUEST_FILENAME "@endsWith /components/filemanager/dialog.php" \
	"id:241700,rev:2,chain,msg:'COMODO WAF: XSS vulnerability in Codiad before 2.4.3 (CVE-2014-9582)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_GET:short_name "@contains <" \
	"t:'none',t:'lowercase',t:'urlDecodeUni'"

SecRule ARGS:layerstyle "@contains .." \
	"id:241710,rev:1,chain,msg:'COMODO WAF: Directory traversal vulnerability in Revive Adserver before 3.2.2 (CVE-2015-7372)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule REQUEST_FILENAME "@endsWith delivery_dev/al.php" \
	"t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"

SecRule REQUEST_FILENAME "@endsWith /libraries/config/messages.inc.php" \
	"id:241720,rev:1,msg:'COMODO WAF: Information Disclosure in phpMyAdmin 4.0.x before 4.0.10.12, 4.4.x before 4.4.15.2, and 4.5.x before 4.5.3.1 (CVE-2015-8669)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"

SecRule REQUEST_FILENAME "@contains modules/system/admin.php" \
	"id:241730,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in the XOOPS before 2.5.7 (CVE-2014-8999)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:fct "@streq users" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:selgroups "@rx \D" \
	"t:'none'"

SecRule ARGS_POST:adminPassword "@contains ;" \
	"id:241740,rev:1,chain,msg:'COMODO WAF: Arbitrary Code Execution in Web Reference Database (aka refbase) through 0.9.6 (CVE-2015-6008)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni'"
SecRule &ARGS:adminUserName|&ARGS:pathToMYSQL|&ARGS:databaseStructureFile "@ge 1" \
	"chain,t:'none'"
SecRule REQUEST_FILENAME "@endsWith install.php" \
	"chain,t:'none',t:'lowercase'"
SecRule &REQUEST_COOKIES:PHPSESSID "@ge 1" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith cms/front_content.php" \
	"id:241750,rev:2,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in Contenido before 4.9.6 (CVE-2014-9433)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule REQUEST_COOKIES_NAMES "@contains 1frontend" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:idart|ARGS_GET:lang|ARGS_GET:idcat "@contains <" \
	"t:'none',t:'lowercase',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@contains administration/submissions.php" \
	"id:241760,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerabilities in PHP-Fusion 7.02.07 (CVE-2014-8596)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &ARGS_GET:aid "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_GET:submit_id "@rx \'" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@contains administration/members.php" \
	"id:241761,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerabilities in PHP-Fusion 7.02.07 (CVE-2014-8596)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &ARGS_GET:aid "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_GET:status "@rx \'" \
	"t:'none',t:'urlDecodeUni'"

SecRule &REQUEST_COOKIES:pwg_id "@ge 1" \
	"id:241770,rev:1,chain,msg:'COMODO WAF: XSS & SQL injection vulnerability in the Piwigo 2.6.3 before & Piwigo 2.6.x and 2.7.x before 2.7.0beta2 (CVE-2014-3900 / CVE-2014-4649)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_GET:page "@contains photo-" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:associate[]|ARGS_POST:represent[] "@rx \D" \
	"t:'none'"

SecRule REQUEST_COOKIES:pwg_id "@rx ^\w{26}$" \
	"id:241780,rev:1,msg:'start track session id=%{TX.1}|%{tx.domain}|%{tx.mode}',phase:2,capture,pass,setsid:'%{TX.1}',nolog,t:'none',t:'lowercase'"

SecRule &REQUEST_COOKIES:pwg_id "@ge 1" \
	"id:241781,rev:1,chain,phase:2,pass,nolog,t:'none'"
SecRule ARGS_GET:page "@pm user_list group_list" \
	"chain,t:'none'"
SecRule REQUEST_METHOD "@streq get" \
	"expirevar:'SESSION.pwg=300',setvar:'SESSION.pwg=1',t:'none',t:'lowercase'"

SecRule SESSION:pwg "@eq 1" \
	"id:241782,rev:1,phase:2,pass,nolog,t:'none',skip:1"

SecRule &REQUEST_COOKIES:pwg_id "@ge 1" \
	"id:241783,rev:1,chain,msg:'COMODO WAF: CSRF vulnerability in Piwigo before 2.6.2 (CVE-2014-4614)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_GET:method "@contains pwg." \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:format "@streq json" \
	"chain,t:'none',t:'lowercase'"
SecRule REQUEST_METHOD "@streq post" \
	"chain,t:'none',t:'lowercase'"
SecRule &SESSION:pwg "!@eq 1" \
	"t:'none'"

SecRule &ARGS:ajaxID "@ge 1" \
	"id:241800,rev:1,chain,msg:'COMODO WAF: XSS Vulnerability in TYPO3 Versions 6.2.0 to 6.2.18 (CVE-2016-4056)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule &ARGS:ajaxToken "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_POST:module "@rx \"" \
	"chain,t:'none',t:'urlDecodeUni'"
SecRule REQUEST_COOKIES_NAMES "@contains be_typo_user" \
	"chain,t:'none',t:'lowercase'"
SecRule REQUEST_FILENAME "@endsWith ajax.php" \
	"t:'none',t:'lowercase'"

SecRule REQUEST_URI "@contains module" \
	"id:241810,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in Kajona before 4.6.3 (CVE-2015-0917)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule REQUEST_COOKIES_NAMES "@contains adminskin" \
	"chain,t:'none'"
SecRule ARGS_GET:action "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule ARGS_POST:serendipity[comment] "@contains <" \
	"id:241820,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in Serendipity before 2.0-rc2 (CVE-2014-9432)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase',t:'urlDecodeUni'"
SecRule REQUEST_COOKIES_NAMES "@rx ^s9y_[a-f0-9]{32}$" \
	"t:'none',t:'lowercase'"

SecRule REQUEST_FILENAME "@endsWith lib/project/projectview.php" \
	"id:241830,rev:1,chain,msg:'COMODO WAF: XSS & SQL injection vulnerabilities in the TestLink 1.9.11 (CVE-2014-5308)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:doAction "@streq search" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:name "@rx \'|\"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith lib/events/eventinfo.php" \
	"id:241831,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerabilities in the TestLink 1.9.11 (CVE-2014-5308)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &REQUEST_COOKIES:TESTLINK_USER_AUTH_COOKIE "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_POST:id "@rx \D" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith graphs_new.php" \
	"id:241840,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in Cacti 0.8.8f and earlier (CVE-2015-8604)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:cg_g "@rx \D" \
	"chain,t:'none'"
SecRule REQUEST_COOKIES_NAMES "@contains cacti" \
	"t:'none',t:'lowercase'"

SecRule ARGS_POST:controller "@contains search" \
	"id:241850,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in Exponent CMS v2.3.0 (CVE-2014-6635)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:action "@contains none" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:src "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith /oc-admin/index.php" \
	"id:241870,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in OSClass before 3.4.2 (CVE-2014-6280)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_GET:page "@contains items" \
	"chain,t:'none'"
SecRule ARGS_GET:action|ARGS_GET:nsextt "@contains <" \
	"t:'none',t:'lowercase',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith e107_admin/db.php" \
	"id:241880,rev:2,chain,msg:'COMODO WAF: XSS vulnerability in e107 v2.0 alpha2 (CVE-2014-4734)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:mode "@contains pref_editor" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:type "@contains '" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@contains textpattern/setup/index.php" \
	"id:241890,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in Textpattern CMS before 4.5.7 (CVE-2014-4737)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath'"
SecRule REQUEST_FILENAME "@contains \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule ARGS_GET:action "@streq rate" \
	"id:241900,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in the Piwigo before 2.5.5, 2.6.x before 2.6.4, and 2.7.x before 2.7.2 (CVE-2014-9115)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_URI "@rx picture\.php\?\/\d+\/category\/\d+" \
	"chain,t:'none',t:'lowercase',t:'urlDecodeUni',t:'normalisePath'"
SecRule ARGS_GET:rate "@rx \D" \
	"t:'none'"

SecRule ARGS_POST:owa_action "@contains base.login" \
	"id:241920,rev:2,chain,msg:'COMODO WAF: XSS vulnerability in Open Web Analytics before 1.5.6 (CVE-2014-1456)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_POST:owa_user_id "@rx \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@contains tools/required/dashboard/sitemap_drag_request" \
	"id:241940,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the concrete5 5.7.2.1, 5.7.2, and earlier (CVE-2014-9526)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:instance_id "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@contains dashboard/users/groups/bulkupdate/search" \
	"id:241941,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the concrete5 5.7.2.1, 5.7.2, and earlier (CVE-2014-9526)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:gName "@contains \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@contains dashboard/users/groups/bulkupdate/search" \
	"id:241942,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the concrete5 5.7.2.1, 5.7.2, and earlier (CVE-2014-9526)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_POST:gName "@contains \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith manager/assets/fileapi/fileapi.flash.image.swf" \
	"id:241950,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the MODX Revolution 2.3.2-pl (CVE-2014-8992)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:callback "@contains )" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_URI "@contains /manager/" \
	"id:241960,rev:2,chain,phase:2,pass,nolog,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &ARGS_GET:a "@ge 1" \
	"chain,t:'none'"
SecRule REQUEST_METHOD "@streq get" \
	"expirevar:'SESSION.modx=300',setvar:'SESSION.modx=1',t:'none',t:'lowercase'"

SecRule SESSION:modx "@eq 1" \
	"id:241961,rev:2,phase:2,pass,nolog,skip:1"

SecRule REQUEST_FILENAME "@endsWith connectors/security/profile.php" \
	"id:241962,rev:2,chain,msg:'COMODO WAF: CSRF vulnerability in MODX Revolution 2.x before 2.2.15 (CVE-2014-8773 & CVE-2014-8775)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule REQUEST_METHOD "@streq post" \
	"chain,t:'none',t:'lowercase'"
SecRule &SESSION:modx "!@eq 1" \
	"t:'none'"

SecRule REQUEST_URI "@contains /manager/" \
	"id:241970,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the MODX Revolution 2.3.1-pl and earlier (CVE-2014-5451 & CVE-2014-2080)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &REQUEST_COOKIES:PHPSESSID "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_GET:a "@contains \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@contains /manager/" \
	"id:241980,rev:1,chain,msg:'COMODO WAF: XSS & SQL injection vulnerability in the MODX Revolution before 2.2.14 (CVE-2014-2736)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &REQUEST_COOKIES:PHPSESSID "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_GET:id "@rx \D" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith connectors/security/message.php" \
	"id:241981,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in the MODX Revolution before 2.2.14 (CVE-2014-2736)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &ARGS_POST:HTTP_MODAUTH "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_POST:user "@rx \D" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith www/admin/report-generate.php" \
	"id:241990,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Revive Adserver before 3.0.6 (CVE-2014-8793)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase',t:'normalisePath',t:'urlDecodeUni'"
SecRule ARGS_GET:submit_type "@streq change" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:refresh_page "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_GET:class_key "@streq modstaticresource" \
	"id:242000,rev:2,chain,msg:'COMODO WAF: XSS vulnerability in the MODX Revolution 2.x before 2.2.15 (CVE-2014-8774)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:context_key "@contains \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_URI "@contains /manager/" \
	"id:242001,rev:2,chain,msg:'COMODO WAF: XSS vulnerability in the MODX Revolution 2.x before 2.2.15 (CVE-2014-8774)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &ARGS_GET:a "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_GET:key "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule &ARGS_POST:HTTP_MODAUTH "@ge 1" \
	"id:242002,rev:2,chain,msg:'COMODO WAF: XSS vulnerability in the MODX Revolution 2.x before 2.2.15 (CVE-2014-8774)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_POST:context "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith oc-admin/index.php" \
	"id:242010,rev:1,chain,msg:'COMODO WAF: Directory traversal vulnerability in OSClass before 3.4.2 (CVE-2014-6308)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule REQUEST_COOKIES:osclass "@rx ^[a-z0-9]{26}$" \
	"chain,t:'none'"
SecRule ARGS_GET:page "@contains appearance" \
	"chain,t:'none'"
SecRule ARGS_GET:action "@contains render" \
	"chain,t:'none'"
SecRule ARGS_GET:file "@contains .." \
	"t:'none',t:'normalisePath'"

SecRule REQUEST_FILENAME "@endsWith admin/settings.php" \
	"id:242020,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in GetSimple CMS 3.3.1 (CVE-2014-1603)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'normalisePath'"
SecRule &ARGS_POST:sitepwd_confirm "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_POST:user|ARGS_POST:email|ARGS_POST:name "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith admin/load.php" \
	"id:242021,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in GetSimple CMS 3.3.1 (CVE-2014-1603)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'normalisePath'"
SecRule ARGS_GET:param "@rx \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith requests/manage_playlists.php" \
	"id:242030,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the phpSound 1.0.5 (CVE-2014-8954)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase',t:'urlDecodeUni',t:'normalisePath'"
SecRule ARGS_POST:name "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_GET:a "@streq explore" \
	"id:242031,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the phpSound 1.0.5 (CVE-2014-8954)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule &REQUEST_COOKIES:volume "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_GET:filter "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_POST:controller "@streq users" \
	"id:242040,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Exponent CMS before 2.1.4 patch 6, 2.2.x before 2.2.3 patch 9, and 2.3.x before 2.3.1 patch 4 (CVE-2014-8690)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:action "@streq update" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:firstname|ARGS_POST:lastname|ARGS_POST:username|ARGS_POST:src|ARGS_POST:int|ARGS_POST:avatar|ARGS_POST:email "@rx <|\"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_COOKIES_NAMES "@contains yourls_" \
	"id:242050,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Yourls 1.7 (CVE-2014-8488)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:url|ARGS_GET:title "@contains \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith thumb.php" \
	"id:242060,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in MediaWiki before 1.25.2 (CVE-2015-6729)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_GET:rel404 "@contains <" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@contains blogs/admin.php" \
	"id:242070,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in b2evolution before 5.2.1 (CVE-2014-9599)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule &ARGS_GET:actionArray[filter] "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_GET:fm_filter "@contains <" \
	"t:'none',t:'urlDecodeUni'"

SecRule ARGS_GET:env "@contains -login:" \
	"id:242080,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the In-Portal CMS 5.2.0 and earlier (CVE-2014-8304)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:next_template "@contains \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith editor.php" \
	"id:242090,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in Network Weathermap before 0.97b (CVE-2013-2618)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule &ARGS_POST:mapname "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_POST:map_title "@contains <" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@pm tabella.php coloni.php insert.php" \
	"id:242100,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in MySql Lite Administrator beta-1 (CVE-2015-5064)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule REQUEST_COOKIES:PHPSESSID "@rx ^[a-z0-9]{26}$" \
	"chain,t:'none'"
SecRule ARGS_GET:table_name "@contains <" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith coloni.php" \
	"id:242101,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in MySql Lite Administrator beta-1 (CVE-2015-5064)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule REQUEST_COOKIES:PHPSESSID "@rx ^[a-z0-9]{26}$" \
	"chain,t:'none'"
SecRule ARGS_GET:num_row "@contains <" \
	"t:'none',t:'urlDecodeUni'"

SecRule ARGS_POST:op "@streq login" \
	"id:242110,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in Simple E-Document version 1.31 (CVE-2014-10020)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:Submit "@streq login" \
	"chain,t:'none',t:'lowercase'"
SecRule REQUEST_FILENAME "@endsWith login.php" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:username "@rx \'" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith /gxadmin/index.php" \
	"id:242120,rev:2,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in MetalGenix GeniXCMS before 0.0.2 (CVE-2015-2678)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule &REQUEST_COOKIES:GeniXCMS "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_POST:cat "@contains <" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_COOKIES:GeniXCMS "@ge 1" \
	"id:242121,rev:2,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in MetalGenix GeniXCMS before 0.0.2 (CVE-2015-2678)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_GET:page "@contains <" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith project/controller.php" \
	"id:242130,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in Codiad v2.0.7 (CVE-2013-7257)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_GET:action "@streq create" \
	"chain,t:'none'"
SecRule ARGS_GET:project_name "@contains <" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_COOKIES_NAMES "@contains ostsessid" \
	"id:242140,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the osTicket before 1.9.2 (CVE-2014-4744)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:a "@streq open" \
	"chain,t:'none',t:'lowercase'"
SecRule REQUEST_FILENAME "@endsWith open.php" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST "@contains \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_COOKIES_NAMES "@contains ostsessid" \
	"id:242141,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the osTicket before 1.9.2 (CVE-2014-4744)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_FILENAME "@endsWith account.php" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:do "@contains \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_COOKIES_NAMES "@contains ostsessid" \
	"id:242142,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the osTicket before 1.9.2 (CVE-2014-4744)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule REQUEST_FILENAME "@endsWith account.php" \
	"chain,t:'none',t:'lowercase'"
SecRule &ARGS_POST:do "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_POST "@contains \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_GET:r "@contains alms/games/edit" \
	"id:242160,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Forma Lms before 1.2.1 p01 (CVE-2014-5257)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:id_game "@contains \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_GET:modname "@streq amanmenu" \
	"id:242161,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Forma Lms before 1.2.1 p01 (CVE-2014-5257)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:op "@streq modcustom" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:id_custom "@contains \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith admin/extensions.php" \
	"id:242180,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Lunar CMS before 3.3-3 (CVE-2014-4718)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:ext "@streq contact_form" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:email|ARGS_POST:subject "@contains \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith admin/extensions.php" \
	"id:242181,rev:1,chain,phase:2,pass,nolog,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:ext "@streq contact_form" \
	"chain,t:'none',t:'lowercase'"
SecRule REQUEST_METHOD "@streq get" \
	"expirevar:'SESSION.lunar_ex=300',setvar:'SESSION.lunar_ex=1',t:'none',t:'lowercase'"

SecRule SESSION:lunar_ex "@eq 1" \
	"id:242182,rev:1,phase:2,pass,nolog,t:'none',skip:1"

SecRule REQUEST_FILENAME "@endsWith admin/extensions.php" \
	"id:242183,rev:1,chain,msg:'COMODO WAF: CSRF vulnerability in the Lunar CMS before 3.3-3 (CVE-2014-4718)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:ext "@streq contact_form" \
	"chain,t:'none',t:'lowercase'"
SecRule REQUEST_METHOD "@streq post" \
	"chain,t:'none',t:'lowercase'"
SecRule &SESSION:lunar_ex "!@eq 1" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith admin/user_create.php" \
	"id:242184,rev:1,chain,phase:2,pass,nolog,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &REQUEST_COOKIES:PHPSESSID "@ge 1" \
	"chain,t:'none'"
SecRule REQUEST_METHOD "@streq get" \
	"expirevar:'SESSION.lunar_user=300',setvar:'SESSION.lunar_user=1',t:'none',t:'lowercase'"

SecRule SESSION:lunar_user "@eq 1" \
	"id:242185,rev:1,phase:2,pass,nolog,t:'none',skip:1"

SecRule REQUEST_FILENAME "@endsWith admin/user_create.php" \
	"id:242186,rev:1,chain,msg:'COMODO WAF: CSRF vulnerability in the Lunar CMS before 3.3-3 (CVE-2014-4718)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &ARGS_POST:access "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_POST:Submit "@streq submit" \
	"chain,t:'none',t:'lowercase'"
SecRule REQUEST_METHOD "@streq post" \
	"chain,t:'none',t:'lowercase'"
SecRule &SESSION:lunar_user "!@eq 1" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith filemanager.php" \
	"id:242190,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in AuraCMS before v3.0 (CVE-2014-3974)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule REQUEST_COOKIES:Login "@rx ^[a-z0-9]{26}$" \
	"chain,t:'none'"
SecRule ARGS_GET:viewdir "@contains \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith register.php" \
	"id:242200,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in WeBid 1.1.1 (CVE-2014-5101)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_POST:TPL_name|ARGS_POST:TPL_nick|ARGS_POST:TPL_email|ARGS_POST:TPL_year|ARGS_POST:TPL_address|ARGS_POST:TPL_city|ARGS_POST:TPL_prov|ARGS_POST:TPL_zip|ARGS_POST:TPL_phone|ARGS_POST:TPL_pp_email|ARGS_POST:TPL_authnet_id|ARGS_POST:TPL_authnet_pass|ARGS_POST:TPL_wordpay_id|ARGS_POST:TPL_toocheckout_id|ARGS_POST:TPL_moneybookers_email "@rx \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith user_login.php" \
	"id:242201,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in WeBid 1.1.1 (CVE-2014-5101)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_POST:username "@rx \"" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith modules/system/admin.php" \
	"id:242210,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in ImpressCMS 1.3.6.1 (CVE-2014-4036)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule &REQUEST_COOKIES:ICMSSESSION "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_GET:fct "@streq images" \
	"chain,t:'none'"
SecRule ARGS_POST:query "@contains <" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith joblogs.php" \
	"id:242220,rev:1,chain,msg:'COMODO WAF: SQL Injection vulnerability in the Bacula-Web 5.2.10 (CVE-2014-8295)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:jobid "@rx \'" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_COOKIES:clickheat "@rx ^\w+\|\|[0-9a-f]{32}$" \
	"id:242240,rev:1,msg:'start track session id=%{MATCHED_VAR}|%{tx.domain}|%{tx.mode}',phase:2,capture,pass,setsid:'%{MATCHED_VAR}',nolog,t:'none',t:'urlDecodeUni',t:'lowercase'"

SecRule &REQUEST_COOKIES:clickheat "@ge 1" \
	"id:242241,rev:1,chain,phase:2,pass,nolog,t:'none'"
SecRule ARGS_GET:action "@streq config" \
	"chain,t:'none',t:'lowercase'"
SecRule REQUEST_METHOD "@streq get" \
	"expirevar:'SESSION.clickheat_con=300',setvar:'SESSION.clickheat_con=1',t:'none',t:'lowercase'"

SecRule SESSION:clickheat_con "@eq 1" \
	"id:242242,rev:1,phase:2,pass,nolog,skip:1"

SecRule &REQUEST_COOKIES:clickheat "@ge 1" \
	"id:242243,rev:1,chain,msg:'COMODO WAF: CSRF vulnerability in the ClickHeat 1.14 (CVE-2015-4659)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_GET:action "@streq config" \
	"chain,t:'none',t:'lowercase'"
SecRule REQUEST_METHOD "@streq post" \
	"chain,t:'none',t:'lowercase'"
SecRule &SESSION:clickheat_con "!@eq 1" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endswith view_all_set.php" \
	"id:242250,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the MantisBT 1.2.12 (CVE-2013-5916)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_POST:view_type "@streq advanced" \
	"chain,t:'none',t:'lowercase'"
SecRule &REQUEST_COOKIES:MANTIS_STRING_COOKIE "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_POST:match_type "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@contains /gpEasy" \
	"id:242260,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in gpEasy-CMS 3.0.1 (CVE-2013-0807)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule &REQUEST_COOKIES:PHPSESSID "@gt 0" \
	"chain,t:'none'"
SecRule ARGS_POST:cmd "@streq new_section" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:section "@contains <" \
	"t:'none',t:'urlDecodeUni'"

SecRule REQUEST_FILENAME "@endsWith admin/changedata.php" \
	"id:242270,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in GetSimple CMS 3.1.2 and 3.2.3 (CVE-2013-7243)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase',t:'normalisePath'"
SecRule &ARGS_POST:nonce "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_POST:post-menu "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith admin/settings.php" \
	"id:242271,rev:1,chain,msg:'COMODO WAF: Multiple XSS vulnerabilities in GetSimple CMS 3.1.2 and 3.2.3 (CVE-2013-7243)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule &ARGS_POST:nonce "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_POST:name "@contains \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith filemanager.php" \
	"id:242280,rev:1,chain,msg:'COMODO WAF: Absolute path traversal vulnerability in AuraCMS 3.0 (CVE-2014-3975)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule &REQUEST_COOKIES:Login "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_GET:viewdir "!@beginsWith files" \
	"t:'none',t:'urlDecodeUni',t:'lowercase',t:'normalisePath'"

SecRule REQUEST_COOKIES:GeniXCMS "@rx ^\w{26}$" \
	"id:242290,rev:1,msg:'start track session id=%{MATCHED_VAR}|%{tx.domain}|%{tx.mode}',phase:2,capture,pass,setsid:'%{MATCHED_VAR}',nolog,t:'none',t:'lowercase'"

SecRule &REQUEST_COOKIES:GeniXCMS "@ge 1" \
	"id:242291,rev:1,chain,phase:2,pass,nolog,t:'none'"
SecRule ARGS_GET:page "@streq users" \
	"chain,t:'none',t:'lowercase'"
SecRule REQUEST_METHOD "@streq get" \
	"expirevar:'SESSION.genix_user=300',setvar:'SESSION.genix_user=1',t:'none',t:'lowercase'"

SecRule SESSION:genix_user "@eq 1" \
	"id:242292,rev:1,phase:2,pass,nolog,t:'none',skip:1"

SecRule &REQUEST_COOKIES:GeniXCMS "@ge 1" \
	"id:242293,rev:1,chain,msg:'COMODO WAF: CSRF vulnerability in the MetalGenix GeniXCMS before 0.0.2 (CVE-2015-2680)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule ARGS_GET:page "@streq users" \
	"chain,t:'none',t:'lowercase'"
SecRule REQUEST_METHOD "@streq post" \
	"chain,t:'none',t:'lowercase'"
SecRule &SESSION:genix_user "!@eq 1" \
	"t:'none'"

SecRule REQUEST_COOKIES:sid "@rx ^\w{26}$" \
	"id:242300,rev:1,msg:'start track session id=%{MATCHED_VAR}|%{tx.domain}|%{tx.mode}',phase:2,capture,pass,setsid:'{MATCHED_VAR}',nolog,t:'none'"

SecRule &REQUEST_COOKIES:sid "@ge 1" \
	"id:242301,rev:1,chain,phase:2,pass,nolog,t:'none'"
SecRule REQUEST_URI "@contains admin.php" \
	"chain,t:'none',t:'lowercase'"
SecRule &ARGS_GET:profilefields "@ge 1" \
	"chain,t:'none'"
SecRule REQUEST_METHOD "@streq get" \
	"expirevar:'SESSION.ilch_profile=300',setvar:'SESSION.ilch_profile=1',t:'none',t:'lowercase'"

SecRule SESSION:ilch_profile "@eq 1" \
	"id:242302,rev:1,phase:2,pass,nolog,t:'none',skip:1"

SecRule &REQUEST_COOKIES:sid "@ge 1" \
	"id:242303,rev:1,chain,msg:'COMODO WAF: CSRF vulnerability in the Ilch CMS (CVE-2015-2680)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule REQUEST_URI "@contains admin.php" \
	"chain,t:'none',t:'lowercase'"
SecRule &ARGS_GET:profilefields "@ge 1" \
	"chain,t:'none'"
SecRule REQUEST_METHOD "@streq post" \
	"chain,t:'none',t:'lowercase'"
SecRule &SESSION:ilch_profile "!@eq 1" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith mod/data/field.php" \
	"id:242310,rev:1,chain,msg:'COMODO WAF: XSS injection vulnerability in the Moodle through 2.6.11, 2.7.x before 2.7.13, 2.8.x before 2.8.11, 2.9.x before 2.9.5, and 3.0.x before 3.0.3 (CVE-2016-2153)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &ARGS_POST:type "@ge 1" \
	"chain,t:'none'"
SecRule &REQUEST_COOKIES:MoodleSession "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_POST:name|ARGS_POST:description "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule ARGS_GET:ctg "@streq personal" \
	"id:242320,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in the Epignosis eFront 3.6.14.4 (CVE-2014-4033)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:op "@streq profile" \
	"chain,t:'none',t:'lowercase'"
SecRule REQUEST_FILENAME "@pm administrator.php student.php" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_POST:name|ARGS_POST:surname "@contains <" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule REQUEST_FILENAME "@endsWith management/prioritize_planning.php" \
	"id:242330,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in SimpleRisk before 20130916-001 (CVE-2013-5749)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase',t:'normalisePath'"
SecRule &REQUEST_COOKIES:PHPSESSID "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_POST:new_project "@contains <" \
	"t:'none',t:'urlDecodeUni'"

SecRule ARGS_GET:mod "@streq users" \
	"id:242340,rev:1,chain,msg:'COMODO WAF: XSS vulnerability in ClanSphere 2011.4 (CVE-2014-100010)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'lowercase'"
SecRule ARGS_GET:action "@streq list" \
	"chain,t:'none',t:'lowercase'"
SecRule ARGS_GET:where "@contains \"" \
	"t:'none',t:'urlDecodeUni',t:'htmlEntityDecode'"

SecRule &ARGS:TBLName "@ge 1" \
	"id:242350,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerability in phpRechnung before 1.6.5 (CVE-2015-5648)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none'"
SecRule REQUEST_FILENAME "@pm methodofpayment tax category posgroup position invoice addressbook payment syslog config cashbook message user offer" \
	"chain,t:'none',t:'lowercase'"
SecRule REQUEST_FILENAME "@endsWith list.php" \
	"t:'none',t:'lowercase'"

SecRule REQUEST_FILENAME "@pm sources/datatable/datatable.users_logged.php sources/datatable/datatable.item_edition.php sources/datatable/datatable.logs.php" \
	"id:242360,rev:1,chain,msg:'COMODO WAF: XSS & SQL injection vulnerabilities in the TeamPass before 2.1.20 (CVE-2014-3773)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule ARGS_GET:iDisplayStart|ARGS_GET:iDisplayLength "@rx \D" \
	"t:'none'"

SecRule REQUEST_FILENAME "@endsWith sources/main.queries.php" \
	"id:242361,rev:1,chain,msg:'COMODO WAF: SQL injection vulnerabilities in the TeamPass before 2.1.20 (CVE-2014-3773)|%{tx.domain}|%{tx.mode}',phase:2,deny,status:403,log,t:'none',t:'urlDecodeUni',t:'normalisePath',t:'lowercase'"
SecRule &ARGS_POST:type "@ge 1" \
	"chain,t:'none'"
SecRule ARGS_POST:login "@contains '" \
	"t:'none',t:'urlDecodeUni'"
